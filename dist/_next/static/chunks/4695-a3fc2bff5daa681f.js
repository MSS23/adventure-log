"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4695],{11647:(e,t,r)=>{r.d(t,{E:()=>s});var a=r(95155);r(12115);var o=r(83101),i=r(64269);let n=(0,o.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-sm font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function s(e){let{className:t,variant:r,...o}=e;return(0,a.jsx)("div",{className:(0,i.cn)(n({variant:r}),t),...o})}},13406:(e,t,r)=>{r.d(t,{Xi:()=>l,av:()=>d,j7:()=>s,tU:()=>n});var a=r(95155);r(12115);var o=r(25667),i=r(64269);function n(e){let{className:t,...r}=e;return(0,a.jsx)(o.bL,{"data-slot":"tabs",className:(0,i.cn)("flex flex-col gap-2",t),...r})}function s(e){let{className:t,...r}=e;return(0,a.jsx)(o.B8,{"data-slot":"tabs-list",className:(0,i.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",t),...r})}function l(e){let{className:t,...r}=e;return(0,a.jsx)(o.l9,{"data-slot":"tabs-trigger",className:(0,i.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t),...r})}function d(e){let{className:t,...r}=e;return(0,a.jsx)(o.UC,{"data-slot":"tabs-content",className:(0,i.cn)("flex-1 outline-none",t),...r})}},18383:(e,t,r)=>{r.d(t,{OT:()=>g,c2:()=>v});var a=r(95155),o=r(12115),i=r(58415),n=r(83457),s=r(3998),l=r(11647),d=r(56517),c=r(64269),u=r(18720);function f(e){let{targetId:t,targetType:r,metadata:f,variant:v="ghost",size:g="default",showCount:m=!1,showLabel:p=!1,className:b,disabled:h=!1,onToggle:y}=e,{isFavorited:x,toggleFavorite:w,getFavoritesCount:_,loading:k,checkOwnership:F}=(0,d.rB)({targetType:r,autoFetch:!0}),[j,C]=(0,o.useState)(!1),[E,N]=(0,o.useState)(!1),R=x(t,r),q=m?_(r):0;(0,o.useEffect)(()=>{(async()=>{try{let e=await F(t,r);N(e)}catch(e){console.error("Error checking content ownership:",e),N(!1)}})()},[t,r,F]);let A=h||E,T=async()=>{if(!A&&!j){C(!0);try{let e=await w(t,r,f);null==y||y(e),u.oR.success(e?"Added to ".concat(r," favorites"):"Removed from ".concat(r," favorites"),{duration:2e3,position:"bottom-center"})}catch(e){u.oR.error(e instanceof Error?e.message:"Failed to update ".concat(r," favorite"),{duration:3e3,position:"bottom-center"})}finally{setTimeout(()=>C(!1),300)}}};return(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(s.$,{variant:v,size:g,onClick:T,disabled:A||k||j,title:E?"Cannot favorite your own content":void 0,className:(0,c.cn)("relative overflow-hidden transition-colors",R&&"ghost"===v&&"text-red-600 hover:text-red-700 hover:bg-red-50",R&&"outline"===v&&"border-red-300 text-red-600 hover:bg-red-50",R&&"default"===v&&"bg-red-600 hover:bg-red-700 text-white",E&&"opacity-50 cursor-not-allowed",b),"aria-label":E?"Cannot favorite your own content":"".concat(R?"Remove from":"Add to"," ").concat(r," favorites"),children:[(0,a.jsxs)(i.P.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},transition:{duration:.2},className:"flex items-center gap-2",children:[(0,a.jsx)(n.A,{className:(0,c.cn)("h-4 w-4 transition-all duration-200",R&&"fill-current",j&&"scale-125")}),p&&(0,a.jsx)("span",{className:"text-sm font-medium",children:(()=>{if(!p)return null;if(E)return"Cannot favorite own content";switch(r){case"photo":return R?"Favorited":"Add to favorites";case"album":return"Favorite album";case"location":return R?"Favorite place":"Add to wishlist";default:return R?"Favorited":"Favorite"}})()})]},R?"filled":"empty"),j&&R&&(0,a.jsx)(i.P.div,{initial:{scale:0,opacity:.7},animate:{scale:2,opacity:0},transition:{duration:.4},className:"absolute inset-0 bg-red-400 rounded-full"})]}),m&&q>0&&(0,a.jsx)(l.E,{variant:"secondary",className:"text-sm bg-gray-100 text-gray-800",children:q})]})}function v(e){return(0,a.jsx)(f,{...e,targetType:"location"})}function g(e){let{targetId:t,targetType:r,metadata:o,className:i,...n}=e;return(0,a.jsx)(f,{targetId:t,targetType:r,metadata:o,variant:"ghost",size:"sm",showCount:!1,showLabel:!1,className:(0,c.cn)("h-8 w-8 p-0",i),...n})}},56517:(e,t,r)=>{r.d(t,{rB:()=>s});var a=r(12115),o=r(96648),i=r(43691),n=r(82466);function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{targetType:t,targetId:r,autoFetch:s=!0}=e,{user:l}=(0,i.A)(),[d,c]=(0,a.useState)([]),[u,f]=(0,a.useState)(!1),[v,g]=(0,a.useState)(null),m=(0,o.U)(),p=(0,a.useCallback)(async(e,t)=>{if(!(null==l?void 0:l.id))return!1;try{let r;switch(t){case"photo":r=m.from("photos").select("user_id").eq("id",e).single();break;case"album":r=m.from("albums").select("user_id").eq("id",e).single();break;default:return!1}let{data:a}=await r;return(null==a?void 0:a.user_id)===l.id}catch(r){return n.Rm.error("Error checking content ownership",{itemId:e,itemType:t,error:r}),!1}},[null==l?void 0:l.id,m]),b=(0,a.useCallback)(async()=>{if(!l)return void c([]);f(!0),g(null);try{let e=m.from("favorites").select("\n          id,\n          user_id,\n          target_id,\n          target_type,\n          created_at,\n          metadata\n        ").eq("user_id",l.id).order("created_at",{ascending:!1});t&&(e=e.eq("target_type",t)),r&&(e=e.eq("target_id",r));let{data:a,error:o}=await e;if(o)throw o;c(a||[]),n.Rm.debug("Favorites fetched successfully",{component:"useFavorites",action:"fetchFavorites",count:(null==a?void 0:a.length)||0,targetType:t,targetId:r})}catch(e){g(e instanceof Error?e.message:"Failed to fetch favorites"),n.Rm.error("Failed to fetch favorites",{error:e})}finally{f(!1)}},[l,t,r,m]),h=(0,a.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"photo";return d.some(r=>r.target_id===e&&r.target_type===t)},[d]),y=(0,a.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"photo",r=arguments.length>2?arguments[2]:void 0;if(!l)throw Error("Must be logged in to add favorites");if(await p(e,t))throw Error("You cannot favorite your own content");if(!h(e,t))try{let{data:a,error:o}=await m.from("favorites").insert({user_id:l.id,target_id:e,target_type:t,metadata:r||{}}).select().single();if(o)throw o;return c(e=>[a,...e]),n.Rm.info("Added favorite successfully",{component:"useFavorites",action:"addFavorite",targetId:e,targetType:t}),a}catch(e){throw g(e instanceof Error?e.message:"Failed to add favorite"),n.Rm.error("Failed to add favorite",{error:e}),e}},[l,h,m]),x=(0,a.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"photo";if(!l)throw Error("Must be logged in to remove favorites");try{let{error:r}=await m.from("favorites").delete().eq("user_id",l.id).eq("target_id",e).eq("target_type",t);if(r)throw r;c(r=>r.filter(r=>r.target_id!==e||r.target_type!==t)),n.Rm.info("Removed favorite successfully",{component:"useFavorites",action:"removeFavorite",targetId:e,targetType:t})}catch(e){throw g(e instanceof Error?e.message:"Failed to remove favorite"),n.Rm.error("Failed to remove favorite",{error:e}),e}},[l,m]),w=(0,a.useCallback)(async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"photo",r=arguments.length>2?arguments[2]:void 0;return h(e,t)?(await x(e,t),!1):(await y(e,t,r),!0)},[h,x,y]),_=(0,a.useCallback)(e=>e?d.filter(t=>t.target_type===e).length:d.length,[d]),k=(0,a.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments.length>1?arguments[1]:void 0,r=d;return t&&(r=d.filter(e=>e.target_type===t)),r.slice(0,e)},[d]);return(0,a.useEffect)(()=>{s&&l&&b()},[s,b,l]),(0,a.useEffect)(()=>{l||(c([]),g(null))},[l]),{favorites:d,loading:u,error:v,fetchFavorites:b,isFavorited:h,addFavorite:y,removeFavorite:x,toggleFavorite:w,getFavoritesCount:_,getRecentFavorites:k,checkOwnership:p,photoFavorites:d.filter(e=>"photo"===e.target_type),albumFavorites:d.filter(e=>"album"===e.target_type),locationFavorites:d.filter(e=>"location"===e.target_type)}}},65142:(e,t,r)=>{r.d(t,{p:()=>i});var a=r(95155);r(12115);var o=r(64269);function i(e){let{className:t,type:r,...i}=e;return(0,a.jsx)("input",{type:r,"data-slot":"input",className:(0,o.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...i})}}}]);