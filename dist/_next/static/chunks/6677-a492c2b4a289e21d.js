"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6677,6869],{3998:(e,r,t)=>{t.d(r,{$:()=>c});var o=t(95155);t(12115);var n=t(32467),a=t(83101),i=t(64269);let s=(0,a.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-base font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function c(e){let{className:r,variant:t,size:a,asChild:c=!1,...l}=e,u=c?n.DX:"button";return(0,o.jsx)(u,{"data-slot":"button",className:(0,i.cn)(s({variant:t,size:a,className:r})),...l})}},35626:(e,r,t)=>{t.d(r,{A:()=>o});let o=(0,t(71847).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},43691:(e,r,t)=>{t.d(r,{A:()=>l,O:()=>c});var o=t(95155),n=t(12115),a=t(96648),i=t(82466);let s=(0,n.createContext)(void 0);function c(e){let{children:r}=e,[t,c]=(0,n.useState)(null),[l,u]=(0,n.useState)(null),[d,f]=(0,n.useState)(!0),[m,g]=(0,n.useState)(!1),h=(0,n.useRef)(new Map),p=(0,a.U)(),v=(0,n.useCallback)(async e=>{try{let r=e.replace(/-/g,"").substring(0,8),t="user_".concat(r),o={id:e,username:t,display_name:"New User",privacy_level:"public"},{data:n,error:a}=await p.from("profiles").insert(o).select().single();if(a){if(i.Rm.error("Profile creation error details",{component:"AuthProvider",action:"createProfile",userId:e,username:t,errorCode:a.code,errorMessage:a.message,errorDetails:a.details,errorHint:a.hint}),"23505"===a.code&&a.message.includes("username")){let t=Date.now().toString().slice(-4),n="user_".concat(r,"_").concat(t),{data:a,error:s}=await p.from("profiles").insert({...o,username:n}).select().single();if(s)return i.Rm.error("Error creating profile with fallback username",{component:"AuthProvider",action:"createProfile",userId:e,fallbackUsername:n,error:s}),null;return i.Rm.info("Profile created with fallback username",{component:"AuthProvider",action:"createProfile",userId:e,username:n}),a}if("23505"===a.code&&(a.message.includes("id")||a.message.includes("pkey"))){i.Rm.warn("Profile already exists, attempting to fetch existing profile",{component:"AuthProvider",action:"createProfile",userId:e});try{let{data:r,error:t}=await p.from("profiles").select("*").eq("id",e).single();if(!t&&r)return i.Rm.info("Successfully fetched existing profile after creation conflict",{component:"AuthProvider",action:"createProfile",userId:e}),r}catch(r){i.Rm.error("Failed to fetch existing profile after creation conflict",{component:"AuthProvider",action:"createProfile",userId:e,error:r})}}return i.Rm.error("Error creating profile",{component:"AuthProvider",action:"createProfile",userId:e,username:t,error:a}),null}return i.Rm.info("Profile created successfully",{component:"AuthProvider",action:"createProfile",userId:e,username:t}),n}catch(r){return i.Rm.error("Error creating profile",{component:"AuthProvider",action:"createProfile",userId:e},r instanceof Error?r:Error(String(r))),null}},[p]),b=(0,n.useCallback)(async function(e){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(r){let r=h.current.get(e);if(r&&Date.now()-r.timestamp<r.ttl)return r.data}try{let{data:r,error:t}=await p.from("profiles").select("*").eq("id",e).single();if(t){if(i.Rm.error("Profile fetch error details",{component:"AuthProvider",action:"fetchProfile",userId:e,errorCode:t.code,errorMessage:t.message,errorDetails:t.details,errorHint:t.hint}),"PGRST116"===t.code||t.message.includes("No rows returned")){i.Rm.warn("Profile not found, attempting to create",{component:"AuthProvider",action:"fetchProfile",userId:e});let r=await v(e);if(r)return h.current.set(e,{data:r,timestamp:Date.now(),ttl:3e5}),r}else if(t.message.includes("406")||t.message.includes("Not Acceptable")){i.Rm.error("RLS policy blocking profile access",{component:"AuthProvider",action:"fetchProfile",userId:e,error:t.message});let r=await v(e);if(r)return h.current.set(e,{data:r,timestamp:Date.now(),ttl:3e5}),r}return i.Rm.error("Error fetching profile",{component:"AuthProvider",action:"fetchProfile",userId:e,error:t}),null}return h.current.set(e,{data:r,timestamp:Date.now(),ttl:3e5}),r}catch(r){return i.Rm.error("Error fetching profile",{component:"AuthProvider",action:"fetchProfile",userId:e},r instanceof Error?r:Error(String(r))),null}},[p,v]),x=(0,n.useCallback)(async e=>{g(!0);try{let r=await b(e);u(r)}finally{g(!1)}},[b]),w=async()=>{if(t){g(!0);try{let e=await b(t.id,!1);u(e)}finally{g(!1)}}};(0,n.useEffect)(()=>{(async()=>{try{var e;let{data:{session:r}}=await p.auth.getSession();c(null!=(e=null==r?void 0:r.user)?e:null),f(!1),(null==r?void 0:r.user)&&x(r.user.id)}catch(e){i.Rm.error("Error getting session",{error:e}),f(!1)}})();let{data:{subscription:e}}=p.auth.onAuthStateChange(async(e,r)=>{var t;c(null!=(t=null==r?void 0:r.user)?t:null),f(!1),(null==r?void 0:r.user)?x(r.user.id):(u(null),g(!1),h.current.clear())});return()=>e.unsubscribe()},[x,p.auth]);let y=async()=>{try{await p.auth.signOut(),c(null),u(null),g(!1),h.current.clear()}catch(e){i.Rm.error("Error signing out",{error:e})}};return(0,o.jsx)(s.Provider,{value:{user:t,profile:l,authLoading:d,profileLoading:m,signOut:y,refreshProfile:w},children:r})}function l(){let e=(0,n.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},46046:(e,r,t)=>{t.d(r,{A:()=>o});let o=(0,t(71847).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},64269:(e,r,t)=>{t.d(r,{cn:()=>a});var o=t(2821),n=t(75889);function a(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,n.QP)((0,o.$)(r))}},82466:(e,r,t)=>{t.d(r,{Rm:()=>i});var o=function(e){return e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR",e}({});class n{shouldLog(e){return e>=this.minLevel}formatTimestamp(){return new Date().toISOString()}createLogEntry(e,r,t,o){return{level:e,message:r,timestamp:this.formatTimestamp(),context:t,error:o}}formatConsoleMessage(e){let r=o[e.level],t=e.context?" [".concat(Object.entries(e.context).map(e=>{let[r,t]=e;return"".concat(r,":").concat(t)}).join(", "),"]"):"";return"[".concat(e.timestamp,"] ").concat(r).concat(t,": ").concat(e.message)}logToConsole(e){if(!this.shouldLog(e.level))return;let r=this.formatConsoleMessage(e);switch(e.level){case 0:console.debug(r,e.error||"");break;case 1:console.info(r,e.error||"");break;case 2:console.warn(r,e.error||"");break;case 3:console.error(r,e.error||"")}}logToExternalService(e){this.isDevelopment||e.level}log(e,r,t,o){let n=this.createLogEntry(e,r,t,o);this.logToConsole(n),this.logToExternalService(n)}debug(e,r){this.log(0,e,r)}info(e,r){this.log(1,e,r)}warn(e,r,t){this.log(2,e,r,t)}error(e,r,t){this.log(3,e,r,t)}userAction(e,r,t){this.info("User action: ".concat(e),{component:"user-action",action:e,userId:r,...t})}apiCall(e,r,t){this.debug("API call: ".concat(r," ").concat(e),{component:"api",endpoint:e,method:r,...t})}performance(e,r,t){this.info("Performance: ".concat(e," took ").concat(r,"ms"),{component:"performance",operation:e,duration:r,...t})}constructor(){this.isDevelopment=!1,this.minLevel=+!this.isDevelopment}}let a=new n,i={debug:(e,r)=>a.debug(e,r),info:(e,r)=>a.info(e,r),warn:(e,r,t)=>a.warn(e,r,t),error:(e,r,t)=>a.error(e,r,t),userAction:(e,r,t)=>a.userAction(e,r,t),apiCall:(e,r,t)=>a.apiCall(e,r,t),performance:(e,r,t)=>a.performance(e,r,t)}},86948:(e,r,t)=>{t.d(r,{BT:()=>c,Wu:()=>l,ZB:()=>s,Zp:()=>a,aR:()=>i,wL:()=>u});var o=t(95155);t(12115);var n=t(64269);function a(e){let{className:r,...t}=e;return(0,o.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",r),...t})}function i(e){let{className:r,...t}=e;return(0,o.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",r),...t})}function s(e){let{className:r,...t}=e;return(0,o.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)("leading-none font-semibold",r),...t})}function c(e){let{className:r,...t}=e;return(0,o.jsx)("div",{"data-slot":"card-description",className:(0,n.cn)("text-muted-foreground text-sm",r),...t})}function l(e){let{className:r,...t}=e;return(0,o.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("px-6",r),...t})}function u(e){let{className:r,...t}=e;return(0,o.jsx)("div",{"data-slot":"card-footer",className:(0,n.cn)("flex items-center px-6 [.border-t]:pt-6",r),...t})}},96648:(e,r,t)=>{t.d(r,{U:()=>i});var o=t(87559);let n="https://jjrqstbzzvqrgaqwdvxw.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpqcnFzdGJ6enZxcmdhcXdkdnh3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg0ODc4MDcsImV4cCI6MjA3NDA2MzgwN30.aSHFHAA5Tv2EUDu7nxwOWXSFFUxbOUCR65Vi52QkjX4";if(!n||!a)throw Error("Missing Supabase environment variables");function i(){return(0,o.createBrowserClient)(n,a)}}}]);