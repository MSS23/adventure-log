(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[109,6869],{3998:(e,r,s)=>{"use strict";s.d(r,{$:()=>o});var t=s(95155);s(12115);var a=s(32467),l=s(83101),n=s(64269);let i=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-base font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function o(e){let{className:r,variant:s,size:l,asChild:o=!1,...c}=e,d=o?a.DX:"button";return(0,t.jsx)(d,{"data-slot":"button",className:(0,n.cn)(i({variant:s,size:l,className:r})),...c})}},11186:(e,r,s)=>{"use strict";s.d(r,{bq:()=>m,eb:()=>h,gC:()=>p,l6:()=>d,yv:()=>u});var t=s(95155),a=s(12115),l=s(94304),n=s(24033),i=s(12108),o=s(5917),c=s(64269);let d=l.bL;l.YJ;let u=l.WT,m=a.forwardRef((e,r)=>{let{className:s,children:a,...i}=e;return(0,t.jsxs)(l.l9,{ref:r,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...i,children:[a,(0,t.jsx)(l.In,{asChild:!0,children:(0,t.jsx)(n.A,{className:"h-4 w-4 opacity-50"})})]})});m.displayName=l.l9.displayName;let x=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)(l.PP,{ref:r,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,t.jsx)(i.A,{className:"h-4 w-4"})})});x.displayName=l.PP.displayName;let f=a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)(l.wn,{ref:r,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,t.jsx)(n.A,{className:"h-4 w-4"})})});f.displayName=l.wn.displayName;let p=a.forwardRef((e,r)=>{let{className:s,children:a,position:n="popper",...i}=e;return(0,t.jsx)(l.ZL,{children:(0,t.jsxs)(l.UC,{ref:r,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...i,children:[(0,t.jsx)(x,{}),(0,t.jsx)(l.LM,{className:(0,c.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,t.jsx)(f,{})]})})});p.displayName=l.UC.displayName,a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)(l.JU,{ref:r,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a})}).displayName=l.JU.displayName;let h=a.forwardRef((e,r)=>{let{className:s,children:a,...n}=e;return(0,t.jsxs)(l.q7,{ref:r,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(l.VF,{children:(0,t.jsx)(o.A,{className:"h-4 w-4"})})}),(0,t.jsx)(l.p4,{children:a})]})});h.displayName=l.q7.displayName,a.forwardRef((e,r)=>{let{className:s,...a}=e;return(0,t.jsx)(l.wv,{ref:r,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",s),...a})}).displayName=l.wv.displayName},13406:(e,r,s)=>{"use strict";s.d(r,{Xi:()=>o,av:()=>c,j7:()=>i,tU:()=>n});var t=s(95155);s(12115);var a=s(25667),l=s(64269);function n(e){let{className:r,...s}=e;return(0,t.jsx)(a.bL,{"data-slot":"tabs",className:(0,l.cn)("flex flex-col gap-2",r),...s})}function i(e){let{className:r,...s}=e;return(0,t.jsx)(a.B8,{"data-slot":"tabs-list",className:(0,l.cn)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",r),...s})}function o(e){let{className:r,...s}=e;return(0,t.jsx)(a.l9,{"data-slot":"tabs-trigger",className:(0,l.cn)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",r),...s})}function c(e){let{className:r,...s}=e;return(0,t.jsx)(a.UC,{"data-slot":"tabs-content",className:(0,l.cn)("flex-1 outline-none",r),...s})}},30247:(e,r,s)=>{Promise.resolve().then(s.bind(s,30993))},30993:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>T});var t=s(95155),a=s(12115),l=s(43691),n=s(62890),i=s(82466),o=s(3998),c=s(65142),d=s(76444),u=s(86948),m=s(11647),x=s(11186),f=s(51834),p=s(39068),h=s(91169),g=s(99708),v=s(15870),w=s(17910),j=s(5370),y=s(70532),b=s(57828),N=s(85998),P=s(39867),A=s(71360),C=s(16522),R=s(85897),k=s(20508),E=s(5917),S=s(65229);function _(){let{pendingRequests:e,acceptFollowRequest:r,rejectFollowRequest:s,loading:a,stats:l}=(0,C.k)();return 0===l.pendingRequestsCount?(0,t.jsxs)(u.Zp,{children:[(0,t.jsxs)(u.aR,{children:[(0,t.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(k.A,{className:"h-5 w-5"}),"Follow Requests"]}),(0,t.jsx)(u.BT,{children:"Manage who can follow you"})]}),(0,t.jsx)(u.Wu,{children:(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(k.A,{className:"h-12 w-12 mx-auto text-gray-700 mb-4"}),(0,t.jsx)("p",{className:"text-gray-800",children:"No pending follow requests"})]})})]}):(0,t.jsxs)(u.Zp,{children:[(0,t.jsxs)(u.aR,{children:[(0,t.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(k.A,{className:"h-5 w-5"}),"Follow Requests",(0,t.jsx)(m.E,{variant:"secondary",children:l.pendingRequestsCount})]}),(0,t.jsx)(u.BT,{children:"Approve or decline follow requests"})]}),(0,t.jsx)(u.Wu,{className:"space-y-4",children:e.map(e=>{var l,n,i,c,d,u,m,x;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(R.eu,{children:[(0,t.jsx)(R.BK,{src:null==(l=e.follower)?void 0:l.avatar_url}),(0,t.jsx)(R.q5,{children:(null==(i=e.follower)||null==(n=i.display_name)?void 0:n[0])||(null==(d=e.follower)||null==(c=d.username)?void 0:c[0])||"?"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:(null==(u=e.follower)?void 0:u.display_name)||(null==(m=e.follower)?void 0:m.username)}),(null==(x=e.follower)?void 0:x.display_name)&&(0,t.jsxs)("p",{className:"text-sm text-gray-800",children:["@",e.follower.username]}),(0,t.jsx)("p",{className:"text-sm text-gray-800",children:new Date(e.created_at).toLocaleDateString()})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(o.$,{size:"sm",onClick:()=>r(e.follower_id),disabled:a,className:"bg-green-600 hover:bg-green-700",children:(0,t.jsx)(E.A,{className:"h-4 w-4"})}),(0,t.jsx)(o.$,{size:"sm",variant:"outline",onClick:()=>s(e.follower_id),disabled:a,className:"text-red-600 border-red-200 hover:bg-red-50",children:(0,t.jsx)(S.A,{className:"h-4 w-4"})})]})]},e.id)})})]})}var D=s(13406),B=s(12181),U=s(96583),Z=s(52619),F=s.n(Z);function O(){let{followers:e,following:r,stats:s}=(0,C.k)();return(0,t.jsxs)(u.Zp,{children:[(0,t.jsxs)(u.aR,{children:[(0,t.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(h.A,{className:"h-5 w-5"}),"Social Connections"]}),(0,t.jsx)(u.BT,{children:"View your followers and people you follow"})]}),(0,t.jsx)(u.Wu,{children:(0,t.jsxs)(D.tU,{defaultValue:"followers",className:"w-full",children:[(0,t.jsxs)(D.j7,{className:"grid w-full grid-cols-2",children:[(0,t.jsxs)(D.Xi,{value:"followers",className:"flex items-center gap-2",children:[(0,t.jsx)(B.A,{className:"h-4 w-4"}),"Followers",(0,t.jsx)(m.E,{variant:"secondary",className:"ml-1",children:s.followersCount})]}),(0,t.jsxs)(D.Xi,{value:"following",className:"flex items-center gap-2",children:[(0,t.jsx)(U.A,{className:"h-4 w-4"}),"Following",(0,t.jsx)(m.E,{variant:"secondary",className:"ml-1",children:s.followingCount})]})]}),(0,t.jsx)(D.av,{value:"followers",className:"space-y-4 mt-4",children:0===s.followersCount?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(B.A,{className:"h-12 w-12 mx-auto text-gray-700 mb-4"}),(0,t.jsx)("p",{className:"text-gray-800",children:"No followers yet"}),(0,t.jsx)("p",{className:"text-sm text-gray-800 mt-1",children:"Share your adventure albums to gain followers!"})]}):(0,t.jsx)("div",{className:"space-y-3",children:e.map(e=>{var r,s,a,l,n,i,c,d,u;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(R.eu,{children:[(0,t.jsx)(R.BK,{src:null==(r=e.follower)?void 0:r.avatar_url}),(0,t.jsx)(R.q5,{children:(null==(a=e.follower)||null==(s=a.display_name)?void 0:s[0])||(null==(n=e.follower)||null==(l=n.username)?void 0:l[0])||"?"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:(null==(i=e.follower)?void 0:i.display_name)||(null==(c=e.follower)?void 0:c.username)}),(null==(d=e.follower)?void 0:d.display_name)&&(0,t.jsxs)("p",{className:"text-sm text-gray-800",children:["@",e.follower.username]}),(0,t.jsxs)("p",{className:"text-sm text-gray-800",children:["Following since ",new Date(e.created_at).toLocaleDateString()]})]})]}),(0,t.jsx)(F(),{href:"/profile/".concat(null==(u=e.follower)?void 0:u.username),children:(0,t.jsx)(o.$,{variant:"outline",size:"sm",children:"View Profile"})})]},e.id)})})}),(0,t.jsx)(D.av,{value:"following",className:"space-y-4 mt-4",children:0===s.followingCount?(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(U.A,{className:"h-12 w-12 mx-auto text-gray-700 mb-4"}),(0,t.jsx)("p",{className:"text-gray-800",children:"Not following anyone yet"}),(0,t.jsx)("p",{className:"text-sm text-gray-800 mt-1",children:"Discover and follow other travelers!"})]}):(0,t.jsx)("div",{className:"space-y-3",children:r.map(e=>{var r,s,a,l,n,i,c,d,u;return(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(R.eu,{children:[(0,t.jsx)(R.BK,{src:null==(r=e.following)?void 0:r.avatar_url}),(0,t.jsx)(R.q5,{children:(null==(a=e.following)||null==(s=a.display_name)?void 0:s[0])||(null==(n=e.following)||null==(l=n.username)?void 0:l[0])||"?"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium",children:(null==(i=e.following)?void 0:i.display_name)||(null==(c=e.following)?void 0:c.username)}),(null==(d=e.following)?void 0:d.display_name)&&(0,t.jsxs)("p",{className:"text-sm text-gray-800",children:["@",e.following.username]}),(0,t.jsxs)("p",{className:"text-sm text-gray-800",children:["Following since ",new Date(e.created_at).toLocaleDateString()]})]})]}),(0,t.jsx)("div",{className:"flex gap-2",children:(0,t.jsx)(F(),{href:"/profile/".concat(null==(u=e.following)?void 0:u.username),children:(0,t.jsx)(o.$,{variant:"outline",size:"sm",children:"View Profile"})})})]},e.id)})})})]})})]})}function T(){let{user:e,profile:r,signOut:s,refreshProfile:C}=(0,l.A)(),[R,k]=(0,a.useState)(!1),[E,S]=(0,a.useState)(null),[D,B]=(0,a.useState)(null),[U,Z]=(0,a.useState)(!1),[F,T]=(0,a.useState)(!1),[z,I]=(0,a.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[q,L]=(0,a.useState)((null==r?void 0:r.privacy_level)||"public"),J=(0,n.UU)();(0,a.useEffect)(()=>{r&&L(r.privacy_level)},[r]);let M=async r=>{try{k(!0),S(null);let{error:s}=await J.from("profiles").update({privacy_level:r,updated_at:new Date().toISOString()}).eq("id",null==e?void 0:e.id);if(s)throw s;L(r),await C(),B("Privacy settings updated successfully"),setTimeout(()=>B(null),3e3)}catch(e){i.Rm.error("Error updating privacy level",{},e),S(e instanceof Error?e.message:"Failed to update privacy settings")}finally{k(!1)}},W=async()=>{try{if(k(!0),S(null),z.newPassword!==z.confirmPassword)throw Error("New passwords do not match");if(z.newPassword.length<6)throw Error("New password must be at least 6 characters long");let{error:e}=await J.auth.updateUser({password:z.newPassword});if(e)throw e;I({currentPassword:"",newPassword:"",confirmPassword:""}),B("Password updated successfully"),setTimeout(()=>B(null),3e3)}catch(e){i.Rm.error("Error updating password",{},e),S(e instanceof Error?e.message:"Failed to update password")}finally{k(!1)}},V=async()=>{try{k(!0),S(null);let[s,t]=await Promise.all([J.from("albums").select("*").eq("user_id",null==e?void 0:e.id),J.from("photos").select("*").eq("user_id",null==e?void 0:e.id)]),a={profile:r,albums:s.data||[],photos:t.data||[],exported_at:new Date().toISOString()},l=JSON.stringify(a,null,2),n=new Blob([l],{type:"application/json"}),i=URL.createObjectURL(n),o=document.createElement("a");o.href=i,o.download="adventure-log-data-".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),B("Data exported successfully"),setTimeout(()=>B(null),3e3)}catch(e){i.Rm.error("Error exporting data",{},e),S(e instanceof Error?e.message:"Failed to export data")}finally{k(!1)}},$=async()=>{try{k(!0),S(null),await s()}catch(e){i.Rm.error("Error deleting account",{},e),S(e instanceof Error?e.message:"Failed to delete account")}finally{k(!1)}},X=e=>{switch(e){case"public":return"Anyone can see your profile and albums";case"friends":return"Only your friends can see your content";case"private":return"Only you can see your content";default:return""}},G=e=>{switch(e){case"public":default:return(0,t.jsx)(p.A,{className:"h-4 w-4"});case"friends":return(0,t.jsx)(h.A,{className:"h-4 w-4"});case"private":return(0,t.jsx)(g.A,{className:"h-4 w-4"})}};return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[(0,t.jsx)(v.A,{className:"h-8 w-8"}),"Settings"]}),(0,t.jsx)("p",{className:"text-gray-800 mt-2",children:"Manage your account preferences and privacy settings"})]}),E&&(0,t.jsx)(u.Zp,{className:"border-red-200 bg-red-50",children:(0,t.jsx)(u.Wu,{className:"pt-6",children:(0,t.jsx)("p",{className:"text-red-600 font-medium",children:E})})}),D&&(0,t.jsx)(u.Zp,{className:"border-green-200 bg-green-50",children:(0,t.jsx)(u.Wu,{className:"pt-6",children:(0,t.jsx)("p",{className:"text-green-600 font-medium",children:D})})}),(0,t.jsxs)(u.Zp,{children:[(0,t.jsxs)(u.aR,{children:[(0,t.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(w.A,{className:"h-5 w-5"}),"Privacy & Visibility"]}),(0,t.jsx)(u.BT,{children:"Control who can see your profile and adventures"})]}),(0,t.jsx)(u.Wu,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(d.J,{children:"Profile Visibility"}),(0,t.jsxs)(x.l6,{value:q,onValueChange:M,disabled:R,children:[(0,t.jsx)(x.bq,{className:"w-full",children:(0,t.jsx)(x.yv,{placeholder:"Select privacy level"})}),(0,t.jsxs)(x.gC,{children:[(0,t.jsx)(x.eb,{value:"public",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(p.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Public"})]})}),(0,t.jsx)(x.eb,{value:"friends",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(h.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Friends Only"})]})}),(0,t.jsx)(x.eb,{value:"private",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(g.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Private"})]})})]})]}),(0,t.jsxs)("p",{className:"text-sm text-gray-800 mt-1 flex items-center gap-2",children:[G(q),X(q)]})]}),(0,t.jsxs)("div",{className:"pt-4 border-t",children:[(0,t.jsx)(m.E,{variant:"outline",className:"mb-2",children:"Current Setting"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[G(q),(0,t.jsx)("span",{className:"font-medium capitalize",children:q}),(0,t.jsxs)("span",{className:"text-gray-800",children:["- ",X(q)]})]})]})]})})]}),(0,t.jsx)(_,{}),(0,t.jsx)(O,{}),(0,t.jsxs)(u.Zp,{children:[(0,t.jsxs)(u.aR,{children:[(0,t.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(j.A,{className:"h-5 w-5"}),"Security"]}),(0,t.jsx)(u.BT,{children:"Manage your account security and password"})]}),(0,t.jsx)(u.Wu,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.J,{htmlFor:"current-password",children:"Current Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(c.p,{id:"current-password",type:U?"text":"password",value:z.currentPassword,onChange:e=>I(r=>({...r,currentPassword:e.target.value})),placeholder:"Enter current password"}),(0,t.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>Z(!U),children:U?(0,t.jsx)(y.A,{className:"h-4 w-4 text-gray-700"}):(0,t.jsx)(b.A,{className:"h-4 w-4 text-gray-700"})})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.J,{htmlFor:"new-password",children:"New Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(c.p,{id:"new-password",type:F?"text":"password",value:z.newPassword,onChange:e=>I(r=>({...r,newPassword:e.target.value})),placeholder:"Enter new password"}),(0,t.jsx)("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>T(!F),children:F?(0,t.jsx)(y.A,{className:"h-4 w-4 text-gray-700"}):(0,t.jsx)(b.A,{className:"h-4 w-4 text-gray-700"})})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(d.J,{htmlFor:"confirm-password",children:"Confirm New Password"}),(0,t.jsx)(c.p,{id:"confirm-password",type:"password",value:z.confirmPassword,onChange:e=>I(r=>({...r,confirmPassword:e.target.value})),placeholder:"Confirm new password"})]}),(0,t.jsx)(o.$,{onClick:W,disabled:R||!z.currentPassword||!z.newPassword||!z.confirmPassword,className:"w-full sm:w-auto",children:R?"Updating...":"Update Password"})]})})]}),(0,t.jsxs)(u.Zp,{children:[(0,t.jsxs)(u.aR,{children:[(0,t.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(N.A,{className:"h-5 w-5"}),"Notifications"]}),(0,t.jsx)(u.BT,{children:"Configure how you receive notifications"})]}),(0,t.jsx)(u.Wu,{children:(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsx)("div",{className:"text-sm text-gray-800",children:"Notification preferences will be available in a future update."})})})]}),(0,t.jsxs)(u.Zp,{children:[(0,t.jsxs)(u.aR,{children:[(0,t.jsxs)(u.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(P.A,{className:"h-5 w-5"}),"Data Management"]}),(0,t.jsx)(u.BT,{children:"Export or manage your Adventure Log data"})]}),(0,t.jsx)(u.Wu,{className:"space-y-4",children:(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium",children:"Export Your Data"}),(0,t.jsx)("p",{className:"text-sm text-gray-800",children:"Download all your albums, photos, and profile data"})]}),(0,t.jsxs)(o.$,{variant:"outline",onClick:V,disabled:R,children:[(0,t.jsx)(P.A,{className:"h-4 w-4 mr-2"}),"Export"]})]})})})]}),(0,t.jsxs)(u.Zp,{className:"border-red-200",children:[(0,t.jsxs)(u.aR,{children:[(0,t.jsxs)(u.ZB,{className:"flex items-center gap-2 text-red-600",children:[(0,t.jsx)(A.A,{className:"h-5 w-5"}),"Danger Zone"]}),(0,t.jsx)(u.BT,{children:"Irreversible and destructive actions"})]}),(0,t.jsx)(u.Wu,{children:(0,t.jsx)("div",{className:"space-y-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border border-red-200 rounded-lg bg-red-50",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-red-600",children:"Delete Account"}),(0,t.jsx)("p",{className:"text-sm text-red-500",children:"Permanently delete your account and all data"})]}),(0,t.jsxs)(f.lG,{children:[(0,t.jsx)(f.zM,{asChild:!0,children:(0,t.jsx)(o.$,{variant:"destructive",size:"sm",children:"Delete Account"})}),(0,t.jsxs)(f.Cf,{children:[(0,t.jsxs)(f.c7,{children:[(0,t.jsx)(f.L3,{children:"Are you absolutely sure?"}),(0,t.jsx)(f.rr,{children:"This action cannot be undone. This will permanently delete your account and remove all your data from our servers."})]}),(0,t.jsxs)(f.Es,{children:[(0,t.jsx)(o.$,{variant:"outline",children:"Cancel"}),(0,t.jsx)(o.$,{variant:"destructive",onClick:$,disabled:R,children:R?"Deleting...":"Yes, delete my account"})]})]})]})]})})})]})]})}},43691:(e,r,s)=>{"use strict";s.d(r,{A:()=>c,O:()=>o});var t=s(95155),a=s(12115),l=s(96648),n=s(82466);let i=(0,a.createContext)(void 0);function o(e){let{children:r}=e,[s,o]=(0,a.useState)(null),[c,d]=(0,a.useState)(null),[u,m]=(0,a.useState)(!0),[x,f]=(0,a.useState)(!1),p=(0,a.useRef)(new Map),h=(0,l.U)(),g=(0,a.useCallback)(async e=>{try{let r=e.replace(/-/g,"").substring(0,8),s="user_".concat(r),t={id:e,username:s,display_name:"New User",privacy_level:"public"},{data:a,error:l}=await h.from("profiles").insert(t).select().single();if(l){if(n.Rm.error("Profile creation error details",{component:"AuthProvider",action:"createProfile",userId:e,username:s,errorCode:l.code,errorMessage:l.message,errorDetails:l.details,errorHint:l.hint}),"23505"===l.code&&l.message.includes("username")){let s=Date.now().toString().slice(-4),a="user_".concat(r,"_").concat(s),{data:l,error:i}=await h.from("profiles").insert({...t,username:a}).select().single();if(i)return n.Rm.error("Error creating profile with fallback username",{component:"AuthProvider",action:"createProfile",userId:e,fallbackUsername:a,error:i}),null;return n.Rm.info("Profile created with fallback username",{component:"AuthProvider",action:"createProfile",userId:e,username:a}),l}if("23505"===l.code&&(l.message.includes("id")||l.message.includes("pkey"))){n.Rm.warn("Profile already exists, attempting to fetch existing profile",{component:"AuthProvider",action:"createProfile",userId:e});try{let{data:r,error:s}=await h.from("profiles").select("*").eq("id",e).single();if(!s&&r)return n.Rm.info("Successfully fetched existing profile after creation conflict",{component:"AuthProvider",action:"createProfile",userId:e}),r}catch(r){n.Rm.error("Failed to fetch existing profile after creation conflict",{component:"AuthProvider",action:"createProfile",userId:e,error:r})}}return n.Rm.error("Error creating profile",{component:"AuthProvider",action:"createProfile",userId:e,username:s,error:l}),null}return n.Rm.info("Profile created successfully",{component:"AuthProvider",action:"createProfile",userId:e,username:s}),a}catch(r){return n.Rm.error("Error creating profile",{component:"AuthProvider",action:"createProfile",userId:e},r instanceof Error?r:Error(String(r))),null}},[h]),v=(0,a.useCallback)(async function(e){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(r){let r=p.current.get(e);if(r&&Date.now()-r.timestamp<r.ttl)return r.data}try{let{data:r,error:s}=await h.from("profiles").select("*").eq("id",e).single();if(s){if(n.Rm.error("Profile fetch error details",{component:"AuthProvider",action:"fetchProfile",userId:e,errorCode:s.code,errorMessage:s.message,errorDetails:s.details,errorHint:s.hint}),"PGRST116"===s.code||s.message.includes("No rows returned")){n.Rm.warn("Profile not found, attempting to create",{component:"AuthProvider",action:"fetchProfile",userId:e});let r=await g(e);if(r)return p.current.set(e,{data:r,timestamp:Date.now(),ttl:3e5}),r}else if(s.message.includes("406")||s.message.includes("Not Acceptable")){n.Rm.error("RLS policy blocking profile access",{component:"AuthProvider",action:"fetchProfile",userId:e,error:s.message});let r=await g(e);if(r)return p.current.set(e,{data:r,timestamp:Date.now(),ttl:3e5}),r}return n.Rm.error("Error fetching profile",{component:"AuthProvider",action:"fetchProfile",userId:e,error:s}),null}return p.current.set(e,{data:r,timestamp:Date.now(),ttl:3e5}),r}catch(r){return n.Rm.error("Error fetching profile",{component:"AuthProvider",action:"fetchProfile",userId:e},r instanceof Error?r:Error(String(r))),null}},[h,g]),w=(0,a.useCallback)(async e=>{f(!0);try{let r=await v(e);d(r)}finally{f(!1)}},[v]),j=async()=>{if(s){f(!0);try{let e=await v(s.id,!1);d(e)}finally{f(!1)}}};(0,a.useEffect)(()=>{(async()=>{try{var e;let{data:{session:r}}=await h.auth.getSession();o(null!=(e=null==r?void 0:r.user)?e:null),m(!1),(null==r?void 0:r.user)&&w(r.user.id)}catch(e){n.Rm.error("Error getting session",{error:e}),m(!1)}})();let{data:{subscription:e}}=h.auth.onAuthStateChange(async(e,r)=>{var s;o(null!=(s=null==r?void 0:r.user)?s:null),m(!1),(null==r?void 0:r.user)?w(r.user.id):(d(null),f(!1),p.current.clear())});return()=>e.unsubscribe()},[w,h.auth]);let y=async()=>{try{await h.auth.signOut(),o(null),d(null),f(!1),p.current.clear()}catch(e){n.Rm.error("Error signing out",{error:e})}};return(0,t.jsx)(i.Provider,{value:{user:s,profile:c,authLoading:u,profileLoading:x,signOut:y,refreshProfile:j},children:r})}function c(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},64269:(e,r,s)=>{"use strict";s.d(r,{cn:()=>l});var t=s(2821),a=s(75889);function l(){for(var e=arguments.length,r=Array(e),s=0;s<e;s++)r[s]=arguments[s];return(0,a.QP)((0,t.$)(r))}},65142:(e,r,s)=>{"use strict";s.d(r,{p:()=>l});var t=s(95155);s(12115);var a=s(64269);function l(e){let{className:r,type:s,...l}=e;return(0,t.jsx)("input",{type:s,"data-slot":"input",className:(0,a.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",r),...l})}},76444:(e,r,s)=>{"use strict";s.d(r,{J:()=>n});var t=s(95155);s(12115);var a=s(10489),l=s(64269);function n(e){let{className:r,...s}=e;return(0,t.jsx)(a.b,{"data-slot":"label",className:(0,l.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",r),...s})}},82466:(e,r,s)=>{"use strict";s.d(r,{Rm:()=>n});var t=function(e){return e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR",e}({});class a{shouldLog(e){return e>=this.minLevel}formatTimestamp(){return new Date().toISOString()}createLogEntry(e,r,s,t){return{level:e,message:r,timestamp:this.formatTimestamp(),context:s,error:t}}formatConsoleMessage(e){let r=t[e.level],s=e.context?" [".concat(Object.entries(e.context).map(e=>{let[r,s]=e;return"".concat(r,":").concat(s)}).join(", "),"]"):"";return"[".concat(e.timestamp,"] ").concat(r).concat(s,": ").concat(e.message)}logToConsole(e){if(!this.shouldLog(e.level))return;let r=this.formatConsoleMessage(e);switch(e.level){case 0:console.debug(r,e.error||"");break;case 1:console.info(r,e.error||"");break;case 2:console.warn(r,e.error||"");break;case 3:console.error(r,e.error||"")}}logToExternalService(e){this.isDevelopment||e.level}log(e,r,s,t){let a=this.createLogEntry(e,r,s,t);this.logToConsole(a),this.logToExternalService(a)}debug(e,r){this.log(0,e,r)}info(e,r){this.log(1,e,r)}warn(e,r,s){this.log(2,e,r,s)}error(e,r,s){this.log(3,e,r,s)}userAction(e,r,s){this.info("User action: ".concat(e),{component:"user-action",action:e,userId:r,...s})}apiCall(e,r,s){this.debug("API call: ".concat(r," ").concat(e),{component:"api",endpoint:e,method:r,...s})}performance(e,r,s){this.info("Performance: ".concat(e," took ").concat(r,"ms"),{component:"performance",operation:e,duration:r,...s})}constructor(){this.isDevelopment=!1,this.minLevel=+!this.isDevelopment}}let l=new a,n={debug:(e,r)=>l.debug(e,r),info:(e,r)=>l.info(e,r),warn:(e,r,s)=>l.warn(e,r,s),error:(e,r,s)=>l.error(e,r,s),userAction:(e,r,s)=>l.userAction(e,r,s),apiCall:(e,r,s)=>l.apiCall(e,r,s),performance:(e,r,s)=>l.performance(e,r,s)}},86948:(e,r,s)=>{"use strict";s.d(r,{BT:()=>o,Wu:()=>c,ZB:()=>i,Zp:()=>l,aR:()=>n,wL:()=>d});var t=s(95155);s(12115);var a=s(64269);function l(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",r),...s})}function n(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",r),...s})}function i(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",r),...s})}function o(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",r),...s})}function c(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",r),...s})}function d(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-footer",className:(0,a.cn)("flex items-center px-6 [.border-t]:pt-6",r),...s})}},96648:(e,r,s)=>{"use strict";s.d(r,{U:()=>n});var t=s(87559);let a="https://jjrqstbzzvqrgaqwdvxw.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpqcnFzdGJ6enZxcmdhcXdkdnh3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg0ODc4MDcsImV4cCI6MjA3NDA2MzgwN30.aSHFHAA5Tv2EUDu7nxwOWXSFFUxbOUCR65Vi52QkjX4";if(!a||!l)throw Error("Missing Supabase environment variables");function n(){return(0,t.createBrowserClient)(a,l)}}},e=>{e.O(0,[4545,7559,2619,306,264,8868,5667,9197,5702,9409,8441,1255,7358],()=>e(e.s=30247)),_N_E=e.O()}]);