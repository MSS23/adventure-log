(()=>{var a={};a.id=2213,a.ids=[2213],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},1623:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>D.a,__next_app__:()=>J,handler:()=>L,pages:()=>I,routeModule:()=>K,tree:()=>H});var d=c(49754),e=c(9117),f=c(46595),g=c(32324),h=c(39326),i=c(38928),j=c(20175),k=c(12),l=c(54290),m=c(12696),n=c(82802),o=c(77533),p=c(45229),q=c(32822),r=c(261),s=c(26453),t=c(52474),u=c(26713),v=c(51356),w=c(62685),x=c(36225),y=c(63446),z=c(2762),A=c(45742),B=c(86439),C=c(81170),D=c.n(C),E=c(62506),F=c(91203),G={};for(let a in E)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(G[a]=()=>E[a]);c.d(b,G);let H={children:["",{children:["(app)",{children:["globe",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,23624)),"C:\\Users\\msidh\\Documents\\Adventure Log Application\\src\\app\\(app)\\globe\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(c.bind(c,46553)),"C:\\Users\\msidh\\Documents\\Adventure Log Application\\src\\app\\(app)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,87028,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,70440))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(c.bind(c,51472)),"C:\\Users\\msidh\\Documents\\Adventure Log Application\\src\\app\\layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,81170,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,87028,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,90461,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,32768,23)),"next/dist/client/components/builtin/unauthorized.js"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,70440))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,I=["C:\\Users\\msidh\\Documents\\Adventure Log Application\\src\\app\\(app)\\globe\\page.tsx"],J={require:c,loadChunk:()=>Promise.resolve()},K=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/(app)/globe/page",pathname:"/globe",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:H},distDir:"dist",relativeProjectDir:""});async function L(a,b,d){var C;let G="/(app)/globe/page";"/index"===G&&(G="/");let M=(0,h.getRequestMeta)(a,"postponed"),N=(0,h.getRequestMeta)(a,"minimalMode"),O=await K.prepare(a,b,{srcPage:G,multiZoneDraftMode:!1});if(!O)return b.statusCode=400,b.end("Bad Request"),null==d.waitUntil||d.waitUntil.call(d,Promise.resolve()),null;let{buildId:P,query:Q,params:R,parsedUrl:S,pageIsDynamic:T,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,serverActionsManifest:X,clientReferenceManifest:Y,subresourceIntegrityManifest:Z,prerenderManifest:$,isDraftMode:_,resolvedPathname:aa,revalidateOnlyGenerated:ab,routerServerContext:ac,nextConfig:ad,interceptionRoutePatterns:ae}=O,af=S.pathname||"/",ag=(0,r.normalizeAppPath)(G),{isOnDemandRevalidate:ah}=O,ai=K.match(af,$),aj=!!$.routes[aa],ak=!!(ai||aj||$.routes[ag]),al=a.headers["user-agent"]||"",am=(0,u.getBotType)(al),an=(0,p.isHtmlBotRequest)(a),ao=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??"1"===a.headers[t.NEXT_ROUTER_PREFETCH_HEADER],ap=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[t.RSC_HEADER],aq=(0,s.getIsPossibleServerAction)(a),ar=(0,m.checkIsAppPPREnabled)(ad.experimental.ppr)&&(null==(C=$.routes[ag]??$.dynamicRoutes[ag])?void 0:C.renderingMode)==="PARTIALLY_STATIC",as=!1,at=!1,au=ar?M:void 0,av=ar&&ap&&!ao,aw=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),ax=!al||(0,p.shouldServeStreamingMetadata)(al,ad.htmlLimitedBots);an&&ar&&(ak=!1,ax=!1);let ay=!0===K.isDev||!ak||"string"==typeof M||av,az=an&&ar,aA=null;_||!ak||ay||aq||au||av||(aA=aa);let aB=aA;!aB&&K.isDev&&(aB=aa),K.isDev||_||!ak||!ap||av||(0,k.d)(a.headers);let aC={...E,tree:H,pages:I,GlobalError:D(),handler:L,routeModule:K,__next_app__:J};X&&Y&&(0,o.setReferenceManifestsSingleton)({page:G,clientReferenceManifest:Y,serverActionsManifest:X,serverModuleMap:(0,q.createServerModuleMap)({serverActionsManifest:X})});let aD=a.method||"GET",aE=(0,g.getTracer)(),aF=aE.getActiveScopeSpan();try{let f=K.getVaryHeader(aa,ae);b.setHeader("Vary",f);let k=async(c,d)=>{let e=new l.NodeNextRequest(a),f=new l.NodeNextResponse(b);return K.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aE.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aD} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aD} ${a.url}`)})},m=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:Q,params:R,page:ag,sharedContext:{buildId:P},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aC,Component:(0,j.T)(aC),params:R,routeModule:K,page:G,postponed:f,shouldWaitOnAllReady:az,serveStreamingMetadata:ax,supportsDynamicResponse:"string"==typeof f||ay,buildManifest:U,nextFontManifest:V,reactLoadableManifest:W,subresourceIntegrityManifest:Z,serverActionsManifest:X,clientReferenceManifest:Y,setIsrStatus:null==ac?void 0:ac.setIsrStatus,dir:c(33873).join(process.cwd(),K.relativeProjectDir),isDraftMode:_,isRevalidate:ak&&!f&&!av,botType:am,isOnDemandRevalidate:ah,isPossibleServerAction:aq,assetPrefix:ad.assetPrefix,nextConfigOutput:ad.output,crossOrigin:ad.crossOrigin,trailingSlash:ad.trailingSlash,previewProps:$.preview,deploymentId:ad.deploymentId,enableTainting:ad.experimental.taint,htmlLimitedBots:ad.htmlLimitedBots,devtoolSegmentExplorer:ad.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ad.reactMaxHeadersLength,multiZoneDraftMode:!1,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ad.experimental.cacheLife,basePath:ad.basePath,serverActions:ad.experimental.serverActions,...as?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:as}:{},experimental:{isRoutePPREnabled:ar,expireTime:ad.expireTime,staleTimes:ad.experimental.staleTimes,cacheComponents:!!ad.experimental.cacheComponents,clientSegmentCache:!!ad.experimental.clientSegmentCache,clientParamParsing:!!ad.experimental.clientParamParsing,dynamicOnHover:!!ad.experimental.dynamicOnHover,inlineCss:!!ad.experimental.inlineCss,authInterrupts:!!ad.experimental.authInterrupts,clientTraceMetadata:ad.experimental.clientTraceMetadata||[]},waitUntil:d.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>K.onRequestError(a,b,d,ac),err:(0,h.getRequestMeta)(a,"invokeError"),dev:K.isDev}},l=await k(e,i),{metadata:m}=l,{cacheControl:n,headers:o={},fetchTags:p}=m;if(p&&(o[y.NEXT_CACHE_TAGS_HEADER]=p),a.fetchMetrics=m.fetchMetrics,ak&&(null==n?void 0:n.revalidate)===0&&!K.isDev&&!ar){let a=m.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${aa}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:v.CachedRouteKind.APP_PAGE,html:l,headers:o,rscData:m.flightData,postponed:m.postponed,status:m.statusCode,segmentData:m.segmentData},cacheControl:n}},o=async({hasResolved:c,previousCacheEntry:f,isRevalidating:g,span:i})=>{let j,k=!1===K.isDev,l=c||b.writableEnded;if(ah&&ab&&!f&&!N)return(null==ac?void 0:ac.render404)?await ac.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ai&&(j=(0,w.parseFallbackField)(ai.fallback)),j===w.FallbackMode.PRERENDER&&(0,u.isBot)(al)&&(!ar||an)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),(null==f?void 0:f.isStale)===-1&&(ah=!0),ah&&(j!==w.FallbackMode.NOT_FOUND||f)&&(j=w.FallbackMode.BLOCKING_STATIC_RENDER),!N&&j!==w.FallbackMode.BLOCKING_STATIC_RENDER&&aB&&!l&&!_&&T&&(k||!aj)){let b;if((k||ai)&&j===w.FallbackMode.NOT_FOUND)throw new B.NoFallbackError;if(ar&&!ap){let c="string"==typeof(null==ai?void 0:ai.fallback)?ai.fallback:k?ag:null;if(b=await K.handleResponse({cacheKey:c,req:a,nextConfig:ad,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:$,isRoutePPREnabled:ar,responseGenerator:async()=>m({span:i,postponed:void 0,fallbackRouteParams:k||at?(0,n.u)(ag):null}),waitUntil:d.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=ah||g||!au?void 0:au;if(as&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:v.CachedRouteKind.PAGES,html:x.default.EMPTY,pageData:{},headers:void 0,status:void 0}};let p=T&&ar&&((0,h.getRequestMeta)(a,"renderFallbackShell")||at)?(0,n.u)(af):null;return m({span:i,postponed:o,fallbackRouteParams:p})},p=async c=>{var f,g,i,j,k;let l,n=await K.handleResponse({cacheKey:aA,responseGenerator:a=>o({span:c,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:ah,isRoutePPREnabled:ar,req:a,nextConfig:ad,prerenderManifest:$,waitUntil:d.waitUntil});if(_&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),K.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!n){if(aA)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(f=n.value)?void 0:f.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(i=n.value)?void 0:i.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof n.value.postponed;ak&&!av&&(!p||ao)&&(N||b.setHeader("x-nextjs-cache",ah?"REVALIDATED":n.isMiss?"MISS":n.isStale?"STALE":"HIT"),b.setHeader(t.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=n;if(au)l={revalidate:0,expire:void 0};else if(N&&ap&&!ao&&ar)l={revalidate:0,expire:void 0};else if(!K.isDev)if(_)l={revalidate:0,expire:void 0};else if(ak){if(n.cacheControl)if("number"==typeof n.cacheControl.revalidate){if(n.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${n.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});l={revalidate:n.cacheControl.revalidate,expire:(null==(j=n.cacheControl)?void 0:j.expire)??ad.expireTime}}else l={revalidate:y.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(l={revalidate:0,expire:void 0});if(n.cacheControl=l,"string"==typeof aw&&(null==q?void 0:q.kind)===v.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(k=q.headers)?void 0:k[y.NEXT_CACHE_TAGS_HEADER];N&&ak&&c&&"string"==typeof c&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(aw);return void 0!==d?(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(d,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl}):(b.statusCode=204,(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.EMPTY,cacheControl:n.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...n,value:{...n.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&au)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(N&&ak||delete a[y.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let s=null==(g=q.headers)?void 0:g[y.NEXT_CACHE_TAGS_HEADER];if(N&&ak&&s&&"string"==typeof s&&b.setHeader(y.NEXT_CACHE_TAGS_HEADER,s),!q.status||ap&&ar||(b.statusCode=q.status),!N&&q.status&&F.RedirectStatusCode[q.status]&&ap&&(b.statusCode=200),p&&b.setHeader(t.NEXT_DID_POSTPONE_HEADER,"1"),ap&&!_){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:q.html,cacheControl:av?{revalidate:0,expire:void 0}:n.cacheControl})}return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:x.default.fromStatic(q.rscData,t.RSC_CONTENT_TYPE_HEADER),cacheControl:n.cacheControl})}let u=q.html;if(!p||N||ap)return(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:n.cacheControl});if(as)return u.push(new ReadableStream({start(a){a.enqueue(z.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}});let w=new TransformStream;return u.push(w.readable),m({span:c,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==v.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(w.writable)}).catch(a=>{w.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,A.sendRenderResult)({req:a,res:b,generateEtags:ad.generateEtags,poweredByHeader:ad.poweredByHeader,result:u,cacheControl:{revalidate:0,expire:void 0}})};if(!aF)return await aE.withPropagatedContext(a.headers,()=>aE.trace(i.BaseServerSpan.handleRequest,{spanName:`${aD} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aD,"http.target":a.url}},p));await p(aF)}catch(b){throw aF||b instanceof B.NoFallbackError||await K.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ak,isOnDemandRevalidate:ah})},ac),b}}},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8294:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},8635:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]])},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:a=>{"use strict";a.exports=require("punycode")},14263:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},15303:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},22551:(a,b,c)=>{Promise.resolve().then(c.bind(c,23624))},23624:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(97954).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\msidh\\\\Documents\\\\Adventure Log Application\\\\src\\\\app\\\\(app)\\\\globe\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\msidh\\Documents\\Adventure Log Application\\src\\app\\(app)\\globe\\page.tsx","default")},24207:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"BailoutToCSR",{enumerable:!0,get:function(){return e}});let d=c(84339);function e(a){let{reason:b,children:c}=a;throw Object.defineProperty(new d.BailoutToCSRError(b),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0})}},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},27279:(a,b,c)=>{Promise.resolve().then(c.bind(c,93227))},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31851:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("zoom-out",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]])},33540:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"default",{enumerable:!0,get:function(){return e}});let d=c(35288)._(c(43972));function e(a,b){var c;let e={};"function"==typeof a&&(e.loader=a);let f={...e,...b};return(0,d.default)({...f,modules:null==(c=f.loadableGenerated)?void 0:c.modules})}("function"==typeof b.default||"object"==typeof b.default&&null!==b.default)&&void 0===b.default.__esModule&&(Object.defineProperty(b.default,"__esModule",{value:!0}),Object.assign(b.default,b),a.exports=b.default)},33872:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("zoom-in",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]])},33873:a=>{"use strict";a.exports=require("path")},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},43972:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"default",{enumerable:!0,get:function(){return j}});let d=c(21124),e=c(38301),f=c(24207),g=c(52402);function h(a){return{default:a&&"default"in a?a.default:a}}let i={loader:()=>Promise.resolve(h(()=>null)),loading:null,ssr:!0},j=function(a){let b={...i,...a},c=(0,e.lazy)(()=>b.loader().then(h)),j=b.loading;function k(a){let h=j?(0,d.jsx)(j,{isLoading:!0,pastDelay:!0,error:null}):null,i=!b.ssr||!!b.loading,k=i?e.Suspense:e.Fragment,l=b.ssr?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.PreloadChunks,{moduleIds:b.modules}),(0,d.jsx)(c,{...a})]}):(0,d.jsx)(f.BailoutToCSR,{reason:"next/dynamic",children:(0,d.jsx)(c,{...a})});return(0,d.jsx)(k,{...i?{fallback:h}:{},children:l})}return k.displayName="LoadableComponent",k}},52402:(a,b,c)=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"PreloadChunks",{enumerable:!0,get:function(){return h}});let d=c(21124),e=c(23312),f=c(29294),g=c(61348);function h(a){let{moduleIds:b}=a,c=f.workAsyncStorage.getStore();if(void 0===c)return null;let h=[];if(c.reactLoadableManifest&&b){let a=c.reactLoadableManifest;for(let c of b){if(!a[c])continue;let b=a[c].files;h.push(...b)}}return 0===h.length?null:(0,d.jsx)(d.Fragment,{children:h.map(a=>{let b=c.assetPrefix+"/_next/"+(0,g.encodeURIPath)(a);return a.endsWith(".css")?(0,d.jsx)("link",{precedence:"dynamic",href:b,rel:"stylesheet",as:"style"},a):((0,e.preload)(b,{as:"script",fetchPriority:"low"}),null)})})}},52647:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]])},55591:a=>{"use strict";a.exports=require("https")},59405:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},61348:(a,b)=>{"use strict";function c(a){return a.split("/").map(a=>encodeURIComponent(a)).join("/")}Object.defineProperty(b,"__esModule",{value:!0}),Object.defineProperty(b,"encodeURIPath",{enumerable:!0,get:function(){return c}})},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},72567:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},74075:a=>{"use strict";a.exports=require("zlib")},79551:a=>{"use strict";a.exports=require("url")},81630:a=>{"use strict";a.exports=require("http")},85265:(a,b,c)=>{"use strict";c.d(b,{A:()=>d});let d=(0,c(23339).A)("thermometer",[["path",{d:"M14 4v10.54a4 4 0 1 1-4 0V4a2 2 0 0 1 4 0Z",key:"17jzev"}]])},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},93227:(a,b,c)=>{"use strict";let d;c.r(b),c.d(b,{default:()=>c$});var e=c(21124),f=c(38301),g=c(33540),h=c.n(g),i=c(70798),j=c(69773);function k(a){if(a)return Array.isArray(a)?a[0]?.privacy_level:a.privacy_level}var l=c(57618);function m(a){return Math.PI/180*a}function n(a){return 180/Math.PI*a}function o(a,b){let c=m(a.latitude),d=m(a.longitude),e=m(b.latitude),f=Math.sin((e-c)/2)**2+Math.cos(c)*Math.cos(e)*Math.sin((m(b.longitude)-d)/2)**2;return 2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f))*6371}function p(a,b){let c=m(a.latitude),d=m(b.latitude),e=m(b.longitude-a.longitude);return(n(Math.atan2(Math.sin(e)*Math.cos(d),Math.cos(c)*Math.sin(d)-Math.sin(c)*Math.cos(d)*Math.cos(e)))+360)%360}function q(a,b,c){let d=m(a.latitude),e=m(a.longitude),f=m(b.latitude),g=m(b.longitude),h=o(a,b)/6371,i=Math.sin((1-c)*h)/Math.sin(h),j=Math.sin(c*h)/Math.sin(h),k=i*Math.cos(d)*Math.cos(e)+j*Math.cos(f)*Math.cos(g),l=i*Math.cos(d)*Math.sin(e)+j*Math.cos(f)*Math.sin(g),p=Math.atan2(i*Math.sin(d)+j*Math.sin(f),Math.sqrt(k*k+l*l)),q=Math.atan2(l,k),r=Math.sin(c*Math.PI);return{lat:n(p),lng:n(q),altitude:.02*r}}class r{constructor(a,b,c){this.timeline=[],this.currentSegmentIndex=0,this.segmentProgress=0,this.isPlaying=!1,this.animationSpeed=1,this.currentYear=null,this.onPositionUpdate=a,this.onCameraUpdate=b,this.onSegmentComplete=c}setTimeline(a,b){this.timeline=a.filter(a=>a.year===b).sort((a,b)=>a.sequenceOrder-b.sequenceOrder),this.currentYear=b,this.reset()}play(){this.isPlaying=!0,this.animate()}pause(){this.isPlaying=!1}reset(){this.currentSegmentIndex=0,this.segmentProgress=0,this.isPlaying=!1}setSpeed(a){this.animationSpeed=Math.max(.1,Math.min(5,a))}seekToSegment(a){this.currentSegmentIndex=Math.max(0,Math.min(a,this.timeline.length-2)),this.segmentProgress=0}animate(){var a;if(!this.isPlaying||this.timeline.length<2)return;let b=this.timeline[this.currentSegmentIndex],c=this.timeline[this.currentSegmentIndex+1];if(!b||!c){this.isPlaying=!1;return}let d={latitude:b.latitude,longitude:b.longitude},e={latitude:c.latitude,longitude:c.longitude},f=(.005+.015*Math.min(o(d,e)/15e3,1))*this.animationSpeed;this.segmentProgress=Math.min(this.segmentProgress+.016*f,1);let g=(a=this.segmentProgress)*a*(3-2*a),h=q(d,e,g),i=this.segmentProgress<.99?q(d,e,g+.01):h,j=function(a,b,c){let d=p({latitude:a.lat,longitude:a.lng},{latitude:b.lat,longitude:b.lng}),e=Math.max(-30,Math.min(30,.5*((d-c+540)%360-180)));return{heading:d,pitch:Math.max(-15,Math.min(15,180/Math.PI*Math.atan2((b.altitude||0)-(a.altitude||0),.1))),bank:e}}(h,i,p(d,e)),k={position:h,rotation:j,speed:f*this.animationSpeed};this.onPositionUpdate?.(k);let l=function(a,b,c){if(!(c<.5))return{lat:b.lat,lng:b.lng,altitude:.12};{let d=Math.min(c+.1,1),e=q({latitude:a.lat,longitude:a.lng},{latitude:b.lat,longitude:b.lng},d);return{lat:e.lat,lng:e.lng,altitude:Math.max(.15,e.altitude||.1)}}}(h,{lat:e.latitude,lng:e.longitude,altitude:0},g);if(this.onCameraUpdate?.(l),this.segmentProgress>=1&&(this.onSegmentComplete?.(c),this.currentSegmentIndex++,this.segmentProgress=0,this.currentSegmentIndex>=this.timeline.length-1)){this.isPlaying=!1;return}this.isPlaying&&requestAnimationFrame(()=>this.animate())}getCurrentSegment(){return this.timeline[this.currentSegmentIndex]||null}getProgress(){let a=Math.max(this.timeline.length-1,1),b=this.currentSegmentIndex+this.segmentProgress;return{segment:this.currentSegmentIndex,total:a,percentage:b/a*100}}getTotalDuration(){let a=0;for(let b=0;b<this.timeline.length-1;b++){let c=this.timeline[b],d=this.timeline[b+1];a+=Math.max(o({latitude:c.latitude,longitude:c.longitude},{latitude:d.latitude,longitude:d.longitude})/800,2)}return a/this.animationSpeed}}class s{static toRadians(a){return Math.PI/180*a}static toDegrees(a){return 180/Math.PI*a}static calculateDistance(a,b){let c=this.toRadians(a.lat),d=this.toRadians(a.lng),e=this.toRadians(b.lat),f=Math.sin((e-c)/2)**2+Math.cos(c)*Math.cos(e)*Math.sin((this.toRadians(b.lng)-d)/2)**2;return 2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f))*6371}static calculateBearing(a,b){let c=this.toRadians(a.lat),d=this.toRadians(b.lat),e=this.toRadians(b.lng-a.lng),f=Math.atan2(Math.sin(e)*Math.cos(d),Math.cos(c)*Math.sin(d)-Math.sin(c)*Math.cos(d)*Math.cos(e));return(this.toDegrees(f)+360)%360}static generateFlightPath(a,b,c=100){let d=this.calculateDistance(a,b),e=this.calculateBearing(a,b),f=Math.min(8e3,Math.max(3e3,50*d)),g=this.generateGreatCircleWaypoints(a,b,c);return{start:a,end:b,distance:d,duration:f,waypoints:g,bearing:e,estimatedFlightTime:d/900}}static generateGreatCircleWaypoints(a,b,c){let d=[],e=this.toRadians(a.lat),f=this.toRadians(a.lng),g=this.toRadians(b.lat),h=this.toRadians(b.lng),i=this.calculateDistance(a,b)/6371;for(let a=0;a<=c;a++){let b=a/c,j=Math.sin((1-b)*i)/Math.sin(i),k=Math.sin(b*i)/Math.sin(i),l=j*Math.cos(e)*Math.cos(f)+k*Math.cos(g)*Math.cos(h),m=j*Math.cos(e)*Math.sin(f)+k*Math.cos(g)*Math.sin(h),n=Math.atan2(j*Math.sin(e)+k*Math.sin(g),Math.sqrt(l*l+m*m)),o=Math.atan2(m,l);d.push({lat:this.toDegrees(n),lng:this.toDegrees(o)})}return d}static generateFlightSegments(a,b=60){let c=[],d=Math.floor(a.duration/1e3*b);for(let e=0;e<=d;e++){let f=e/d,g=Math.floor(f*(a.waypoints.length-1)),h=f*(a.waypoints.length-1)%1,i=a.waypoints[g],j=a.waypoints[Math.min(g+1,a.waypoints.length-1)],k=i.lat+(j.lat-i.lat)*h,l=i.lng+(j.lng-i.lng)*h,m=this.calculateAltitude(f,a.distance),n=this.calculateBearing(i,j);c.push({lat:k,lng:l,altitude:m,progress:f,heading:n,timestamp:e/b*1e3})}return c}static calculateAltitude(a,b){let c=b<500?.012:.02;return a<.1?a/.1*c:a>.9?(1-a)/.1*c:c}static calculateAirplaneRotation(a,b,c){let d=this.calculatePitch(a,c);return{pitch:d,yaw:a.heading,roll:this.calculateRoll(a,b)}}static calculatePitch(a,b){return b?180/Math.PI*Math.atan2(b.altitude-a.altitude,.001):0}static calculateRoll(a,b){if(!b)return 0;let c=a.heading-b.heading;return c>180&&(c-=360),c<-180&&(c+=360),Math.max(-30,Math.min(30,2*c))}static generateYearFlightPaths(a){let b=a.sort((a,b)=>a.date.getTime()-b.date.getTime()),c=[];for(let a=0;a<b.length-1;a++){let d=b[a],e=b[a+1],f=this.generateFlightPath(d,e);c.push(f)}return c}static calculateCameraPosition(a){let b=a.altitude+.5,c=this.toRadians(a.heading+180);return{lat:a.lat+.05*Math.cos(c),lng:a.lng+.05*Math.sin(c),altitude:b}}}let t="srgb",u="srgb-linear",v="linear",w="srgb";class x{addEventListener(a,b){void 0===this._listeners&&(this._listeners={});let c=this._listeners;void 0===c[a]&&(c[a]=[]),-1===c[a].indexOf(b)&&c[a].push(b)}hasEventListener(a,b){let c=this._listeners;return void 0!==c&&void 0!==c[a]&&-1!==c[a].indexOf(b)}removeEventListener(a,b){let c=this._listeners;if(void 0===c)return;let d=c[a];if(void 0!==d){let a=d.indexOf(b);-1!==a&&d.splice(a,1)}}dispatchEvent(a){let b=this._listeners;if(void 0===b)return;let c=b[a.type];if(void 0!==c){a.target=this;let b=c.slice(0);for(let c=0,d=b.length;c<d;c++)b[c].call(this,a);a.target=null}}}let y=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];function z(){let a=0xffffffff*Math.random()|0,b=0xffffffff*Math.random()|0,c=0xffffffff*Math.random()|0,d=0xffffffff*Math.random()|0;return(y[255&a]+y[a>>8&255]+y[a>>16&255]+y[a>>24&255]+"-"+y[255&b]+y[b>>8&255]+"-"+y[b>>16&15|64]+y[b>>24&255]+"-"+y[63&c|128]+y[c>>8&255]+"-"+y[c>>16&255]+y[c>>24&255]+y[255&d]+y[d>>8&255]+y[d>>16&255]+y[d>>24&255]).toLowerCase()}function A(a,b,c){return Math.max(b,Math.min(c,a))}function B(a,b){switch(b.constructor){case Float32Array:return a;case Uint32Array:return a/0xffffffff;case Uint16Array:return a/65535;case Uint8Array:return a/255;case Int32Array:return Math.max(a/0x7fffffff,-1);case Int16Array:return Math.max(a/32767,-1);case Int8Array:return Math.max(a/127,-1);default:throw Error("Invalid component type.")}}function C(a,b){switch(b.constructor){case Float32Array:return a;case Uint32Array:return Math.round(0xffffffff*a);case Uint16Array:return Math.round(65535*a);case Uint8Array:return Math.round(255*a);case Int32Array:return Math.round(0x7fffffff*a);case Int16Array:return Math.round(32767*a);case Int8Array:return Math.round(127*a);default:throw Error("Invalid component type.")}}class D{constructor(a=0,b=0){D.prototype.isVector2=!0,this.x=a,this.y=b}get width(){return this.x}set width(a){this.x=a}get height(){return this.y}set height(a){this.y=a}set(a,b){return this.x=a,this.y=b,this}setScalar(a){return this.x=a,this.y=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setComponent(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;default:throw Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y)}copy(a){return this.x=a.x,this.y=a.y,this}add(a){return this.x+=a.x,this.y+=a.y,this}addScalar(a){return this.x+=a,this.y+=a,this}addVectors(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this}addScaledVector(a,b){return this.x+=a.x*b,this.y+=a.y*b,this}sub(a){return this.x-=a.x,this.y-=a.y,this}subScalar(a){return this.x-=a,this.y-=a,this}subVectors(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this}multiply(a){return this.x*=a.x,this.y*=a.y,this}multiplyScalar(a){return this.x*=a,this.y*=a,this}divide(a){return this.x/=a.x,this.y/=a.y,this}divideScalar(a){return this.multiplyScalar(1/a)}applyMatrix3(a){let b=this.x,c=this.y,d=a.elements;return this.x=d[0]*b+d[3]*c+d[6],this.y=d[1]*b+d[4]*c+d[7],this}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this}clamp(a,b){return this.x=A(this.x,a.x,b.x),this.y=A(this.y,a.y,b.y),this}clampScalar(a,b){return this.x=A(this.x,a,b),this.y=A(this.y,a,b),this}clampLength(a,b){let c=this.length();return this.divideScalar(c||1).multiplyScalar(A(c,a,b))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(a){return this.x*a.x+this.y*a.y}cross(a){return this.x*a.y-this.y*a.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(a){let b=Math.sqrt(this.lengthSq()*a.lengthSq());return 0===b?Math.PI/2:Math.acos(A(this.dot(a)/b,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){let b=this.x-a.x,c=this.y-a.y;return b*b+c*c}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this}lerpVectors(a,b,c){return this.x=a.x+(b.x-a.x)*c,this.y=a.y+(b.y-a.y)*c,this}equals(a){return a.x===this.x&&a.y===this.y}fromArray(a,b=0){return this.x=a[b],this.y=a[b+1],this}toArray(a=[],b=0){return a[b]=this.x,a[b+1]=this.y,a}fromBufferAttribute(a,b){return this.x=a.getX(b),this.y=a.getY(b),this}rotateAround(a,b){let c=Math.cos(b),d=Math.sin(b),e=this.x-a.x,f=this.y-a.y;return this.x=e*c-f*d+a.x,this.y=e*d+f*c+a.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class E{constructor(a=0,b=0,c=0,d=1){this.isQuaternion=!0,this._x=a,this._y=b,this._z=c,this._w=d}static slerpFlat(a,b,c,d,e,f,g){let h=c[d+0],i=c[d+1],j=c[d+2],k=c[d+3],l=e[f+0],m=e[f+1],n=e[f+2],o=e[f+3];if(0===g){a[b+0]=h,a[b+1]=i,a[b+2]=j,a[b+3]=k;return}if(1===g){a[b+0]=l,a[b+1]=m,a[b+2]=n,a[b+3]=o;return}if(k!==o||h!==l||i!==m||j!==n){let a=1-g,b=h*l+i*m+j*n+k*o,c=b>=0?1:-1,d=1-b*b;if(d>Number.EPSILON){let e=Math.sqrt(d),f=Math.atan2(e,b*c);a=Math.sin(a*f)/e,g=Math.sin(g*f)/e}let e=g*c;if(h=h*a+l*e,i=i*a+m*e,j=j*a+n*e,k=k*a+o*e,a===1-g){let a=1/Math.sqrt(h*h+i*i+j*j+k*k);h*=a,i*=a,j*=a,k*=a}}a[b]=h,a[b+1]=i,a[b+2]=j,a[b+3]=k}static multiplyQuaternionsFlat(a,b,c,d,e,f){let g=c[d],h=c[d+1],i=c[d+2],j=c[d+3],k=e[f],l=e[f+1],m=e[f+2],n=e[f+3];return a[b]=g*n+j*k+h*m-i*l,a[b+1]=h*n+j*l+i*k-g*m,a[b+2]=i*n+j*m+g*l-h*k,a[b+3]=j*n-g*k-h*l-i*m,a}get x(){return this._x}set x(a){this._x=a,this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a,this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a,this._onChangeCallback()}get w(){return this._w}set w(a){this._w=a,this._onChangeCallback()}set(a,b,c,d){return this._x=a,this._y=b,this._z=c,this._w=d,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(a){return this._x=a.x,this._y=a.y,this._z=a.z,this._w=a.w,this._onChangeCallback(),this}setFromEuler(a,b=!0){let c=a._x,d=a._y,e=a._z,f=a._order,g=Math.cos,h=Math.sin,i=g(c/2),j=g(d/2),k=g(e/2),l=h(c/2),m=h(d/2),n=h(e/2);switch(f){case"XYZ":this._x=l*j*k+i*m*n,this._y=i*m*k-l*j*n,this._z=i*j*n+l*m*k,this._w=i*j*k-l*m*n;break;case"YXZ":this._x=l*j*k+i*m*n,this._y=i*m*k-l*j*n,this._z=i*j*n-l*m*k,this._w=i*j*k+l*m*n;break;case"ZXY":this._x=l*j*k-i*m*n,this._y=i*m*k+l*j*n,this._z=i*j*n+l*m*k,this._w=i*j*k-l*m*n;break;case"ZYX":this._x=l*j*k-i*m*n,this._y=i*m*k+l*j*n,this._z=i*j*n-l*m*k,this._w=i*j*k+l*m*n;break;case"YZX":this._x=l*j*k+i*m*n,this._y=i*m*k+l*j*n,this._z=i*j*n-l*m*k,this._w=i*j*k-l*m*n;break;case"XZY":this._x=l*j*k-i*m*n,this._y=i*m*k-l*j*n,this._z=i*j*n+l*m*k,this._w=i*j*k+l*m*n;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+f)}return!0===b&&this._onChangeCallback(),this}setFromAxisAngle(a,b){let c=b/2,d=Math.sin(c);return this._x=a.x*d,this._y=a.y*d,this._z=a.z*d,this._w=Math.cos(c),this._onChangeCallback(),this}setFromRotationMatrix(a){let b=a.elements,c=b[0],d=b[4],e=b[8],f=b[1],g=b[5],h=b[9],i=b[2],j=b[6],k=b[10],l=c+g+k;if(l>0){let a=.5/Math.sqrt(l+1);this._w=.25/a,this._x=(j-h)*a,this._y=(e-i)*a,this._z=(f-d)*a}else if(c>g&&c>k){let a=2*Math.sqrt(1+c-g-k);this._w=(j-h)/a,this._x=.25*a,this._y=(d+f)/a,this._z=(e+i)/a}else if(g>k){let a=2*Math.sqrt(1+g-c-k);this._w=(e-i)/a,this._x=(d+f)/a,this._y=.25*a,this._z=(h+j)/a}else{let a=2*Math.sqrt(1+k-c-g);this._w=(f-d)/a,this._x=(e+i)/a,this._y=(h+j)/a,this._z=.25*a}return this._onChangeCallback(),this}setFromUnitVectors(a,b){let c=a.dot(b)+1;return c<1e-8?(c=0,Math.abs(a.x)>Math.abs(a.z)?(this._x=-a.y,this._y=a.x,this._z=0):(this._x=0,this._y=-a.z,this._z=a.y)):(this._x=a.y*b.z-a.z*b.y,this._y=a.z*b.x-a.x*b.z,this._z=a.x*b.y-a.y*b.x),this._w=c,this.normalize()}angleTo(a){return 2*Math.acos(Math.abs(A(this.dot(a),-1,1)))}rotateTowards(a,b){let c=this.angleTo(a);if(0===c)return this;let d=Math.min(1,b/c);return this.slerp(a,d),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(a){return this._x*a._x+this._y*a._y+this._z*a._z+this._w*a._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let a=this.length();return 0===a?(this._x=0,this._y=0,this._z=0,this._w=1):(a=1/a,this._x=this._x*a,this._y=this._y*a,this._z=this._z*a,this._w=this._w*a),this._onChangeCallback(),this}multiply(a){return this.multiplyQuaternions(this,a)}premultiply(a){return this.multiplyQuaternions(a,this)}multiplyQuaternions(a,b){let c=a._x,d=a._y,e=a._z,f=a._w,g=b._x,h=b._y,i=b._z,j=b._w;return this._x=c*j+f*g+d*i-e*h,this._y=d*j+f*h+e*g-c*i,this._z=e*j+f*i+c*h-d*g,this._w=f*j-c*g-d*h-e*i,this._onChangeCallback(),this}slerp(a,b){if(0===b)return this;if(1===b)return this.copy(a);let c=this._x,d=this._y,e=this._z,f=this._w,g=f*a._w+c*a._x+d*a._y+e*a._z;if(g<0?(this._w=-a._w,this._x=-a._x,this._y=-a._y,this._z=-a._z,g=-g):this.copy(a),g>=1)return this._w=f,this._x=c,this._y=d,this._z=e,this;let h=1-g*g;if(h<=Number.EPSILON){let a=1-b;return this._w=a*f+b*this._w,this._x=a*c+b*this._x,this._y=a*d+b*this._y,this._z=a*e+b*this._z,this.normalize(),this}let i=Math.sqrt(h),j=Math.atan2(i,g),k=Math.sin((1-b)*j)/i,l=Math.sin(b*j)/i;return this._w=f*k+this._w*l,this._x=c*k+this._x*l,this._y=d*k+this._y*l,this._z=e*k+this._z*l,this._onChangeCallback(),this}slerpQuaternions(a,b,c){return this.copy(a).slerp(b,c)}random(){let a=2*Math.PI*Math.random(),b=2*Math.PI*Math.random(),c=Math.random(),d=Math.sqrt(1-c),e=Math.sqrt(c);return this.set(d*Math.sin(a),d*Math.cos(a),e*Math.sin(b),e*Math.cos(b))}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._w===this._w}fromArray(a,b=0){return this._x=a[b],this._y=a[b+1],this._z=a[b+2],this._w=a[b+3],this._onChangeCallback(),this}toArray(a=[],b=0){return a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._w,a}fromBufferAttribute(a,b){return this._x=a.getX(b),this._y=a.getY(b),this._z=a.getZ(b),this._w=a.getW(b),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(a){return this._onChangeCallback=a,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class F{constructor(a=0,b=0,c=0){F.prototype.isVector3=!0,this.x=a,this.y=b,this.z=c}set(a,b,c){return void 0===c&&(c=this.z),this.x=a,this.y=b,this.z=c,this}setScalar(a){return this.x=a,this.y=a,this.z=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setZ(a){return this.z=a,this}setComponent(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;default:throw Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(a){return this.x=a.x,this.y=a.y,this.z=a.z,this}add(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this}addScalar(a){return this.x+=a,this.y+=a,this.z+=a,this}addVectors(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this}addScaledVector(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this}sub(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this}subScalar(a){return this.x-=a,this.y-=a,this.z-=a,this}subVectors(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this}multiply(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this}multiplyScalar(a){return this.x*=a,this.y*=a,this.z*=a,this}multiplyVectors(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this}applyEuler(a){return this.applyQuaternion(H.setFromEuler(a))}applyAxisAngle(a,b){return this.applyQuaternion(H.setFromAxisAngle(a,b))}applyMatrix3(a){let b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[3]*c+e[6]*d,this.y=e[1]*b+e[4]*c+e[7]*d,this.z=e[2]*b+e[5]*c+e[8]*d,this}applyNormalMatrix(a){return this.applyMatrix3(a).normalize()}applyMatrix4(a){let b=this.x,c=this.y,d=this.z,e=a.elements,f=1/(e[3]*b+e[7]*c+e[11]*d+e[15]);return this.x=(e[0]*b+e[4]*c+e[8]*d+e[12])*f,this.y=(e[1]*b+e[5]*c+e[9]*d+e[13])*f,this.z=(e[2]*b+e[6]*c+e[10]*d+e[14])*f,this}applyQuaternion(a){let b=this.x,c=this.y,d=this.z,e=a.x,f=a.y,g=a.z,h=a.w,i=2*(f*d-g*c),j=2*(g*b-e*d),k=2*(e*c-f*b);return this.x=b+h*i+f*k-g*j,this.y=c+h*j+g*i-e*k,this.z=d+h*k+e*j-f*i,this}project(a){return this.applyMatrix4(a.matrixWorldInverse).applyMatrix4(a.projectionMatrix)}unproject(a){return this.applyMatrix4(a.projectionMatrixInverse).applyMatrix4(a.matrixWorld)}transformDirection(a){let b=this.x,c=this.y,d=this.z,e=a.elements;return this.x=e[0]*b+e[4]*c+e[8]*d,this.y=e[1]*b+e[5]*c+e[9]*d,this.z=e[2]*b+e[6]*c+e[10]*d,this.normalize()}divide(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this}divideScalar(a){return this.multiplyScalar(1/a)}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this}clamp(a,b){return this.x=A(this.x,a.x,b.x),this.y=A(this.y,a.y,b.y),this.z=A(this.z,a.z,b.z),this}clampScalar(a,b){return this.x=A(this.x,a,b),this.y=A(this.y,a,b),this.z=A(this.z,a,b),this}clampLength(a,b){let c=this.length();return this.divideScalar(c||1).multiplyScalar(A(c,a,b))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this}lerpVectors(a,b,c){return this.x=a.x+(b.x-a.x)*c,this.y=a.y+(b.y-a.y)*c,this.z=a.z+(b.z-a.z)*c,this}cross(a){return this.crossVectors(this,a)}crossVectors(a,b){let c=a.x,d=a.y,e=a.z,f=b.x,g=b.y,h=b.z;return this.x=d*h-e*g,this.y=e*f-c*h,this.z=c*g-d*f,this}projectOnVector(a){let b=a.lengthSq();if(0===b)return this.set(0,0,0);let c=a.dot(this)/b;return this.copy(a).multiplyScalar(c)}projectOnPlane(a){return G.copy(this).projectOnVector(a),this.sub(G)}reflect(a){return this.sub(G.copy(a).multiplyScalar(2*this.dot(a)))}angleTo(a){let b=Math.sqrt(this.lengthSq()*a.lengthSq());return 0===b?Math.PI/2:Math.acos(A(this.dot(a)/b,-1,1))}distanceTo(a){return Math.sqrt(this.distanceToSquared(a))}distanceToSquared(a){let b=this.x-a.x,c=this.y-a.y,d=this.z-a.z;return b*b+c*c+d*d}manhattanDistanceTo(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)+Math.abs(this.z-a.z)}setFromSpherical(a){return this.setFromSphericalCoords(a.radius,a.phi,a.theta)}setFromSphericalCoords(a,b,c){let d=Math.sin(b)*a;return this.x=d*Math.sin(c),this.y=Math.cos(b)*a,this.z=d*Math.cos(c),this}setFromCylindrical(a){return this.setFromCylindricalCoords(a.radius,a.theta,a.y)}setFromCylindricalCoords(a,b,c){return this.x=a*Math.sin(b),this.y=c,this.z=a*Math.cos(b),this}setFromMatrixPosition(a){let b=a.elements;return this.x=b[12],this.y=b[13],this.z=b[14],this}setFromMatrixScale(a){let b=this.setFromMatrixColumn(a,0).length(),c=this.setFromMatrixColumn(a,1).length(),d=this.setFromMatrixColumn(a,2).length();return this.x=b,this.y=c,this.z=d,this}setFromMatrixColumn(a,b){return this.fromArray(a.elements,4*b)}setFromMatrix3Column(a,b){return this.fromArray(a.elements,3*b)}setFromEuler(a){return this.x=a._x,this.y=a._y,this.z=a._z,this}setFromColor(a){return this.x=a.r,this.y=a.g,this.z=a.b,this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z}fromArray(a,b=0){return this.x=a[b],this.y=a[b+1],this.z=a[b+2],this}toArray(a=[],b=0){return a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a}fromBufferAttribute(a,b){return this.x=a.getX(b),this.y=a.getY(b),this.z=a.getZ(b),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let a=Math.random()*Math.PI*2,b=2*Math.random()-1,c=Math.sqrt(1-b*b);return this.x=c*Math.cos(a),this.y=b,this.z=c*Math.sin(a),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}let G=new F,H=new E;class I{constructor(a,b,c,d,e,f,g,h,i){I.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==a&&this.set(a,b,c,d,e,f,g,h,i)}set(a,b,c,d,e,f,g,h,i){let j=this.elements;return j[0]=a,j[1]=d,j[2]=g,j[3]=b,j[4]=e,j[5]=h,j[6]=c,j[7]=f,j[8]=i,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(a){let b=this.elements,c=a.elements;return b[0]=c[0],b[1]=c[1],b[2]=c[2],b[3]=c[3],b[4]=c[4],b[5]=c[5],b[6]=c[6],b[7]=c[7],b[8]=c[8],this}extractBasis(a,b,c){return a.setFromMatrix3Column(this,0),b.setFromMatrix3Column(this,1),c.setFromMatrix3Column(this,2),this}setFromMatrix4(a){let b=a.elements;return this.set(b[0],b[4],b[8],b[1],b[5],b[9],b[2],b[6],b[10]),this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,b){let c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[3],h=c[6],i=c[1],j=c[4],k=c[7],l=c[2],m=c[5],n=c[8],o=d[0],p=d[3],q=d[6],r=d[1],s=d[4],t=d[7],u=d[2],v=d[5],w=d[8];return e[0]=f*o+g*r+h*u,e[3]=f*p+g*s+h*v,e[6]=f*q+g*t+h*w,e[1]=i*o+j*r+k*u,e[4]=i*p+j*s+k*v,e[7]=i*q+j*t+k*w,e[2]=l*o+m*r+n*u,e[5]=l*p+m*s+n*v,e[8]=l*q+m*t+n*w,this}multiplyScalar(a){let b=this.elements;return b[0]*=a,b[3]*=a,b[6]*=a,b[1]*=a,b[4]*=a,b[7]*=a,b[2]*=a,b[5]*=a,b[8]*=a,this}determinant(){let a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8];return b*f*j-b*g*i-c*e*j+c*g*h+d*e*i-d*f*h}invert(){let a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=j*f-g*i,l=g*h-j*e,m=i*e-f*h,n=b*k+c*l+d*m;if(0===n)return this.set(0,0,0,0,0,0,0,0,0);let o=1/n;return a[0]=k*o,a[1]=(d*i-j*c)*o,a[2]=(g*c-d*f)*o,a[3]=l*o,a[4]=(j*b-d*h)*o,a[5]=(d*e-g*b)*o,a[6]=m*o,a[7]=(c*h-i*b)*o,a[8]=(f*b-c*e)*o,this}transpose(){let a,b=this.elements;return a=b[1],b[1]=b[3],b[3]=a,a=b[2],b[2]=b[6],b[6]=a,a=b[5],b[5]=b[7],b[7]=a,this}getNormalMatrix(a){return this.setFromMatrix4(a).invert().transpose()}transposeIntoArray(a){let b=this.elements;return a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8],this}setUvTransform(a,b,c,d,e,f,g){let h=Math.cos(e),i=Math.sin(e);return this.set(c*h,c*i,-c*(h*f+i*g)+f+a,-d*i,d*h,-d*(-i*f+h*g)+g+b,0,0,1),this}scale(a,b){return this.premultiply(J.makeScale(a,b)),this}rotate(a){return this.premultiply(J.makeRotation(-a)),this}translate(a,b){return this.premultiply(J.makeTranslation(a,b)),this}makeTranslation(a,b){return a.isVector2?this.set(1,0,a.x,0,1,a.y,0,0,1):this.set(1,0,a,0,1,b,0,0,1),this}makeRotation(a){let b=Math.cos(a),c=Math.sin(a);return this.set(b,-c,0,c,b,0,0,0,1),this}makeScale(a,b){return this.set(a,0,0,0,b,0,0,0,1),this}equals(a){let b=this.elements,c=a.elements;for(let a=0;a<9;a++)if(b[a]!==c[a])return!1;return!0}fromArray(a,b=0){for(let c=0;c<9;c++)this.elements[c]=a[c+b];return this}toArray(a=[],b=0){let c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a}clone(){return new this.constructor().fromArray(this.elements)}}let J=new I;function K(a){return document.createElementNS("http://www.w3.org/1999/xhtml",a)}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;let L={};function M(a){a in L||(L[a]=!0,console.warn(a))}let N=new I().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),O=new I().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715),P=function(){let a={enabled:!0,workingColorSpace:u,spaces:{},convert:function(a,b,c){return!1!==this.enabled&&b!==c&&b&&c&&(this.spaces[b].transfer===w&&(a.r=Q(a.r),a.g=Q(a.g),a.b=Q(a.b)),this.spaces[b].primaries!==this.spaces[c].primaries&&(a.applyMatrix3(this.spaces[b].toXYZ),a.applyMatrix3(this.spaces[c].fromXYZ)),this.spaces[c].transfer===w&&(a.r=R(a.r),a.g=R(a.g),a.b=R(a.b))),a},workingToColorSpace:function(a,b){return this.convert(a,this.workingColorSpace,b)},colorSpaceToWorking:function(a,b){return this.convert(a,b,this.workingColorSpace)},getPrimaries:function(a){return this.spaces[a].primaries},getTransfer:function(a){return""===a?v:this.spaces[a].transfer},getToneMappingMode:function(a){return this.spaces[a].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(a,b=this.workingColorSpace){return a.fromArray(this.spaces[b].luminanceCoefficients)},define:function(a){Object.assign(this.spaces,a)},_getMatrix:function(a,b,c){return a.copy(this.spaces[b].toXYZ).multiply(this.spaces[c].fromXYZ)},_getDrawingBufferColorSpace:function(a){return this.spaces[a].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(a=this.workingColorSpace){return this.spaces[a].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(b,c){return M("THREE.ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),a.workingToColorSpace(b,c)},toWorkingColorSpace:function(b,c){return M("THREE.ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),a.colorSpaceToWorking(b,c)}},b=[.64,.33,.3,.6,.15,.06],c=[.2126,.7152,.0722],d=[.3127,.329];return a.define({[u]:{primaries:b,whitePoint:d,transfer:v,toXYZ:N,fromXYZ:O,luminanceCoefficients:c,workingColorSpaceConfig:{unpackColorSpace:t},outputColorSpaceConfig:{drawingBufferColorSpace:t}},[t]:{primaries:b,whitePoint:d,transfer:w,toXYZ:N,fromXYZ:O,luminanceCoefficients:c,outputColorSpaceConfig:{drawingBufferColorSpace:t}}}),a}();function Q(a){return a<.04045?.0773993808*a:Math.pow(.9478672986*a+.0521327014,2.4)}function R(a){return a<.0031308?12.92*a:1.055*Math.pow(a,.41666)-.055}class S{static getDataURL(a,b="image/png"){let c;if(/^data:/i.test(a.src)||"undefined"==typeof HTMLCanvasElement)return a.src;if(a instanceof HTMLCanvasElement)c=a;else{void 0===d&&(d=K("canvas")),d.width=a.width,d.height=a.height;let b=d.getContext("2d");a instanceof ImageData?b.putImageData(a,0,0):b.drawImage(a,0,0,a.width,a.height),c=d}return c.toDataURL(b)}static sRGBToLinear(a){if("undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap){let b=K("canvas");b.width=a.width,b.height=a.height;let c=b.getContext("2d");c.drawImage(a,0,0,a.width,a.height);let d=c.getImageData(0,0,a.width,a.height),e=d.data;for(let a=0;a<e.length;a++)e[a]=255*Q(e[a]/255);return c.putImageData(d,0,0),b}if(!a.data)return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),a;{let b=a.data.slice(0);for(let a=0;a<b.length;a++)b instanceof Uint8Array||b instanceof Uint8ClampedArray?b[a]=Math.floor(255*Q(b[a]/255)):b[a]=Q(b[a]);return{data:b,width:a.width,height:a.height}}}}let T=0;class U{constructor(a=null){this.isSource=!0,Object.defineProperty(this,"id",{value:T++}),this.uuid=z(),this.data=a,this.dataReady=!0,this.version=0}getSize(a){let b=this.data;return"undefined"!=typeof HTMLVideoElement&&b instanceof HTMLVideoElement?a.set(b.videoWidth,b.videoHeight,0):b instanceof VideoFrame?a.set(b.displayHeight,b.displayWidth,0):null!==b?a.set(b.width,b.height,b.depth||0):a.set(0,0,0),a}set needsUpdate(a){!0===a&&this.version++}toJSON(a){let b=void 0===a||"string"==typeof a;if(!b&&void 0!==a.images[this.uuid])return a.images[this.uuid];let c={uuid:this.uuid,url:""},d=this.data;if(null!==d){let a;if(Array.isArray(d)){a=[];for(let b=0,c=d.length;b<c;b++)d[b].isDataTexture?a.push(V(d[b].image)):a.push(V(d[b]))}else a=V(d);c.url=a}return b||(a.images[this.uuid]=c),c}}function V(a){return"undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&a instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&a instanceof ImageBitmap?S.getDataURL(a):a.data?{data:Array.from(a.data),width:a.width,height:a.height,type:a.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let W=0,X=new F;class Y extends x{constructor(a=Y.DEFAULT_IMAGE,b=Y.DEFAULT_MAPPING,c=1001,d=1001,e=1006,f=1008,g=1023,h=1009,i=Y.DEFAULT_ANISOTROPY,j=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:W++}),this.uuid=z(),this.name="",this.source=new U(a),this.mipmaps=[],this.mapping=b,this.channel=0,this.wrapS=c,this.wrapT=d,this.magFilter=e,this.minFilter=f,this.anisotropy=i,this.format=g,this.internalFormat=null,this.type=h,this.offset=new D(0,0),this.repeat=new D(1,1),this.center=new D(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new I,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=j,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!a&&!!a.depth&&a.depth>1,this.pmremVersion=0}get width(){return this.source.getSize(X).x}get height(){return this.source.getSize(X).y}get depth(){return this.source.getSize(X).z}get image(){return this.source.data}set image(a=null){this.source.data=a}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(a,b){this.updateRanges.push({start:a,count:b})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(a){return this.name=a.name,this.source=a.source,this.mipmaps=a.mipmaps.slice(0),this.mapping=a.mapping,this.channel=a.channel,this.wrapS=a.wrapS,this.wrapT=a.wrapT,this.magFilter=a.magFilter,this.minFilter=a.minFilter,this.anisotropy=a.anisotropy,this.format=a.format,this.internalFormat=a.internalFormat,this.type=a.type,this.offset.copy(a.offset),this.repeat.copy(a.repeat),this.center.copy(a.center),this.rotation=a.rotation,this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrix.copy(a.matrix),this.generateMipmaps=a.generateMipmaps,this.premultiplyAlpha=a.premultiplyAlpha,this.flipY=a.flipY,this.unpackAlignment=a.unpackAlignment,this.colorSpace=a.colorSpace,this.renderTarget=a.renderTarget,this.isRenderTargetTexture=a.isRenderTargetTexture,this.isArrayTexture=a.isArrayTexture,this.userData=JSON.parse(JSON.stringify(a.userData)),this.needsUpdate=!0,this}setValues(a){for(let b in a){let c=a[b];if(void 0===c){console.warn(`THREE.Texture.setValues(): parameter '${b}' has value of undefined.`);continue}let d=this[b];if(void 0===d){console.warn(`THREE.Texture.setValues(): property '${b}' does not exist.`);continue}d&&c&&d.isVector2&&c.isVector2||d&&c&&d.isVector3&&c.isVector3||d&&c&&d.isMatrix3&&c.isMatrix3?d.copy(c):this[b]=c}}toJSON(a){let b=void 0===a||"string"==typeof a;if(!b&&void 0!==a.textures[this.uuid])return a.textures[this.uuid];let c={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(a).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(c.userData=this.userData),b||(a.textures[this.uuid]=c),c}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(a){if(300!==this.mapping)return a;if(a.applyMatrix3(this.matrix),a.x<0||a.x>1)switch(this.wrapS){case 1e3:a.x=a.x-Math.floor(a.x);break;case 1001:a.x=a.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(a.x)%2)?a.x=Math.ceil(a.x)-a.x:a.x=a.x-Math.floor(a.x)}if(a.y<0||a.y>1)switch(this.wrapT){case 1e3:a.y=a.y-Math.floor(a.y);break;case 1001:a.y=a.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(a.y)%2)?a.y=Math.ceil(a.y)-a.y:a.y=a.y-Math.floor(a.y)}return this.flipY&&(a.y=1-a.y),a}set needsUpdate(a){!0===a&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(a){!0===a&&this.pmremVersion++}}Y.DEFAULT_IMAGE=null,Y.DEFAULT_MAPPING=300,Y.DEFAULT_ANISOTROPY=1;class Z{constructor(a=0,b=0,c=0,d=1){Z.prototype.isVector4=!0,this.x=a,this.y=b,this.z=c,this.w=d}get width(){return this.z}set width(a){this.z=a}get height(){return this.w}set height(a){this.w=a}set(a,b,c,d){return this.x=a,this.y=b,this.z=c,this.w=d,this}setScalar(a){return this.x=a,this.y=a,this.z=a,this.w=a,this}setX(a){return this.x=a,this}setY(a){return this.y=a,this}setZ(a){return this.z=a,this}setW(a){return this.w=a,this}setComponent(a,b){switch(a){case 0:this.x=b;break;case 1:this.y=b;break;case 2:this.z=b;break;case 3:this.w=b;break;default:throw Error("index is out of range: "+a)}return this}getComponent(a){switch(a){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+a)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(a){return this.x=a.x,this.y=a.y,this.z=a.z,this.w=void 0!==a.w?a.w:1,this}add(a){return this.x+=a.x,this.y+=a.y,this.z+=a.z,this.w+=a.w,this}addScalar(a){return this.x+=a,this.y+=a,this.z+=a,this.w+=a,this}addVectors(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this.w=a.w+b.w,this}addScaledVector(a,b){return this.x+=a.x*b,this.y+=a.y*b,this.z+=a.z*b,this.w+=a.w*b,this}sub(a){return this.x-=a.x,this.y-=a.y,this.z-=a.z,this.w-=a.w,this}subScalar(a){return this.x-=a,this.y-=a,this.z-=a,this.w-=a,this}subVectors(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this.w=a.w-b.w,this}multiply(a){return this.x*=a.x,this.y*=a.y,this.z*=a.z,this.w*=a.w,this}multiplyScalar(a){return this.x*=a,this.y*=a,this.z*=a,this.w*=a,this}applyMatrix4(a){let b=this.x,c=this.y,d=this.z,e=this.w,f=a.elements;return this.x=f[0]*b+f[4]*c+f[8]*d+f[12]*e,this.y=f[1]*b+f[5]*c+f[9]*d+f[13]*e,this.z=f[2]*b+f[6]*c+f[10]*d+f[14]*e,this.w=f[3]*b+f[7]*c+f[11]*d+f[15]*e,this}divide(a){return this.x/=a.x,this.y/=a.y,this.z/=a.z,this.w/=a.w,this}divideScalar(a){return this.multiplyScalar(1/a)}setAxisAngleFromQuaternion(a){this.w=2*Math.acos(a.w);let b=Math.sqrt(1-a.w*a.w);return b<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=a.x/b,this.y=a.y/b,this.z=a.z/b),this}setAxisAngleFromRotationMatrix(a){let b,c,d,e,f=a.elements,g=f[0],h=f[4],i=f[8],j=f[1],k=f[5],l=f[9],m=f[2],n=f[6],o=f[10];if(.01>Math.abs(h-j)&&.01>Math.abs(i-m)&&.01>Math.abs(l-n)){if(.1>Math.abs(h+j)&&.1>Math.abs(i+m)&&.1>Math.abs(l+n)&&.1>Math.abs(g+k+o-3))return this.set(1,0,0,0),this;b=Math.PI;let a=(g+1)/2,f=(k+1)/2,p=(o+1)/2,q=(h+j)/4,r=(i+m)/4,s=(l+n)/4;return a>f&&a>p?a<.01?(c=0,d=.707106781,e=.707106781):(d=q/(c=Math.sqrt(a)),e=r/c):f>p?f<.01?(c=.707106781,d=0,e=.707106781):(c=q/(d=Math.sqrt(f)),e=s/d):p<.01?(c=.707106781,d=.707106781,e=0):(c=r/(e=Math.sqrt(p)),d=s/e),this.set(c,d,e,b),this}let p=Math.sqrt((n-l)*(n-l)+(i-m)*(i-m)+(j-h)*(j-h));return .001>Math.abs(p)&&(p=1),this.x=(n-l)/p,this.y=(i-m)/p,this.z=(j-h)/p,this.w=Math.acos((g+k+o-1)/2),this}setFromMatrixPosition(a){let b=a.elements;return this.x=b[12],this.y=b[13],this.z=b[14],this.w=b[15],this}min(a){return this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y),this.z=Math.min(this.z,a.z),this.w=Math.min(this.w,a.w),this}max(a){return this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y),this.z=Math.max(this.z,a.z),this.w=Math.max(this.w,a.w),this}clamp(a,b){return this.x=A(this.x,a.x,b.x),this.y=A(this.y,a.y,b.y),this.z=A(this.z,a.z,b.z),this.w=A(this.w,a.w,b.w),this}clampScalar(a,b){return this.x=A(this.x,a,b),this.y=A(this.y,a,b),this.z=A(this.z,a,b),this.w=A(this.w,a,b),this}clampLength(a,b){let c=this.length();return this.divideScalar(c||1).multiplyScalar(A(c,a,b))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.w*a.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(a){return this.normalize().multiplyScalar(a)}lerp(a,b){return this.x+=(a.x-this.x)*b,this.y+=(a.y-this.y)*b,this.z+=(a.z-this.z)*b,this.w+=(a.w-this.w)*b,this}lerpVectors(a,b,c){return this.x=a.x+(b.x-a.x)*c,this.y=a.y+(b.y-a.y)*c,this.z=a.z+(b.z-a.z)*c,this.w=a.w+(b.w-a.w)*c,this}equals(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.w===this.w}fromArray(a,b=0){return this.x=a[b],this.y=a[b+1],this.z=a[b+2],this.w=a[b+3],this}toArray(a=[],b=0){return a[b]=this.x,a[b+1]=this.y,a[b+2]=this.z,a[b+3]=this.w,a}fromBufferAttribute(a,b){return this.x=a.getX(b),this.y=a.getY(b),this.z=a.getZ(b),this.w=a.getW(b),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class ${constructor(a=new F(Infinity,Infinity,Infinity),b=new F(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=a,this.max=b}set(a,b){return this.min.copy(a),this.max.copy(b),this}setFromArray(a){this.makeEmpty();for(let b=0,c=a.length;b<c;b+=3)this.expandByPoint(aa.fromArray(a,b));return this}setFromBufferAttribute(a){this.makeEmpty();for(let b=0,c=a.count;b<c;b++)this.expandByPoint(aa.fromBufferAttribute(a,b));return this}setFromPoints(a){this.makeEmpty();for(let b=0,c=a.length;b<c;b++)this.expandByPoint(a[b]);return this}setFromCenterAndSize(a,b){let c=aa.copy(b).multiplyScalar(.5);return this.min.copy(a).sub(c),this.max.copy(a).add(c),this}setFromObject(a,b=!1){return this.makeEmpty(),this.expandByObject(a,b)}clone(){return new this.constructor().copy(this)}copy(a){return this.min.copy(a.min),this.max.copy(a.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=Infinity,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(a){return this.isEmpty()?a.set(0,0,0):a.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(a){return this.isEmpty()?a.set(0,0,0):a.subVectors(this.max,this.min)}expandByPoint(a){return this.min.min(a),this.max.max(a),this}expandByVector(a){return this.min.sub(a),this.max.add(a),this}expandByScalar(a){return this.min.addScalar(-a),this.max.addScalar(a),this}expandByObject(a,b=!1){a.updateWorldMatrix(!1,!1);let c=a.geometry;if(void 0!==c){let d=c.getAttribute("position");if(!0===b&&void 0!==d&&!0!==a.isInstancedMesh)for(let b=0,c=d.count;b<c;b++)!0===a.isMesh?a.getVertexPosition(b,aa):aa.fromBufferAttribute(d,b),aa.applyMatrix4(a.matrixWorld),this.expandByPoint(aa);else void 0!==a.boundingBox?(null===a.boundingBox&&a.computeBoundingBox(),ab.copy(a.boundingBox)):(null===c.boundingBox&&c.computeBoundingBox(),ab.copy(c.boundingBox)),ab.applyMatrix4(a.matrixWorld),this.union(ab)}let d=a.children;for(let a=0,c=d.length;a<c;a++)this.expandByObject(d[a],b);return this}containsPoint(a){return a.x>=this.min.x&&a.x<=this.max.x&&a.y>=this.min.y&&a.y<=this.max.y&&a.z>=this.min.z&&a.z<=this.max.z}containsBox(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y&&this.min.z<=a.min.z&&a.max.z<=this.max.z}getParameter(a,b){return b.set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(a){return a.max.x>=this.min.x&&a.min.x<=this.max.x&&a.max.y>=this.min.y&&a.min.y<=this.max.y&&a.max.z>=this.min.z&&a.min.z<=this.max.z}intersectsSphere(a){return this.clampPoint(a.center,aa),aa.distanceToSquared(a.center)<=a.radius*a.radius}intersectsPlane(a){let b,c;return a.normal.x>0?(b=a.normal.x*this.min.x,c=a.normal.x*this.max.x):(b=a.normal.x*this.max.x,c=a.normal.x*this.min.x),a.normal.y>0?(b+=a.normal.y*this.min.y,c+=a.normal.y*this.max.y):(b+=a.normal.y*this.max.y,c+=a.normal.y*this.min.y),a.normal.z>0?(b+=a.normal.z*this.min.z,c+=a.normal.z*this.max.z):(b+=a.normal.z*this.max.z,c+=a.normal.z*this.min.z),b<=-a.constant&&c>=-a.constant}intersectsTriangle(a){if(this.isEmpty())return!1;this.getCenter(ai),aj.subVectors(this.max,ai),ac.subVectors(a.a,ai),ad.subVectors(a.b,ai),ae.subVectors(a.c,ai),af.subVectors(ad,ac),ag.subVectors(ae,ad),ah.subVectors(ac,ae);let b=[0,-af.z,af.y,0,-ag.z,ag.y,0,-ah.z,ah.y,af.z,0,-af.x,ag.z,0,-ag.x,ah.z,0,-ah.x,-af.y,af.x,0,-ag.y,ag.x,0,-ah.y,ah.x,0];return!!am(b,ac,ad,ae,aj)&&!!am(b=[1,0,0,0,1,0,0,0,1],ac,ad,ae,aj)&&(ak.crossVectors(af,ag),am(b=[ak.x,ak.y,ak.z],ac,ad,ae,aj))}clampPoint(a,b){return b.copy(a).clamp(this.min,this.max)}distanceToPoint(a){return this.clampPoint(a,aa).distanceTo(a)}getBoundingSphere(a){return this.isEmpty()?a.makeEmpty():(this.getCenter(a.center),a.radius=.5*this.getSize(aa).length()),a}intersect(a){return this.min.max(a.min),this.max.min(a.max),this.isEmpty()&&this.makeEmpty(),this}union(a){return this.min.min(a.min),this.max.max(a.max),this}applyMatrix4(a){return this.isEmpty()||(_[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(a),_[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(a),_[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(a),_[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(a),_[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(a),_[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(a),_[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(a),_[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(a),this.setFromPoints(_)),this}translate(a){return this.min.add(a),this.max.add(a),this}equals(a){return a.min.equals(this.min)&&a.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(a){return this.min.fromArray(a.min),this.max.fromArray(a.max),this}}let _=[new F,new F,new F,new F,new F,new F,new F,new F],aa=new F,ab=new $,ac=new F,ad=new F,ae=new F,af=new F,ag=new F,ah=new F,ai=new F,aj=new F,ak=new F,al=new F;function am(a,b,c,d,e){for(let f=0,g=a.length-3;f<=g;f+=3){al.fromArray(a,f);let g=e.x*Math.abs(al.x)+e.y*Math.abs(al.y)+e.z*Math.abs(al.z),h=b.dot(al),i=c.dot(al),j=d.dot(al);if(Math.max(-Math.max(h,i,j),Math.min(h,i,j))>g)return!1}return!0}let an=new $,ao=new F,ap=new F;class aq{constructor(a=new F,b=-1){this.isSphere=!0,this.center=a,this.radius=b}set(a,b){return this.center.copy(a),this.radius=b,this}setFromPoints(a,b){let c=this.center;void 0!==b?c.copy(b):an.setFromPoints(a).getCenter(c);let d=0;for(let b=0,e=a.length;b<e;b++)d=Math.max(d,c.distanceToSquared(a[b]));return this.radius=Math.sqrt(d),this}copy(a){return this.center.copy(a.center),this.radius=a.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(a){return a.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(a){return a.distanceTo(this.center)-this.radius}intersectsSphere(a){let b=this.radius+a.radius;return a.center.distanceToSquared(this.center)<=b*b}intersectsBox(a){return a.intersectsSphere(this)}intersectsPlane(a){return Math.abs(a.distanceToPoint(this.center))<=this.radius}clampPoint(a,b){let c=this.center.distanceToSquared(a);return b.copy(a),c>this.radius*this.radius&&(b.sub(this.center).normalize(),b.multiplyScalar(this.radius).add(this.center)),b}getBoundingBox(a){return this.isEmpty()?a.makeEmpty():(a.set(this.center,this.center),a.expandByScalar(this.radius)),a}applyMatrix4(a){return this.center.applyMatrix4(a),this.radius=this.radius*a.getMaxScaleOnAxis(),this}translate(a){return this.center.add(a),this}expandByPoint(a){if(this.isEmpty())return this.center.copy(a),this.radius=0,this;ao.subVectors(a,this.center);let b=ao.lengthSq();if(b>this.radius*this.radius){let a=Math.sqrt(b),c=(a-this.radius)*.5;this.center.addScaledVector(ao,c/a),this.radius+=c}return this}union(a){return a.isEmpty()||(this.isEmpty()?this.copy(a):!0===this.center.equals(a.center)?this.radius=Math.max(this.radius,a.radius):(ap.subVectors(a.center,this.center).setLength(a.radius),this.expandByPoint(ao.copy(a.center).add(ap)),this.expandByPoint(ao.copy(a.center).sub(ap)))),this}equals(a){return a.center.equals(this.center)&&a.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(a){return this.radius=a.radius,this.center.fromArray(a.center),this}}let ar=new F,as=new F,at=new F,au=new F,av=new F,aw=new F,ax=new F;class ay{constructor(a=new F,b=new F(0,0,-1)){this.origin=a,this.direction=b}set(a,b){return this.origin.copy(a),this.direction.copy(b),this}copy(a){return this.origin.copy(a.origin),this.direction.copy(a.direction),this}at(a,b){return b.copy(this.origin).addScaledVector(this.direction,a)}lookAt(a){return this.direction.copy(a).sub(this.origin).normalize(),this}recast(a){return this.origin.copy(this.at(a,ar)),this}closestPointToPoint(a,b){b.subVectors(a,this.origin);let c=b.dot(this.direction);return c<0?b.copy(this.origin):b.copy(this.origin).addScaledVector(this.direction,c)}distanceToPoint(a){return Math.sqrt(this.distanceSqToPoint(a))}distanceSqToPoint(a){let b=ar.subVectors(a,this.origin).dot(this.direction);return b<0?this.origin.distanceToSquared(a):(ar.copy(this.origin).addScaledVector(this.direction,b),ar.distanceToSquared(a))}distanceSqToSegment(a,b,c,d){let e,f,g,h;as.copy(a).add(b).multiplyScalar(.5),at.copy(b).sub(a).normalize(),au.copy(this.origin).sub(as);let i=.5*a.distanceTo(b),j=-this.direction.dot(at),k=au.dot(this.direction),l=-au.dot(at),m=au.lengthSq(),n=Math.abs(1-j*j);if(n>0)if(e=j*l-k,f=j*k-l,h=i*n,e>=0)if(f>=-h)if(f<=h){let a=1/n;e*=a,f*=a,g=e*(e+j*f+2*k)+f*(j*e+f+2*l)+m}else g=-(e=Math.max(0,-(j*(f=i)+k)))*e+f*(f+2*l)+m;else g=-(e=Math.max(0,-(j*(f=-i)+k)))*e+f*(f+2*l)+m;else f<=-h?(f=(e=Math.max(0,-(-j*i+k)))>0?-i:Math.min(Math.max(-i,-l),i),g=-e*e+f*(f+2*l)+m):f<=h?(e=0,g=(f=Math.min(Math.max(-i,-l),i))*(f+2*l)+m):(f=(e=Math.max(0,-(j*i+k)))>0?i:Math.min(Math.max(-i,-l),i),g=-e*e+f*(f+2*l)+m);else f=j>0?-i:i,g=-(e=Math.max(0,-(j*f+k)))*e+f*(f+2*l)+m;return c&&c.copy(this.origin).addScaledVector(this.direction,e),d&&d.copy(as).addScaledVector(at,f),g}intersectSphere(a,b){ar.subVectors(a.center,this.origin);let c=ar.dot(this.direction),d=ar.dot(ar)-c*c,e=a.radius*a.radius;if(d>e)return null;let f=Math.sqrt(e-d),g=c-f,h=c+f;return h<0?null:g<0?this.at(h,b):this.at(g,b)}intersectsSphere(a){return!(a.radius<0)&&this.distanceSqToPoint(a.center)<=a.radius*a.radius}distanceToPlane(a){let b=a.normal.dot(this.direction);if(0===b)return 0===a.distanceToPoint(this.origin)?0:null;let c=-(this.origin.dot(a.normal)+a.constant)/b;return c>=0?c:null}intersectPlane(a,b){let c=this.distanceToPlane(a);return null===c?null:this.at(c,b)}intersectsPlane(a){let b=a.distanceToPoint(this.origin);return!!(0===b||a.normal.dot(this.direction)*b<0)}intersectBox(a,b){let c,d,e,f,g,h,i=1/this.direction.x,j=1/this.direction.y,k=1/this.direction.z,l=this.origin;return(i>=0?(c=(a.min.x-l.x)*i,d=(a.max.x-l.x)*i):(c=(a.max.x-l.x)*i,d=(a.min.x-l.x)*i),j>=0?(e=(a.min.y-l.y)*j,f=(a.max.y-l.y)*j):(e=(a.max.y-l.y)*j,f=(a.min.y-l.y)*j),c>f||e>d||((e>c||isNaN(c))&&(c=e),(f<d||isNaN(d))&&(d=f),k>=0?(g=(a.min.z-l.z)*k,h=(a.max.z-l.z)*k):(g=(a.max.z-l.z)*k,h=(a.min.z-l.z)*k),c>h||g>d||((g>c||c!=c)&&(c=g),(h<d||d!=d)&&(d=h),d<0)))?null:this.at(c>=0?c:d,b)}intersectsBox(a){return null!==this.intersectBox(a,ar)}intersectTriangle(a,b,c,d,e){let f;av.subVectors(b,a),aw.subVectors(c,a),ax.crossVectors(av,aw);let g=this.direction.dot(ax);if(g>0){if(d)return null;f=1}else{if(!(g<0))return null;f=-1,g=-g}au.subVectors(this.origin,a);let h=f*this.direction.dot(aw.crossVectors(au,aw));if(h<0)return null;let i=f*this.direction.dot(av.cross(au));if(i<0||h+i>g)return null;let j=-f*au.dot(ax);return j<0?null:this.at(j/g,e)}applyMatrix4(a){return this.origin.applyMatrix4(a),this.direction.transformDirection(a),this}equals(a){return a.origin.equals(this.origin)&&a.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class az{constructor(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){az.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==a&&this.set(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p)}set(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){let q=this.elements;return q[0]=a,q[4]=b,q[8]=c,q[12]=d,q[1]=e,q[5]=f,q[9]=g,q[13]=h,q[2]=i,q[6]=j,q[10]=k,q[14]=l,q[3]=m,q[7]=n,q[11]=o,q[15]=p,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new az().fromArray(this.elements)}copy(a){let b=this.elements,c=a.elements;return b[0]=c[0],b[1]=c[1],b[2]=c[2],b[3]=c[3],b[4]=c[4],b[5]=c[5],b[6]=c[6],b[7]=c[7],b[8]=c[8],b[9]=c[9],b[10]=c[10],b[11]=c[11],b[12]=c[12],b[13]=c[13],b[14]=c[14],b[15]=c[15],this}copyPosition(a){let b=this.elements,c=a.elements;return b[12]=c[12],b[13]=c[13],b[14]=c[14],this}setFromMatrix3(a){let b=a.elements;return this.set(b[0],b[3],b[6],0,b[1],b[4],b[7],0,b[2],b[5],b[8],0,0,0,0,1),this}extractBasis(a,b,c){return a.setFromMatrixColumn(this,0),b.setFromMatrixColumn(this,1),c.setFromMatrixColumn(this,2),this}makeBasis(a,b,c){return this.set(a.x,b.x,c.x,0,a.y,b.y,c.y,0,a.z,b.z,c.z,0,0,0,0,1),this}extractRotation(a){let b=this.elements,c=a.elements,d=1/aA.setFromMatrixColumn(a,0).length(),e=1/aA.setFromMatrixColumn(a,1).length(),f=1/aA.setFromMatrixColumn(a,2).length();return b[0]=c[0]*d,b[1]=c[1]*d,b[2]=c[2]*d,b[3]=0,b[4]=c[4]*e,b[5]=c[5]*e,b[6]=c[6]*e,b[7]=0,b[8]=c[8]*f,b[9]=c[9]*f,b[10]=c[10]*f,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this}makeRotationFromEuler(a){let b=this.elements,c=a.x,d=a.y,e=a.z,f=Math.cos(c),g=Math.sin(c),h=Math.cos(d),i=Math.sin(d),j=Math.cos(e),k=Math.sin(e);if("XYZ"===a.order){let a=f*j,c=f*k,d=g*j,e=g*k;b[0]=h*j,b[4]=-h*k,b[8]=i,b[1]=c+d*i,b[5]=a-e*i,b[9]=-g*h,b[2]=e-a*i,b[6]=d+c*i,b[10]=f*h}else if("YXZ"===a.order){let a=h*j,c=h*k,d=i*j,e=i*k;b[0]=a+e*g,b[4]=d*g-c,b[8]=f*i,b[1]=f*k,b[5]=f*j,b[9]=-g,b[2]=c*g-d,b[6]=e+a*g,b[10]=f*h}else if("ZXY"===a.order){let a=h*j,c=h*k,d=i*j,e=i*k;b[0]=a-e*g,b[4]=-f*k,b[8]=d+c*g,b[1]=c+d*g,b[5]=f*j,b[9]=e-a*g,b[2]=-f*i,b[6]=g,b[10]=f*h}else if("ZYX"===a.order){let a=f*j,c=f*k,d=g*j,e=g*k;b[0]=h*j,b[4]=d*i-c,b[8]=a*i+e,b[1]=h*k,b[5]=e*i+a,b[9]=c*i-d,b[2]=-i,b[6]=g*h,b[10]=f*h}else if("YZX"===a.order){let a=f*h,c=f*i,d=g*h,e=g*i;b[0]=h*j,b[4]=e-a*k,b[8]=d*k+c,b[1]=k,b[5]=f*j,b[9]=-g*j,b[2]=-i*j,b[6]=c*k+d,b[10]=a-e*k}else if("XZY"===a.order){let a=f*h,c=f*i,d=g*h,e=g*i;b[0]=h*j,b[4]=-k,b[8]=i*j,b[1]=a*k+e,b[5]=f*j,b[9]=c*k-d,b[2]=d*k-c,b[6]=g*j,b[10]=e*k+a}return b[3]=0,b[7]=0,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,this}makeRotationFromQuaternion(a){return this.compose(aC,a,aD)}lookAt(a,b,c){let d=this.elements;return aG.subVectors(a,b),0===aG.lengthSq()&&(aG.z=1),aG.normalize(),aE.crossVectors(c,aG),0===aE.lengthSq()&&(1===Math.abs(c.z)?aG.x+=1e-4:aG.z+=1e-4,aG.normalize(),aE.crossVectors(c,aG)),aE.normalize(),aF.crossVectors(aG,aE),d[0]=aE.x,d[4]=aF.x,d[8]=aG.x,d[1]=aE.y,d[5]=aF.y,d[9]=aG.y,d[2]=aE.z,d[6]=aF.z,d[10]=aG.z,this}multiply(a){return this.multiplyMatrices(this,a)}premultiply(a){return this.multiplyMatrices(a,this)}multiplyMatrices(a,b){let c=a.elements,d=b.elements,e=this.elements,f=c[0],g=c[4],h=c[8],i=c[12],j=c[1],k=c[5],l=c[9],m=c[13],n=c[2],o=c[6],p=c[10],q=c[14],r=c[3],s=c[7],t=c[11],u=c[15],v=d[0],w=d[4],x=d[8],y=d[12],z=d[1],A=d[5],B=d[9],C=d[13],D=d[2],E=d[6],F=d[10],G=d[14],H=d[3],I=d[7],J=d[11],K=d[15];return e[0]=f*v+g*z+h*D+i*H,e[4]=f*w+g*A+h*E+i*I,e[8]=f*x+g*B+h*F+i*J,e[12]=f*y+g*C+h*G+i*K,e[1]=j*v+k*z+l*D+m*H,e[5]=j*w+k*A+l*E+m*I,e[9]=j*x+k*B+l*F+m*J,e[13]=j*y+k*C+l*G+m*K,e[2]=n*v+o*z+p*D+q*H,e[6]=n*w+o*A+p*E+q*I,e[10]=n*x+o*B+p*F+q*J,e[14]=n*y+o*C+p*G+q*K,e[3]=r*v+s*z+t*D+u*H,e[7]=r*w+s*A+t*E+u*I,e[11]=r*x+s*B+t*F+u*J,e[15]=r*y+s*C+t*G+u*K,this}multiplyScalar(a){let b=this.elements;return b[0]*=a,b[4]*=a,b[8]*=a,b[12]*=a,b[1]*=a,b[5]*=a,b[9]*=a,b[13]*=a,b[2]*=a,b[6]*=a,b[10]*=a,b[14]*=a,b[3]*=a,b[7]*=a,b[11]*=a,b[15]*=a,this}determinant(){let a=this.elements,b=a[0],c=a[4],d=a[8],e=a[12],f=a[1],g=a[5],h=a[9],i=a[13],j=a[2],k=a[6],l=a[10],m=a[14],n=a[3],o=a[7];return n*(e*h*k-d*i*k-e*g*l+c*i*l+d*g*m-c*h*m)+o*(b*h*m-b*i*l+e*f*l-d*f*m+d*i*j-e*h*j)+a[11]*(b*i*k-b*g*m-e*f*k+c*f*m+e*g*j-c*i*j)+a[15]*(-d*g*j-b*h*k+b*g*l+d*f*k-c*f*l+c*h*j)}transpose(){let a,b=this.elements;return a=b[1],b[1]=b[4],b[4]=a,a=b[2],b[2]=b[8],b[8]=a,a=b[6],b[6]=b[9],b[9]=a,a=b[3],b[3]=b[12],b[12]=a,a=b[7],b[7]=b[13],b[13]=a,a=b[11],b[11]=b[14],b[14]=a,this}setPosition(a,b,c){let d=this.elements;return a.isVector3?(d[12]=a.x,d[13]=a.y,d[14]=a.z):(d[12]=a,d[13]=b,d[14]=c),this}invert(){let a=this.elements,b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15],r=k*p*i-o*l*i+o*h*m-g*p*m-k*h*q+g*l*q,s=n*l*i-j*p*i-n*h*m+f*p*m+j*h*q-f*l*q,t=j*o*i-n*k*i+n*g*m-f*o*m-j*g*q+f*k*q,u=n*k*h-j*o*h-n*g*l+f*o*l+j*g*p-f*k*p,v=b*r+c*s+d*t+e*u;if(0===v)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let w=1/v;return a[0]=r*w,a[1]=(o*l*e-k*p*e-o*d*m+c*p*m+k*d*q-c*l*q)*w,a[2]=(g*p*e-o*h*e+o*d*i-c*p*i-g*d*q+c*h*q)*w,a[3]=(k*h*e-g*l*e-k*d*i+c*l*i+g*d*m-c*h*m)*w,a[4]=s*w,a[5]=(j*p*e-n*l*e+n*d*m-b*p*m-j*d*q+b*l*q)*w,a[6]=(n*h*e-f*p*e-n*d*i+b*p*i+f*d*q-b*h*q)*w,a[7]=(f*l*e-j*h*e+j*d*i-b*l*i-f*d*m+b*h*m)*w,a[8]=t*w,a[9]=(n*k*e-j*o*e-n*c*m+b*o*m+j*c*q-b*k*q)*w,a[10]=(f*o*e-n*g*e+n*c*i-b*o*i-f*c*q+b*g*q)*w,a[11]=(j*g*e-f*k*e-j*c*i+b*k*i+f*c*m-b*g*m)*w,a[12]=u*w,a[13]=(j*o*d-n*k*d+n*c*l-b*o*l-j*c*p+b*k*p)*w,a[14]=(n*g*d-f*o*d-n*c*h+b*o*h+f*c*p-b*g*p)*w,a[15]=(f*k*d-j*g*d+j*c*h-b*k*h-f*c*l+b*g*l)*w,this}scale(a){let b=this.elements,c=a.x,d=a.y,e=a.z;return b[0]*=c,b[4]*=d,b[8]*=e,b[1]*=c,b[5]*=d,b[9]*=e,b[2]*=c,b[6]*=d,b[10]*=e,b[3]*=c,b[7]*=d,b[11]*=e,this}getMaxScaleOnAxis(){let a=this.elements,b=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];return Math.sqrt(Math.max(b,a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10]))}makeTranslation(a,b,c){return a.isVector3?this.set(1,0,0,a.x,0,1,0,a.y,0,0,1,a.z,0,0,0,1):this.set(1,0,0,a,0,1,0,b,0,0,1,c,0,0,0,1),this}makeRotationX(a){let b=Math.cos(a),c=Math.sin(a);return this.set(1,0,0,0,0,b,-c,0,0,c,b,0,0,0,0,1),this}makeRotationY(a){let b=Math.cos(a),c=Math.sin(a);return this.set(b,0,c,0,0,1,0,0,-c,0,b,0,0,0,0,1),this}makeRotationZ(a){let b=Math.cos(a),c=Math.sin(a);return this.set(b,-c,0,0,c,b,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(a,b){let c=Math.cos(b),d=Math.sin(b),e=1-c,f=a.x,g=a.y,h=a.z,i=e*f,j=e*g;return this.set(i*f+c,i*g-d*h,i*h+d*g,0,i*g+d*h,j*g+c,j*h-d*f,0,i*h-d*g,j*h+d*f,e*h*h+c,0,0,0,0,1),this}makeScale(a,b,c){return this.set(a,0,0,0,0,b,0,0,0,0,c,0,0,0,0,1),this}makeShear(a,b,c,d,e,f){return this.set(1,c,e,0,a,1,f,0,b,d,1,0,0,0,0,1),this}compose(a,b,c){let d=this.elements,e=b._x,f=b._y,g=b._z,h=b._w,i=e+e,j=f+f,k=g+g,l=e*i,m=e*j,n=e*k,o=f*j,p=f*k,q=g*k,r=h*i,s=h*j,t=h*k,u=c.x,v=c.y,w=c.z;return d[0]=(1-(o+q))*u,d[1]=(m+t)*u,d[2]=(n-s)*u,d[3]=0,d[4]=(m-t)*v,d[5]=(1-(l+q))*v,d[6]=(p+r)*v,d[7]=0,d[8]=(n+s)*w,d[9]=(p-r)*w,d[10]=(1-(l+o))*w,d[11]=0,d[12]=a.x,d[13]=a.y,d[14]=a.z,d[15]=1,this}decompose(a,b,c){let d=this.elements,e=aA.set(d[0],d[1],d[2]).length(),f=aA.set(d[4],d[5],d[6]).length(),g=aA.set(d[8],d[9],d[10]).length();0>this.determinant()&&(e=-e),a.x=d[12],a.y=d[13],a.z=d[14],aB.copy(this);let h=1/e,i=1/f,j=1/g;return aB.elements[0]*=h,aB.elements[1]*=h,aB.elements[2]*=h,aB.elements[4]*=i,aB.elements[5]*=i,aB.elements[6]*=i,aB.elements[8]*=j,aB.elements[9]*=j,aB.elements[10]*=j,b.setFromRotationMatrix(aB),c.x=e,c.y=f,c.z=g,this}makePerspective(a,b,c,d,e,f,g=2e3,h=!1){let i,j,k=this.elements;if(h)i=e/(f-e),j=f*e/(f-e);else if(2e3===g)i=-(f+e)/(f-e),j=-2*f*e/(f-e);else if(2001===g)i=-f/(f-e),j=-f*e/(f-e);else throw Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+g);return k[0]=2*e/(b-a),k[4]=0,k[8]=(b+a)/(b-a),k[12]=0,k[1]=0,k[5]=2*e/(c-d),k[9]=(c+d)/(c-d),k[13]=0,k[2]=0,k[6]=0,k[10]=i,k[14]=j,k[3]=0,k[7]=0,k[11]=-1,k[15]=0,this}makeOrthographic(a,b,c,d,e,f,g=2e3,h=!1){let i,j,k=this.elements;if(h)i=1/(f-e),j=f/(f-e);else if(2e3===g)i=-2/(f-e),j=-(f+e)/(f-e);else if(2001===g)i=-1/(f-e),j=-e/(f-e);else throw Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+g);return k[0]=2/(b-a),k[4]=0,k[8]=0,k[12]=-(b+a)/(b-a),k[1]=0,k[5]=2/(c-d),k[9]=0,k[13]=-(c+d)/(c-d),k[2]=0,k[6]=0,k[10]=i,k[14]=j,k[3]=0,k[7]=0,k[11]=0,k[15]=1,this}equals(a){let b=this.elements,c=a.elements;for(let a=0;a<16;a++)if(b[a]!==c[a])return!1;return!0}fromArray(a,b=0){for(let c=0;c<16;c++)this.elements[c]=a[c+b];return this}toArray(a=[],b=0){let c=this.elements;return a[b]=c[0],a[b+1]=c[1],a[b+2]=c[2],a[b+3]=c[3],a[b+4]=c[4],a[b+5]=c[5],a[b+6]=c[6],a[b+7]=c[7],a[b+8]=c[8],a[b+9]=c[9],a[b+10]=c[10],a[b+11]=c[11],a[b+12]=c[12],a[b+13]=c[13],a[b+14]=c[14],a[b+15]=c[15],a}}let aA=new F,aB=new az,aC=new F(0,0,0),aD=new F(1,1,1),aE=new F,aF=new F,aG=new F,aH=new az,aI=new E;class aJ{constructor(a=0,b=0,c=0,d=aJ.DEFAULT_ORDER){this.isEuler=!0,this._x=a,this._y=b,this._z=c,this._order=d}get x(){return this._x}set x(a){this._x=a,this._onChangeCallback()}get y(){return this._y}set y(a){this._y=a,this._onChangeCallback()}get z(){return this._z}set z(a){this._z=a,this._onChangeCallback()}get order(){return this._order}set order(a){this._order=a,this._onChangeCallback()}set(a,b,c,d=this._order){return this._x=a,this._y=b,this._z=c,this._order=d,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(a){return this._x=a._x,this._y=a._y,this._z=a._z,this._order=a._order,this._onChangeCallback(),this}setFromRotationMatrix(a,b=this._order,c=!0){let d=a.elements,e=d[0],f=d[4],g=d[8],h=d[1],i=d[5],j=d[9],k=d[2],l=d[6],m=d[10];switch(b){case"XYZ":this._y=Math.asin(A(g,-1,1)),.9999999>Math.abs(g)?(this._x=Math.atan2(-j,m),this._z=Math.atan2(-f,e)):(this._x=Math.atan2(l,i),this._z=0);break;case"YXZ":this._x=Math.asin(-A(j,-1,1)),.9999999>Math.abs(j)?(this._y=Math.atan2(g,m),this._z=Math.atan2(h,i)):(this._y=Math.atan2(-k,e),this._z=0);break;case"ZXY":this._x=Math.asin(A(l,-1,1)),.9999999>Math.abs(l)?(this._y=Math.atan2(-k,m),this._z=Math.atan2(-f,i)):(this._y=0,this._z=Math.atan2(h,e));break;case"ZYX":this._y=Math.asin(-A(k,-1,1)),.9999999>Math.abs(k)?(this._x=Math.atan2(l,m),this._z=Math.atan2(h,e)):(this._x=0,this._z=Math.atan2(-f,i));break;case"YZX":this._z=Math.asin(A(h,-1,1)),.9999999>Math.abs(h)?(this._x=Math.atan2(-j,i),this._y=Math.atan2(-k,e)):(this._x=0,this._y=Math.atan2(g,m));break;case"XZY":this._z=Math.asin(-A(f,-1,1)),.9999999>Math.abs(f)?(this._x=Math.atan2(l,i),this._y=Math.atan2(g,e)):(this._x=Math.atan2(-j,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+b)}return this._order=b,!0===c&&this._onChangeCallback(),this}setFromQuaternion(a,b,c){return aH.makeRotationFromQuaternion(a),this.setFromRotationMatrix(aH,b,c)}setFromVector3(a,b=this._order){return this.set(a.x,a.y,a.z,b)}reorder(a){return aI.setFromEuler(this),this.setFromQuaternion(aI,a)}equals(a){return a._x===this._x&&a._y===this._y&&a._z===this._z&&a._order===this._order}fromArray(a){return this._x=a[0],this._y=a[1],this._z=a[2],void 0!==a[3]&&(this._order=a[3]),this._onChangeCallback(),this}toArray(a=[],b=0){return a[b]=this._x,a[b+1]=this._y,a[b+2]=this._z,a[b+3]=this._order,a}_onChange(a){return this._onChangeCallback=a,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}aJ.DEFAULT_ORDER="XYZ";class aK{constructor(){this.mask=1}set(a){this.mask=1<<a>>>0}enable(a){this.mask|=1<<a}enableAll(){this.mask=-1}toggle(a){this.mask^=1<<a}disable(a){this.mask&=~(1<<a)}disableAll(){this.mask=0}test(a){return(this.mask&a.mask)!=0}isEnabled(a){return(this.mask&1<<a)!=0}}let aL=0,aM=new F,aN=new E,aO=new az,aP=new F,aQ=new F,aR=new F,aS=new E,aT=new F(1,0,0),aU=new F(0,1,0),aV=new F(0,0,1),aW={type:"added"},aX={type:"removed"},aY={type:"childadded",child:null},aZ={type:"childremoved",child:null};class a$ extends x{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:aL++}),this.uuid=z(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=a$.DEFAULT_UP.clone();let a=new F,b=new aJ,c=new E,d=new F(1,1,1);b._onChange(function(){c.setFromEuler(b,!1)}),c._onChange(function(){b.setFromQuaternion(c,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:a},rotation:{configurable:!0,enumerable:!0,value:b},quaternion:{configurable:!0,enumerable:!0,value:c},scale:{configurable:!0,enumerable:!0,value:d},modelViewMatrix:{value:new az},normalMatrix:{value:new I}}),this.matrix=new az,this.matrixWorld=new az,this.matrixAutoUpdate=a$.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=a$.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new aK,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(a){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(a),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(a){return this.quaternion.premultiply(a),this}setRotationFromAxisAngle(a,b){this.quaternion.setFromAxisAngle(a,b)}setRotationFromEuler(a){this.quaternion.setFromEuler(a,!0)}setRotationFromMatrix(a){this.quaternion.setFromRotationMatrix(a)}setRotationFromQuaternion(a){this.quaternion.copy(a)}rotateOnAxis(a,b){return aN.setFromAxisAngle(a,b),this.quaternion.multiply(aN),this}rotateOnWorldAxis(a,b){return aN.setFromAxisAngle(a,b),this.quaternion.premultiply(aN),this}rotateX(a){return this.rotateOnAxis(aT,a)}rotateY(a){return this.rotateOnAxis(aU,a)}rotateZ(a){return this.rotateOnAxis(aV,a)}translateOnAxis(a,b){return aM.copy(a).applyQuaternion(this.quaternion),this.position.add(aM.multiplyScalar(b)),this}translateX(a){return this.translateOnAxis(aT,a)}translateY(a){return this.translateOnAxis(aU,a)}translateZ(a){return this.translateOnAxis(aV,a)}localToWorld(a){return this.updateWorldMatrix(!0,!1),a.applyMatrix4(this.matrixWorld)}worldToLocal(a){return this.updateWorldMatrix(!0,!1),a.applyMatrix4(aO.copy(this.matrixWorld).invert())}lookAt(a,b,c){a.isVector3?aP.copy(a):aP.set(a,b,c);let d=this.parent;this.updateWorldMatrix(!0,!1),aQ.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?aO.lookAt(aQ,aP,this.up):aO.lookAt(aP,aQ,this.up),this.quaternion.setFromRotationMatrix(aO),d&&(aO.extractRotation(d.matrixWorld),aN.setFromRotationMatrix(aO),this.quaternion.premultiply(aN.invert()))}add(a){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.add(arguments[a]);return this}return a===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",a):a&&a.isObject3D?(a.removeFromParent(),a.parent=this,this.children.push(a),a.dispatchEvent(aW),aY.child=a,this.dispatchEvent(aY),aY.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",a),this}remove(a){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.remove(arguments[a]);return this}let b=this.children.indexOf(a);return -1!==b&&(a.parent=null,this.children.splice(b,1),a.dispatchEvent(aX),aZ.child=a,this.dispatchEvent(aZ),aZ.child=null),this}removeFromParent(){let a=this.parent;return null!==a&&a.remove(this),this}clear(){return this.remove(...this.children)}attach(a){return this.updateWorldMatrix(!0,!1),aO.copy(this.matrixWorld).invert(),null!==a.parent&&(a.parent.updateWorldMatrix(!0,!1),aO.multiply(a.parent.matrixWorld)),a.applyMatrix4(aO),a.removeFromParent(),a.parent=this,this.children.push(a),a.updateWorldMatrix(!1,!0),a.dispatchEvent(aW),aY.child=a,this.dispatchEvent(aY),aY.child=null,this}getObjectById(a){return this.getObjectByProperty("id",a)}getObjectByName(a){return this.getObjectByProperty("name",a)}getObjectByProperty(a,b){if(this[a]===b)return this;for(let c=0,d=this.children.length;c<d;c++){let d=this.children[c].getObjectByProperty(a,b);if(void 0!==d)return d}}getObjectsByProperty(a,b,c=[]){this[a]===b&&c.push(this);let d=this.children;for(let e=0,f=d.length;e<f;e++)d[e].getObjectsByProperty(a,b,c);return c}getWorldPosition(a){return this.updateWorldMatrix(!0,!1),a.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(a){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(aQ,a,aR),a}getWorldScale(a){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(aQ,aS,a),a}getWorldDirection(a){this.updateWorldMatrix(!0,!1);let b=this.matrixWorld.elements;return a.set(b[8],b[9],b[10]).normalize()}raycast(){}traverse(a){a(this);let b=this.children;for(let c=0,d=b.length;c<d;c++)b[c].traverse(a)}traverseVisible(a){if(!1===this.visible)return;a(this);let b=this.children;for(let c=0,d=b.length;c<d;c++)b[c].traverseVisible(a)}traverseAncestors(a){let b=this.parent;null!==b&&(a(b),b.traverseAncestors(a))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(a){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||a)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,a=!0);let b=this.children;for(let c=0,d=b.length;c<d;c++)b[c].updateMatrixWorld(a)}updateWorldMatrix(a,b){let c=this.parent;if(!0===a&&null!==c&&c.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===b){let a=this.children;for(let b=0,c=a.length;b<c;b++)a[b].updateWorldMatrix(!1,!0)}}toJSON(a){let b=void 0===a||"string"==typeof a,c={};b&&(a={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},c.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});let d={};function e(b,c){return void 0===b[c.uuid]&&(b[c.uuid]=c.toJSON(a)),c.uuid}if(d.uuid=this.uuid,d.type=this.type,""!==this.name&&(d.name=this.name),!0===this.castShadow&&(d.castShadow=!0),!0===this.receiveShadow&&(d.receiveShadow=!0),!1===this.visible&&(d.visible=!1),!1===this.frustumCulled&&(d.frustumCulled=!1),0!==this.renderOrder&&(d.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(d.userData=this.userData),d.layers=this.layers.mask,d.matrix=this.matrix.toArray(),d.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(d.matrixAutoUpdate=!1),this.isInstancedMesh&&(d.type="InstancedMesh",d.count=this.count,d.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(d.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(d.type="BatchedMesh",d.perObjectFrustumCulled=this.perObjectFrustumCulled,d.sortObjects=this.sortObjects,d.drawRanges=this._drawRanges,d.reservedRanges=this._reservedRanges,d.geometryInfo=this._geometryInfo.map(a=>({...a,boundingBox:a.boundingBox?a.boundingBox.toJSON():void 0,boundingSphere:a.boundingSphere?a.boundingSphere.toJSON():void 0})),d.instanceInfo=this._instanceInfo.map(a=>({...a})),d.availableInstanceIds=this._availableInstanceIds.slice(),d.availableGeometryIds=this._availableGeometryIds.slice(),d.nextIndexStart=this._nextIndexStart,d.nextVertexStart=this._nextVertexStart,d.geometryCount=this._geometryCount,d.maxInstanceCount=this._maxInstanceCount,d.maxVertexCount=this._maxVertexCount,d.maxIndexCount=this._maxIndexCount,d.geometryInitialized=this._geometryInitialized,d.matricesTexture=this._matricesTexture.toJSON(a),d.indirectTexture=this._indirectTexture.toJSON(a),null!==this._colorsTexture&&(d.colorsTexture=this._colorsTexture.toJSON(a)),null!==this.boundingSphere&&(d.boundingSphere=this.boundingSphere.toJSON()),null!==this.boundingBox&&(d.boundingBox=this.boundingBox.toJSON())),this.isScene)this.background&&(this.background.isColor?d.background=this.background.toJSON():this.background.isTexture&&(d.background=this.background.toJSON(a).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(d.environment=this.environment.toJSON(a).uuid);else if(this.isMesh||this.isLine||this.isPoints){d.geometry=e(a.geometries,this.geometry);let b=this.geometry.parameters;if(void 0!==b&&void 0!==b.shapes){let c=b.shapes;if(Array.isArray(c))for(let b=0,d=c.length;b<d;b++){let d=c[b];e(a.shapes,d)}else e(a.shapes,c)}}if(this.isSkinnedMesh&&(d.bindMode=this.bindMode,d.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(e(a.skeletons,this.skeleton),d.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){let b=[];for(let c=0,d=this.material.length;c<d;c++)b.push(e(a.materials,this.material[c]));d.material=b}else d.material=e(a.materials,this.material);if(this.children.length>0){d.children=[];for(let b=0;b<this.children.length;b++)d.children.push(this.children[b].toJSON(a).object)}if(this.animations.length>0){d.animations=[];for(let b=0;b<this.animations.length;b++){let c=this.animations[b];d.animations.push(e(a.animations,c))}}if(b){let b=f(a.geometries),d=f(a.materials),e=f(a.textures),g=f(a.images),h=f(a.shapes),i=f(a.skeletons),j=f(a.animations),k=f(a.nodes);b.length>0&&(c.geometries=b),d.length>0&&(c.materials=d),e.length>0&&(c.textures=e),g.length>0&&(c.images=g),h.length>0&&(c.shapes=h),i.length>0&&(c.skeletons=i),j.length>0&&(c.animations=j),k.length>0&&(c.nodes=k)}return c.object=d,c;function f(a){let b=[];for(let c in a){let d=a[c];delete d.metadata,b.push(d)}return b}}clone(a){return new this.constructor().copy(this,a)}copy(a,b=!0){if(this.name=a.name,this.up.copy(a.up),this.position.copy(a.position),this.rotation.order=a.rotation.order,this.quaternion.copy(a.quaternion),this.scale.copy(a.scale),this.matrix.copy(a.matrix),this.matrixWorld.copy(a.matrixWorld),this.matrixAutoUpdate=a.matrixAutoUpdate,this.matrixWorldAutoUpdate=a.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=a.matrixWorldNeedsUpdate,this.layers.mask=a.layers.mask,this.visible=a.visible,this.castShadow=a.castShadow,this.receiveShadow=a.receiveShadow,this.frustumCulled=a.frustumCulled,this.renderOrder=a.renderOrder,this.animations=a.animations.slice(),this.userData=JSON.parse(JSON.stringify(a.userData)),!0===b)for(let b=0;b<a.children.length;b++){let c=a.children[b];this.add(c.clone())}return this}}a$.DEFAULT_UP=new F(0,1,0),a$.DEFAULT_MATRIX_AUTO_UPDATE=!0,a$.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;let a_=new F,a0=new F,a1=new F,a2=new F,a3=new F,a4=new F,a5=new F,a6=new F,a7=new F,a8=new F,a9=new Z,ba=new Z,bb=new Z;class bc{constructor(a=new F,b=new F,c=new F){this.a=a,this.b=b,this.c=c}static getNormal(a,b,c,d){d.subVectors(c,b),a_.subVectors(a,b),d.cross(a_);let e=d.lengthSq();return e>0?d.multiplyScalar(1/Math.sqrt(e)):d.set(0,0,0)}static getBarycoord(a,b,c,d,e){a_.subVectors(d,b),a0.subVectors(c,b),a1.subVectors(a,b);let f=a_.dot(a_),g=a_.dot(a0),h=a_.dot(a1),i=a0.dot(a0),j=a0.dot(a1),k=f*i-g*g;if(0===k)return e.set(0,0,0),null;let l=1/k,m=(i*h-g*j)*l,n=(f*j-g*h)*l;return e.set(1-m-n,n,m)}static containsPoint(a,b,c,d){return null!==this.getBarycoord(a,b,c,d,a2)&&a2.x>=0&&a2.y>=0&&a2.x+a2.y<=1}static getInterpolation(a,b,c,d,e,f,g,h){return null===this.getBarycoord(a,b,c,d,a2)?(h.x=0,h.y=0,"z"in h&&(h.z=0),"w"in h&&(h.w=0),null):(h.setScalar(0),h.addScaledVector(e,a2.x),h.addScaledVector(f,a2.y),h.addScaledVector(g,a2.z),h)}static getInterpolatedAttribute(a,b,c,d,e,f){return a9.setScalar(0),ba.setScalar(0),bb.setScalar(0),a9.fromBufferAttribute(a,b),ba.fromBufferAttribute(a,c),bb.fromBufferAttribute(a,d),f.setScalar(0),f.addScaledVector(a9,e.x),f.addScaledVector(ba,e.y),f.addScaledVector(bb,e.z),f}static isFrontFacing(a,b,c,d){return a_.subVectors(c,b),a0.subVectors(a,b),0>a_.cross(a0).dot(d)}set(a,b,c){return this.a.copy(a),this.b.copy(b),this.c.copy(c),this}setFromPointsAndIndices(a,b,c,d){return this.a.copy(a[b]),this.b.copy(a[c]),this.c.copy(a[d]),this}setFromAttributeAndIndices(a,b,c,d){return this.a.fromBufferAttribute(a,b),this.b.fromBufferAttribute(a,c),this.c.fromBufferAttribute(a,d),this}clone(){return new this.constructor().copy(this)}copy(a){return this.a.copy(a.a),this.b.copy(a.b),this.c.copy(a.c),this}getArea(){return a_.subVectors(this.c,this.b),a0.subVectors(this.a,this.b),.5*a_.cross(a0).length()}getMidpoint(a){return a.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(a){return bc.getNormal(this.a,this.b,this.c,a)}getPlane(a){return a.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(a,b){return bc.getBarycoord(a,this.a,this.b,this.c,b)}getInterpolation(a,b,c,d,e){return bc.getInterpolation(a,this.a,this.b,this.c,b,c,d,e)}containsPoint(a){return bc.containsPoint(a,this.a,this.b,this.c)}isFrontFacing(a){return bc.isFrontFacing(this.a,this.b,this.c,a)}intersectsBox(a){return a.intersectsTriangle(this)}closestPointToPoint(a,b){let c,d,e=this.a,f=this.b,g=this.c;a3.subVectors(f,e),a4.subVectors(g,e),a6.subVectors(a,e);let h=a3.dot(a6),i=a4.dot(a6);if(h<=0&&i<=0)return b.copy(e);a7.subVectors(a,f);let j=a3.dot(a7),k=a4.dot(a7);if(j>=0&&k<=j)return b.copy(f);let l=h*k-j*i;if(l<=0&&h>=0&&j<=0)return c=h/(h-j),b.copy(e).addScaledVector(a3,c);a8.subVectors(a,g);let m=a3.dot(a8),n=a4.dot(a8);if(n>=0&&m<=n)return b.copy(g);let o=m*i-h*n;if(o<=0&&i>=0&&n<=0)return d=i/(i-n),b.copy(e).addScaledVector(a4,d);let p=j*n-m*k;if(p<=0&&k-j>=0&&m-n>=0)return a5.subVectors(g,f),d=(k-j)/(k-j+(m-n)),b.copy(f).addScaledVector(a5,d);let q=1/(p+o+l);return c=o*q,d=l*q,b.copy(e).addScaledVector(a3,c).addScaledVector(a4,d)}equals(a){return a.a.equals(this.a)&&a.b.equals(this.b)&&a.c.equals(this.c)}}let bd={aliceblue:0xf0f8ff,antiquewhite:0xfaebd7,aqua:65535,aquamarine:8388564,azure:0xf0ffff,beige:0xf5f5dc,bisque:0xffe4c4,black:0,blanchedalmond:0xffebcd,blue:255,blueviolet:9055202,brown:0xa52a2a,burlywood:0xdeb887,cadetblue:6266528,chartreuse:8388352,chocolate:0xd2691e,coral:0xff7f50,cornflowerblue:6591981,cornsilk:0xfff8dc,crimson:0xdc143c,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:0xb8860b,darkgray:0xa9a9a9,darkgreen:25600,darkgrey:0xa9a9a9,darkkhaki:0xbdb76b,darkmagenta:9109643,darkolivegreen:5597999,darkorange:0xff8c00,darkorchid:0x9932cc,darkred:9109504,darksalmon:0xe9967a,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:0xff1493,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:0xb22222,floralwhite:0xfffaf0,forestgreen:2263842,fuchsia:0xff00ff,gainsboro:0xdcdcdc,ghostwhite:0xf8f8ff,gold:0xffd700,goldenrod:0xdaa520,gray:8421504,green:32768,greenyellow:0xadff2f,grey:8421504,honeydew:0xf0fff0,hotpink:0xff69b4,indianred:0xcd5c5c,indigo:4915330,ivory:0xfffff0,khaki:0xf0e68c,lavender:0xe6e6fa,lavenderblush:0xfff0f5,lawngreen:8190976,lemonchiffon:0xfffacd,lightblue:0xadd8e6,lightcoral:0xf08080,lightcyan:0xe0ffff,lightgoldenrodyellow:0xfafad2,lightgray:0xd3d3d3,lightgreen:9498256,lightgrey:0xd3d3d3,lightpink:0xffb6c1,lightsalmon:0xffa07a,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:0xb0c4de,lightyellow:0xffffe0,lime:65280,limegreen:3329330,linen:0xfaf0e6,magenta:0xff00ff,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:0xba55d3,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:0xc71585,midnightblue:1644912,mintcream:0xf5fffa,mistyrose:0xffe4e1,moccasin:0xffe4b5,navajowhite:0xffdead,navy:128,oldlace:0xfdf5e6,olive:8421376,olivedrab:7048739,orange:0xffa500,orangered:0xff4500,orchid:0xda70d6,palegoldenrod:0xeee8aa,palegreen:0x98fb98,paleturquoise:0xafeeee,palevioletred:0xdb7093,papayawhip:0xffefd5,peachpuff:0xffdab9,peru:0xcd853f,pink:0xffc0cb,plum:0xdda0dd,powderblue:0xb0e0e6,purple:8388736,rebeccapurple:6697881,red:0xff0000,rosybrown:0xbc8f8f,royalblue:4286945,saddlebrown:9127187,salmon:0xfa8072,sandybrown:0xf4a460,seagreen:3050327,seashell:0xfff5ee,sienna:0xa0522d,silver:0xc0c0c0,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:0xfffafa,springgreen:65407,steelblue:4620980,tan:0xd2b48c,teal:32896,thistle:0xd8bfd8,tomato:0xff6347,turquoise:4251856,violet:0xee82ee,wheat:0xf5deb3,white:0xffffff,whitesmoke:0xf5f5f5,yellow:0xffff00,yellowgreen:0x9acd32},be={h:0,s:0,l:0},bf={h:0,s:0,l:0};function bg(a,b,c){return(c<0&&(c+=1),c>1&&(c-=1),c<1/6)?a+(b-a)*6*c:c<.5?b:c<2/3?a+(b-a)*6*(2/3-c):a}class bh{constructor(a,b,c){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(a,b,c)}set(a,b,c){return void 0===b&&void 0===c?a&&a.isColor?this.copy(a):"number"==typeof a?this.setHex(a):"string"==typeof a&&this.setStyle(a):this.setRGB(a,b,c),this}setScalar(a){return this.r=a,this.g=a,this.b=a,this}setHex(a,b=t){return a=Math.floor(a),this.r=(a>>16&255)/255,this.g=(a>>8&255)/255,this.b=(255&a)/255,P.colorSpaceToWorking(this,b),this}setRGB(a,b,c,d=P.workingColorSpace){return this.r=a,this.g=b,this.b=c,P.colorSpaceToWorking(this,d),this}setHSL(a,b,c,d=P.workingColorSpace){if(a=(a%1+1)%1,b=A(b,0,1),c=A(c,0,1),0===b)this.r=this.g=this.b=c;else{let d=c<=.5?c*(1+b):c+b-c*b,e=2*c-d;this.r=bg(e,d,a+1/3),this.g=bg(e,d,a),this.b=bg(e,d,a-1/3)}return P.colorSpaceToWorking(this,d),this}setStyle(a,b=t){let c;function d(b){void 0!==b&&1>parseFloat(b)&&console.warn("THREE.Color: Alpha component of "+a+" will be ignored.")}if(c=/^(\w+)\(([^\)]*)\)/.exec(a)){let e,f=c[1],g=c[2];switch(f){case"rgb":case"rgba":if(e=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(g))return d(e[4]),this.setRGB(Math.min(255,parseInt(e[1],10))/255,Math.min(255,parseInt(e[2],10))/255,Math.min(255,parseInt(e[3],10))/255,b);if(e=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(g))return d(e[4]),this.setRGB(Math.min(100,parseInt(e[1],10))/100,Math.min(100,parseInt(e[2],10))/100,Math.min(100,parseInt(e[3],10))/100,b);break;case"hsl":case"hsla":if(e=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(g))return d(e[4]),this.setHSL(parseFloat(e[1])/360,parseFloat(e[2])/100,parseFloat(e[3])/100,b);break;default:console.warn("THREE.Color: Unknown color model "+a)}}else if(c=/^\#([A-Fa-f\d]+)$/.exec(a)){let d=c[1],e=d.length;if(3===e)return this.setRGB(parseInt(d.charAt(0),16)/15,parseInt(d.charAt(1),16)/15,parseInt(d.charAt(2),16)/15,b);if(6===e)return this.setHex(parseInt(d,16),b);console.warn("THREE.Color: Invalid hex color "+a)}else if(a&&a.length>0)return this.setColorName(a,b);return this}setColorName(a,b=t){let c=bd[a.toLowerCase()];return void 0!==c?this.setHex(c,b):console.warn("THREE.Color: Unknown color "+a),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(a){return this.r=a.r,this.g=a.g,this.b=a.b,this}copySRGBToLinear(a){return this.r=Q(a.r),this.g=Q(a.g),this.b=Q(a.b),this}copyLinearToSRGB(a){return this.r=R(a.r),this.g=R(a.g),this.b=R(a.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(a=t){return P.workingToColorSpace(bi.copy(this),a),65536*Math.round(A(255*bi.r,0,255))+256*Math.round(A(255*bi.g,0,255))+Math.round(A(255*bi.b,0,255))}getHexString(a=t){return("000000"+this.getHex(a).toString(16)).slice(-6)}getHSL(a,b=P.workingColorSpace){let c,d;P.workingToColorSpace(bi.copy(this),b);let e=bi.r,f=bi.g,g=bi.b,h=Math.max(e,f,g),i=Math.min(e,f,g),j=(i+h)/2;if(i===h)c=0,d=0;else{let a=h-i;switch(d=j<=.5?a/(h+i):a/(2-h-i),h){case e:c=(f-g)/a+6*(f<g);break;case f:c=(g-e)/a+2;break;case g:c=(e-f)/a+4}c/=6}return a.h=c,a.s=d,a.l=j,a}getRGB(a,b=P.workingColorSpace){return P.workingToColorSpace(bi.copy(this),b),a.r=bi.r,a.g=bi.g,a.b=bi.b,a}getStyle(a=t){P.workingToColorSpace(bi.copy(this),a);let b=bi.r,c=bi.g,d=bi.b;return a!==t?`color(${a} ${b.toFixed(3)} ${c.toFixed(3)} ${d.toFixed(3)})`:`rgb(${Math.round(255*b)},${Math.round(255*c)},${Math.round(255*d)})`}offsetHSL(a,b,c){return this.getHSL(be),this.setHSL(be.h+a,be.s+b,be.l+c)}add(a){return this.r+=a.r,this.g+=a.g,this.b+=a.b,this}addColors(a,b){return this.r=a.r+b.r,this.g=a.g+b.g,this.b=a.b+b.b,this}addScalar(a){return this.r+=a,this.g+=a,this.b+=a,this}sub(a){return this.r=Math.max(0,this.r-a.r),this.g=Math.max(0,this.g-a.g),this.b=Math.max(0,this.b-a.b),this}multiply(a){return this.r*=a.r,this.g*=a.g,this.b*=a.b,this}multiplyScalar(a){return this.r*=a,this.g*=a,this.b*=a,this}lerp(a,b){return this.r+=(a.r-this.r)*b,this.g+=(a.g-this.g)*b,this.b+=(a.b-this.b)*b,this}lerpColors(a,b,c){return this.r=a.r+(b.r-a.r)*c,this.g=a.g+(b.g-a.g)*c,this.b=a.b+(b.b-a.b)*c,this}lerpHSL(a,b){var c,d,e;this.getHSL(be),a.getHSL(bf);let f=(c=be.h,(1-b)*c+b*bf.h),g=(d=be.s,(1-b)*d+b*bf.s),h=(e=be.l,(1-b)*e+b*bf.l);return this.setHSL(f,g,h),this}setFromVector3(a){return this.r=a.x,this.g=a.y,this.b=a.z,this}applyMatrix3(a){let b=this.r,c=this.g,d=this.b,e=a.elements;return this.r=e[0]*b+e[3]*c+e[6]*d,this.g=e[1]*b+e[4]*c+e[7]*d,this.b=e[2]*b+e[5]*c+e[8]*d,this}equals(a){return a.r===this.r&&a.g===this.g&&a.b===this.b}fromArray(a,b=0){return this.r=a[b],this.g=a[b+1],this.b=a[b+2],this}toArray(a=[],b=0){return a[b]=this.r,a[b+1]=this.g,a[b+2]=this.b,a}fromBufferAttribute(a,b){return this.r=a.getX(b),this.g=a.getY(b),this.b=a.getZ(b),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let bi=new bh;bh.NAMES=bd;let bj=new F,bk=new D,bl=0;class bm{constructor(a,b,c=!1){if(Array.isArray(a))throw TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:bl++}),this.name="",this.array=a,this.itemSize=b,this.count=void 0!==a?a.length/b:0,this.normalized=c,this.usage=35044,this.updateRanges=[],this.gpuType=1015,this.version=0}onUploadCallback(){}set needsUpdate(a){!0===a&&this.version++}setUsage(a){return this.usage=a,this}addUpdateRange(a,b){this.updateRanges.push({start:a,count:b})}clearUpdateRanges(){this.updateRanges.length=0}copy(a){return this.name=a.name,this.array=new a.array.constructor(a.array),this.itemSize=a.itemSize,this.count=a.count,this.normalized=a.normalized,this.usage=a.usage,this.gpuType=a.gpuType,this}copyAt(a,b,c){a*=this.itemSize,c*=b.itemSize;for(let d=0,e=this.itemSize;d<e;d++)this.array[a+d]=b.array[c+d];return this}copyArray(a){return this.array.set(a),this}applyMatrix3(a){if(2===this.itemSize)for(let b=0,c=this.count;b<c;b++)bk.fromBufferAttribute(this,b),bk.applyMatrix3(a),this.setXY(b,bk.x,bk.y);else if(3===this.itemSize)for(let b=0,c=this.count;b<c;b++)bj.fromBufferAttribute(this,b),bj.applyMatrix3(a),this.setXYZ(b,bj.x,bj.y,bj.z);return this}applyMatrix4(a){for(let b=0,c=this.count;b<c;b++)bj.fromBufferAttribute(this,b),bj.applyMatrix4(a),this.setXYZ(b,bj.x,bj.y,bj.z);return this}applyNormalMatrix(a){for(let b=0,c=this.count;b<c;b++)bj.fromBufferAttribute(this,b),bj.applyNormalMatrix(a),this.setXYZ(b,bj.x,bj.y,bj.z);return this}transformDirection(a){for(let b=0,c=this.count;b<c;b++)bj.fromBufferAttribute(this,b),bj.transformDirection(a),this.setXYZ(b,bj.x,bj.y,bj.z);return this}set(a,b=0){return this.array.set(a,b),this}getComponent(a,b){let c=this.array[a*this.itemSize+b];return this.normalized&&(c=B(c,this.array)),c}setComponent(a,b,c){return this.normalized&&(c=C(c,this.array)),this.array[a*this.itemSize+b]=c,this}getX(a){let b=this.array[a*this.itemSize];return this.normalized&&(b=B(b,this.array)),b}setX(a,b){return this.normalized&&(b=C(b,this.array)),this.array[a*this.itemSize]=b,this}getY(a){let b=this.array[a*this.itemSize+1];return this.normalized&&(b=B(b,this.array)),b}setY(a,b){return this.normalized&&(b=C(b,this.array)),this.array[a*this.itemSize+1]=b,this}getZ(a){let b=this.array[a*this.itemSize+2];return this.normalized&&(b=B(b,this.array)),b}setZ(a,b){return this.normalized&&(b=C(b,this.array)),this.array[a*this.itemSize+2]=b,this}getW(a){let b=this.array[a*this.itemSize+3];return this.normalized&&(b=B(b,this.array)),b}setW(a,b){return this.normalized&&(b=C(b,this.array)),this.array[a*this.itemSize+3]=b,this}setXY(a,b,c){return a*=this.itemSize,this.normalized&&(b=C(b,this.array),c=C(c,this.array)),this.array[a+0]=b,this.array[a+1]=c,this}setXYZ(a,b,c,d){return a*=this.itemSize,this.normalized&&(b=C(b,this.array),c=C(c,this.array),d=C(d,this.array)),this.array[a+0]=b,this.array[a+1]=c,this.array[a+2]=d,this}setXYZW(a,b,c,d,e){return a*=this.itemSize,this.normalized&&(b=C(b,this.array),c=C(c,this.array),d=C(d,this.array),e=C(e,this.array)),this.array[a+0]=b,this.array[a+1]=c,this.array[a+2]=d,this.array[a+3]=e,this}onUpload(a){return this.onUploadCallback=a,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let a={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(a.name=this.name),35044!==this.usage&&(a.usage=this.usage),a}}class bn extends bm{constructor(a,b,c){super(new Uint16Array(a),b,c)}}class bo extends bm{constructor(a,b,c){super(new Uint32Array(a),b,c)}}class bp extends bm{constructor(a,b,c){super(new Float32Array(a),b,c)}}let bq=0,br=new az,bs=new a$,bt=new F,bu=new $,bv=new $,bw=new F;class bx extends x{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:bq++}),this.uuid=z(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(a){return Array.isArray(a)?this.index=new(!function(a){for(let b=a.length-1;b>=0;--b)if(a[b]>=65535)return!0;return!1}(a)?bn:bo)(a,1):this.index=a,this}setIndirect(a){return this.indirect=a,this}getIndirect(){return this.indirect}getAttribute(a){return this.attributes[a]}setAttribute(a,b){return this.attributes[a]=b,this}deleteAttribute(a){return delete this.attributes[a],this}hasAttribute(a){return void 0!==this.attributes[a]}addGroup(a,b,c=0){this.groups.push({start:a,count:b,materialIndex:c})}clearGroups(){this.groups=[]}setDrawRange(a,b){this.drawRange.start=a,this.drawRange.count=b}applyMatrix4(a){let b=this.attributes.position;void 0!==b&&(b.applyMatrix4(a),b.needsUpdate=!0);let c=this.attributes.normal;if(void 0!==c){let b=new I().getNormalMatrix(a);c.applyNormalMatrix(b),c.needsUpdate=!0}let d=this.attributes.tangent;return void 0!==d&&(d.transformDirection(a),d.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(a){return br.makeRotationFromQuaternion(a),this.applyMatrix4(br),this}rotateX(a){return br.makeRotationX(a),this.applyMatrix4(br),this}rotateY(a){return br.makeRotationY(a),this.applyMatrix4(br),this}rotateZ(a){return br.makeRotationZ(a),this.applyMatrix4(br),this}translate(a,b,c){return br.makeTranslation(a,b,c),this.applyMatrix4(br),this}scale(a,b,c){return br.makeScale(a,b,c),this.applyMatrix4(br),this}lookAt(a){return bs.lookAt(a),bs.updateMatrix(),this.applyMatrix4(bs.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(bt).negate(),this.translate(bt.x,bt.y,bt.z),this}setFromPoints(a){let b=this.getAttribute("position");if(void 0===b){let b=[];for(let c=0,d=a.length;c<d;c++){let d=a[c];b.push(d.x,d.y,d.z||0)}this.setAttribute("position",new bp(b,3))}else{let c=Math.min(a.length,b.count);for(let d=0;d<c;d++){let c=a[d];b.setXYZ(d,c.x,c.y,c.z||0)}a.length>b.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),b.needsUpdate=!0}return this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new $);let a=this.attributes.position,b=this.morphAttributes.position;if(a&&a.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new F(-1/0,-1/0,-1/0),new F(Infinity,Infinity,Infinity));return}if(void 0!==a){if(this.boundingBox.setFromBufferAttribute(a),b)for(let a=0,c=b.length;a<c;a++){let c=b[a];bu.setFromBufferAttribute(c),this.morphTargetsRelative?(bw.addVectors(this.boundingBox.min,bu.min),this.boundingBox.expandByPoint(bw),bw.addVectors(this.boundingBox.max,bu.max),this.boundingBox.expandByPoint(bw)):(this.boundingBox.expandByPoint(bu.min),this.boundingBox.expandByPoint(bu.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new aq);let a=this.attributes.position,b=this.morphAttributes.position;if(a&&a.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new F,1/0);return}if(a){let c=this.boundingSphere.center;if(bu.setFromBufferAttribute(a),b)for(let a=0,c=b.length;a<c;a++){let c=b[a];bv.setFromBufferAttribute(c),this.morphTargetsRelative?(bw.addVectors(bu.min,bv.min),bu.expandByPoint(bw),bw.addVectors(bu.max,bv.max),bu.expandByPoint(bw)):(bu.expandByPoint(bv.min),bu.expandByPoint(bv.max))}bu.getCenter(c);let d=0;for(let b=0,e=a.count;b<e;b++)bw.fromBufferAttribute(a,b),d=Math.max(d,c.distanceToSquared(bw));if(b)for(let e=0,f=b.length;e<f;e++){let f=b[e],g=this.morphTargetsRelative;for(let b=0,e=f.count;b<e;b++)bw.fromBufferAttribute(f,b),g&&(bt.fromBufferAttribute(a,b),bw.add(bt)),d=Math.max(d,c.distanceToSquared(bw))}this.boundingSphere.radius=Math.sqrt(d),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let a=this.index,b=this.attributes;if(null===a||void 0===b.position||void 0===b.normal||void 0===b.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");let c=b.position,d=b.normal,e=b.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new bm(new Float32Array(4*c.count),4));let f=this.getAttribute("tangent"),g=[],h=[];for(let a=0;a<c.count;a++)g[a]=new F,h[a]=new F;let i=new F,j=new F,k=new F,l=new D,m=new D,n=new D,o=new F,p=new F,q=this.groups;0===q.length&&(q=[{start:0,count:a.count}]);for(let b=0,d=q.length;b<d;++b){let d=q[b],f=d.start,r=d.count;for(let b=f,d=f+r;b<d;b+=3)!function(a,b,d){i.fromBufferAttribute(c,a),j.fromBufferAttribute(c,b),k.fromBufferAttribute(c,d),l.fromBufferAttribute(e,a),m.fromBufferAttribute(e,b),n.fromBufferAttribute(e,d),j.sub(i),k.sub(i),m.sub(l),n.sub(l);let f=1/(m.x*n.y-n.x*m.y);isFinite(f)&&(o.copy(j).multiplyScalar(n.y).addScaledVector(k,-m.y).multiplyScalar(f),p.copy(k).multiplyScalar(m.x).addScaledVector(j,-n.x).multiplyScalar(f),g[a].add(o),g[b].add(o),g[d].add(o),h[a].add(p),h[b].add(p),h[d].add(p))}(a.getX(b+0),a.getX(b+1),a.getX(b+2))}let r=new F,s=new F,t=new F,u=new F;function v(a){t.fromBufferAttribute(d,a),u.copy(t);let b=g[a];r.copy(b),r.sub(t.multiplyScalar(t.dot(b))).normalize(),s.crossVectors(u,b);let c=s.dot(h[a]);f.setXYZW(a,r.x,r.y,r.z,c<0?-1:1)}for(let b=0,c=q.length;b<c;++b){let c=q[b],d=c.start,e=c.count;for(let b=d,c=d+e;b<c;b+=3)v(a.getX(b+0)),v(a.getX(b+1)),v(a.getX(b+2))}}computeVertexNormals(){let a=this.index,b=this.getAttribute("position");if(void 0!==b){let c=this.getAttribute("normal");if(void 0===c)c=new bm(new Float32Array(3*b.count),3),this.setAttribute("normal",c);else for(let a=0,b=c.count;a<b;a++)c.setXYZ(a,0,0,0);let d=new F,e=new F,f=new F,g=new F,h=new F,i=new F,j=new F,k=new F;if(a)for(let l=0,m=a.count;l<m;l+=3){let m=a.getX(l+0),n=a.getX(l+1),o=a.getX(l+2);d.fromBufferAttribute(b,m),e.fromBufferAttribute(b,n),f.fromBufferAttribute(b,o),j.subVectors(f,e),k.subVectors(d,e),j.cross(k),g.fromBufferAttribute(c,m),h.fromBufferAttribute(c,n),i.fromBufferAttribute(c,o),g.add(j),h.add(j),i.add(j),c.setXYZ(m,g.x,g.y,g.z),c.setXYZ(n,h.x,h.y,h.z),c.setXYZ(o,i.x,i.y,i.z)}else for(let a=0,g=b.count;a<g;a+=3)d.fromBufferAttribute(b,a+0),e.fromBufferAttribute(b,a+1),f.fromBufferAttribute(b,a+2),j.subVectors(f,e),k.subVectors(d,e),j.cross(k),c.setXYZ(a+0,j.x,j.y,j.z),c.setXYZ(a+1,j.x,j.y,j.z),c.setXYZ(a+2,j.x,j.y,j.z);this.normalizeNormals(),c.needsUpdate=!0}}normalizeNormals(){let a=this.attributes.normal;for(let b=0,c=a.count;b<c;b++)bw.fromBufferAttribute(a,b),bw.normalize(),a.setXYZ(b,bw.x,bw.y,bw.z)}toNonIndexed(){function a(a,b){let c=a.array,d=a.itemSize,e=a.normalized,f=new c.constructor(b.length*d),g=0,h=0;for(let e=0,i=b.length;e<i;e++){g=a.isInterleavedBufferAttribute?b[e]*a.data.stride+a.offset:b[e]*d;for(let a=0;a<d;a++)f[h++]=c[g++]}return new bm(f,d,e)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let b=new bx,c=this.index.array,d=this.attributes;for(let e in d){let f=a(d[e],c);b.setAttribute(e,f)}let e=this.morphAttributes;for(let d in e){let f=[],g=e[d];for(let b=0,d=g.length;b<d;b++){let d=a(g[b],c);f.push(d)}b.morphAttributes[d]=f}b.morphTargetsRelative=this.morphTargetsRelative;let f=this.groups;for(let a=0,c=f.length;a<c;a++){let c=f[a];b.addGroup(c.start,c.count,c.materialIndex)}return b}toJSON(){let a={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),Object.keys(this.userData).length>0&&(a.userData=this.userData),void 0!==this.parameters){let b=this.parameters;for(let c in b)void 0!==b[c]&&(a[c]=b[c]);return a}a.data={attributes:{}};let b=this.index;null!==b&&(a.data.index={type:b.array.constructor.name,array:Array.prototype.slice.call(b.array)});let c=this.attributes;for(let b in c){let d=c[b];a.data.attributes[b]=d.toJSON(a.data)}let d={},e=!1;for(let b in this.morphAttributes){let c=this.morphAttributes[b],f=[];for(let b=0,d=c.length;b<d;b++){let d=c[b];f.push(d.toJSON(a.data))}f.length>0&&(d[b]=f,e=!0)}e&&(a.data.morphAttributes=d,a.data.morphTargetsRelative=this.morphTargetsRelative);let f=this.groups;f.length>0&&(a.data.groups=JSON.parse(JSON.stringify(f)));let g=this.boundingSphere;return null!==g&&(a.data.boundingSphere=g.toJSON()),a}clone(){return new this.constructor().copy(this)}copy(a){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let b={};this.name=a.name;let c=a.index;null!==c&&this.setIndex(c.clone());let d=a.attributes;for(let a in d){let c=d[a];this.setAttribute(a,c.clone(b))}let e=a.morphAttributes;for(let a in e){let c=[],d=e[a];for(let a=0,e=d.length;a<e;a++)c.push(d[a].clone(b));this.morphAttributes[a]=c}this.morphTargetsRelative=a.morphTargetsRelative;let f=a.groups;for(let a=0,b=f.length;a<b;a++){let b=f[a];this.addGroup(b.start,b.count,b.materialIndex)}let g=a.boundingBox;null!==g&&(this.boundingBox=g.clone());let h=a.boundingSphere;return null!==h&&(this.boundingSphere=h.clone()),this.drawRange.start=a.drawRange.start,this.drawRange.count=a.drawRange.count,this.userData=a.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}let by=new F,bz=new F,bA=new I;class bB{constructor(a=new F(1,0,0),b=0){this.isPlane=!0,this.normal=a,this.constant=b}set(a,b){return this.normal.copy(a),this.constant=b,this}setComponents(a,b,c,d){return this.normal.set(a,b,c),this.constant=d,this}setFromNormalAndCoplanarPoint(a,b){return this.normal.copy(a),this.constant=-b.dot(this.normal),this}setFromCoplanarPoints(a,b,c){let d=by.subVectors(c,b).cross(bz.subVectors(a,b)).normalize();return this.setFromNormalAndCoplanarPoint(d,a),this}copy(a){return this.normal.copy(a.normal),this.constant=a.constant,this}normalize(){let a=1/this.normal.length();return this.normal.multiplyScalar(a),this.constant*=a,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(a){return this.normal.dot(a)+this.constant}distanceToSphere(a){return this.distanceToPoint(a.center)-a.radius}projectPoint(a,b){return b.copy(a).addScaledVector(this.normal,-this.distanceToPoint(a))}intersectLine(a,b){let c=a.delta(by),d=this.normal.dot(c);if(0===d)return 0===this.distanceToPoint(a.start)?b.copy(a.start):null;let e=-(a.start.dot(this.normal)+this.constant)/d;return e<0||e>1?null:b.copy(a.start).addScaledVector(c,e)}intersectsLine(a){let b=this.distanceToPoint(a.start),c=this.distanceToPoint(a.end);return b<0&&c>0||c<0&&b>0}intersectsBox(a){return a.intersectsPlane(this)}intersectsSphere(a){return a.intersectsPlane(this)}coplanarPoint(a){return a.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(a,b){let c=b||bA.getNormalMatrix(a),d=this.coplanarPoint(by).applyMatrix4(a),e=this.normal.applyMatrix3(c).normalize();return this.constant=-d.dot(e),this}translate(a){return this.constant-=a.dot(this.normal),this}equals(a){return a.normal.equals(this.normal)&&a.constant===this.constant}clone(){return new this.constructor().copy(this)}}let bC=new aq,bD=new D(.5,.5),bE=new F;class bF{constructor(a=new bB,b=new bB,c=new bB,d=new bB,e=new bB,f=new bB){this.planes=[a,b,c,d,e,f]}set(a,b,c,d,e,f){let g=this.planes;return g[0].copy(a),g[1].copy(b),g[2].copy(c),g[3].copy(d),g[4].copy(e),g[5].copy(f),this}copy(a){let b=this.planes;for(let c=0;c<6;c++)b[c].copy(a.planes[c]);return this}setFromProjectionMatrix(a,b=2e3,c=!1){let d=this.planes,e=a.elements,f=e[0],g=e[1],h=e[2],i=e[3],j=e[4],k=e[5],l=e[6],m=e[7],n=e[8],o=e[9],p=e[10],q=e[11],r=e[12],s=e[13],t=e[14],u=e[15];if(d[0].setComponents(i-f,m-j,q-n,u-r).normalize(),d[1].setComponents(i+f,m+j,q+n,u+r).normalize(),d[2].setComponents(i+g,m+k,q+o,u+s).normalize(),d[3].setComponents(i-g,m-k,q-o,u-s).normalize(),c)d[4].setComponents(h,l,p,t).normalize(),d[5].setComponents(i-h,m-l,q-p,u-t).normalize();else if(d[4].setComponents(i-h,m-l,q-p,u-t).normalize(),2e3===b)d[5].setComponents(i+h,m+l,q+p,u+t).normalize();else if(2001===b)d[5].setComponents(h,l,p,t).normalize();else throw Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+b);return this}intersectsObject(a){if(void 0!==a.boundingSphere)null===a.boundingSphere&&a.computeBoundingSphere(),bC.copy(a.boundingSphere).applyMatrix4(a.matrixWorld);else{let b=a.geometry;null===b.boundingSphere&&b.computeBoundingSphere(),bC.copy(b.boundingSphere).applyMatrix4(a.matrixWorld)}return this.intersectsSphere(bC)}intersectsSprite(a){return bC.center.set(0,0,0),bC.radius=.7071067811865476+bD.distanceTo(a.center),bC.applyMatrix4(a.matrixWorld),this.intersectsSphere(bC)}intersectsSphere(a){let b=this.planes,c=a.center,d=-a.radius;for(let a=0;a<6;a++)if(b[a].distanceToPoint(c)<d)return!1;return!0}intersectsBox(a){let b=this.planes;for(let c=0;c<6;c++){let d=b[c];if(bE.x=d.normal.x>0?a.max.x:a.min.x,bE.y=d.normal.y>0?a.max.y:a.min.y,bE.z=d.normal.z>0?a.max.z:a.min.z,0>d.distanceToPoint(bE))return!1}return!0}containsPoint(a){let b=this.planes;for(let c=0;c<6;c++)if(0>b[c].distanceToPoint(a))return!1;return!0}clone(){return new this.constructor().copy(this)}}class bG{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){console.warn("THREE.Curve: .getPoint() not implemented.")}getPointAt(a,b){let c=this.getUtoTmapping(a);return this.getPoint(c,b)}getPoints(a=5){let b=[];for(let c=0;c<=a;c++)b.push(this.getPoint(c/a));return b}getSpacedPoints(a=5){let b=[];for(let c=0;c<=a;c++)b.push(this.getPointAt(c/a));return b}getLength(){let a=this.getLengths();return a[a.length-1]}getLengths(a=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===a+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let b=[],c,d=this.getPoint(0),e=0;b.push(0);for(let f=1;f<=a;f++)b.push(e+=(c=this.getPoint(f/a)).distanceTo(d)),d=c;return this.cacheArcLengths=b,b}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(a,b=null){let c,d=this.getLengths(),e=0,f=d.length;c=b||a*d[f-1];let g=0,h=f-1,i;for(;g<=h;)if((i=d[e=Math.floor(g+(h-g)/2)]-c)<0)g=e+1;else if(i>0)h=e-1;else{h=e;break}if(d[e=h]===c)return e/(f-1);let j=d[e],k=d[e+1];return(e+(c-j)/(k-j))/(f-1)}getTangent(a,b){let c=a-1e-4,d=a+1e-4;c<0&&(c=0),d>1&&(d=1);let e=this.getPoint(c),f=this.getPoint(d),g=b||(e.isVector2?new D:new F);return g.copy(f).sub(e).normalize(),g}getTangentAt(a,b){let c=this.getUtoTmapping(a);return this.getTangent(c,b)}computeFrenetFrames(a,b=!1){let c=new F,d=[],e=[],f=[],g=new F,h=new az;for(let b=0;b<=a;b++){let c=b/a;d[b]=this.getTangentAt(c,new F)}e[0]=new F,f[0]=new F;let i=Number.MAX_VALUE,j=Math.abs(d[0].x),k=Math.abs(d[0].y),l=Math.abs(d[0].z);j<=i&&(i=j,c.set(1,0,0)),k<=i&&(i=k,c.set(0,1,0)),l<=i&&c.set(0,0,1),g.crossVectors(d[0],c).normalize(),e[0].crossVectors(d[0],g),f[0].crossVectors(d[0],e[0]);for(let b=1;b<=a;b++){if(e[b]=e[b-1].clone(),f[b]=f[b-1].clone(),g.crossVectors(d[b-1],d[b]),g.length()>Number.EPSILON){g.normalize();let a=Math.acos(A(d[b-1].dot(d[b]),-1,1));e[b].applyMatrix4(h.makeRotationAxis(g,a))}f[b].crossVectors(d[b],e[b])}if(!0===b){let b=Math.acos(A(e[0].dot(e[a]),-1,1));b/=a,d[0].dot(g.crossVectors(e[0],e[a]))>0&&(b=-b);for(let c=1;c<=a;c++)e[c].applyMatrix4(h.makeRotationAxis(d[c],b*c)),f[c].crossVectors(d[c],e[c])}return{tangents:d,normals:e,binormals:f}}clone(){return new this.constructor().copy(this)}copy(a){return this.arcLengthDivisions=a.arcLengthDivisions,this}toJSON(){let a={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return a.arcLengthDivisions=this.arcLengthDivisions,a.type=this.type,a}fromJSON(a){return this.arcLengthDivisions=a.arcLengthDivisions,this}}class bH extends bG{constructor(a=0,b=0,c=1,d=1,e=0,f=2*Math.PI,g=!1,h=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=a,this.aY=b,this.xRadius=c,this.yRadius=d,this.aStartAngle=e,this.aEndAngle=f,this.aClockwise=g,this.aRotation=h}getPoint(a,b=new D){let c=2*Math.PI,d=this.aEndAngle-this.aStartAngle,e=Math.abs(d)<Number.EPSILON;for(;d<0;)d+=c;for(;d>c;)d-=c;d<Number.EPSILON&&(d=e?0:c),!0!==this.aClockwise||e||(d===c?d=-c:d-=c);let f=this.aStartAngle+a*d,g=this.aX+this.xRadius*Math.cos(f),h=this.aY+this.yRadius*Math.sin(f);if(0!==this.aRotation){let a=Math.cos(this.aRotation),b=Math.sin(this.aRotation),c=g-this.aX,d=h-this.aY;g=c*a-d*b+this.aX,h=c*b+d*a+this.aY}return b.set(g,h)}copy(a){return super.copy(a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this}toJSON(){let a=super.toJSON();return a.aX=this.aX,a.aY=this.aY,a.xRadius=this.xRadius,a.yRadius=this.yRadius,a.aStartAngle=this.aStartAngle,a.aEndAngle=this.aEndAngle,a.aClockwise=this.aClockwise,a.aRotation=this.aRotation,a}fromJSON(a){return super.fromJSON(a),this.aX=a.aX,this.aY=a.aY,this.xRadius=a.xRadius,this.yRadius=a.yRadius,this.aStartAngle=a.aStartAngle,this.aEndAngle=a.aEndAngle,this.aClockwise=a.aClockwise,this.aRotation=a.aRotation,this}}class bI extends bH{constructor(a,b,c,d,e,f){super(a,b,c,c,d,e,f),this.isArcCurve=!0,this.type="ArcCurve"}}function bJ(){let a=0,b=0,c=0,d=0;function e(e,f,g,h){a=e,b=g,c=-3*e+3*f-2*g-h,d=2*e-2*f+g+h}return{initCatmullRom:function(a,b,c,d,f){e(b,c,f*(c-a),f*(d-b))},initNonuniformCatmullRom:function(a,b,c,d,f,g,h){let i=(b-a)/f-(c-a)/(f+g)+(c-b)/g,j=(c-b)/g-(d-b)/(g+h)+(d-c)/h;e(b,c,i*=g,j*=g)},calc:function(e){let f=e*e;return a+b*e+c*f+f*e*d}}}let bK=new F,bL=new bJ,bM=new bJ,bN=new bJ;class bO extends bG{constructor(a=[],b=!1,c="centripetal",d=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=a,this.closed=b,this.curveType=c,this.tension=d}getPoint(a,b=new F){let c,d,e=this.points,f=e.length,g=(f-!this.closed)*a,h=Math.floor(g),i=g-h;this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/f)+1)*f:0===i&&h===f-1&&(h=f-2,i=1),this.closed||h>0?c=e[(h-1)%f]:(bK.subVectors(e[0],e[1]).add(e[0]),c=bK);let j=e[h%f],k=e[(h+1)%f];if(this.closed||h+2<f?d=e[(h+2)%f]:(bK.subVectors(e[f-1],e[f-2]).add(e[f-1]),d=bK),"centripetal"===this.curveType||"chordal"===this.curveType){let a="chordal"===this.curveType?.5:.25,b=Math.pow(c.distanceToSquared(j),a),e=Math.pow(j.distanceToSquared(k),a),f=Math.pow(k.distanceToSquared(d),a);e<1e-4&&(e=1),b<1e-4&&(b=e),f<1e-4&&(f=e),bL.initNonuniformCatmullRom(c.x,j.x,k.x,d.x,b,e,f),bM.initNonuniformCatmullRom(c.y,j.y,k.y,d.y,b,e,f),bN.initNonuniformCatmullRom(c.z,j.z,k.z,d.z,b,e,f)}else"catmullrom"===this.curveType&&(bL.initCatmullRom(c.x,j.x,k.x,d.x,this.tension),bM.initCatmullRom(c.y,j.y,k.y,d.y,this.tension),bN.initCatmullRom(c.z,j.z,k.z,d.z,this.tension));return b.set(bL.calc(i),bM.calc(i),bN.calc(i)),b}copy(a){super.copy(a),this.points=[];for(let b=0,c=a.points.length;b<c;b++){let c=a.points[b];this.points.push(c.clone())}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this}toJSON(){let a=super.toJSON();a.points=[];for(let b=0,c=this.points.length;b<c;b++){let c=this.points[b];a.points.push(c.toArray())}return a.closed=this.closed,a.curveType=this.curveType,a.tension=this.tension,a}fromJSON(a){super.fromJSON(a),this.points=[];for(let b=0,c=a.points.length;b<c;b++){let c=a.points[b];this.points.push(new F().fromArray(c))}return this.closed=a.closed,this.curveType=a.curveType,this.tension=a.tension,this}}function bP(a,b,c,d,e){let f=(d-b)*.5,g=(e-c)*.5,h=a*a;return a*h*(2*c-2*d+f+g)+(-3*c+3*d-2*f-g)*h+f*a+c}function bQ(a,b,c,d){return function(a,b){let c=1-a;return c*c*b}(a,b)+2*(1-a)*a*c+a*a*d}function bR(a,b,c,d,e){return function(a,b){let c=1-a;return c*c*c*b}(a,b)+function(a,b){let c=1-a;return 3*c*c*a*b}(a,c)+3*(1-a)*a*a*d+a*a*a*e}class bS extends bG{constructor(a=new D,b=new D,c=new D,d=new D){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=a,this.v1=b,this.v2=c,this.v3=d}getPoint(a,b=new D){let c=this.v0,d=this.v1,e=this.v2,f=this.v3;return b.set(bR(a,c.x,d.x,e.x,f.x),bR(a,c.y,d.y,e.y,f.y)),b}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this}toJSON(){let a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this}}class bT extends bG{constructor(a=new F,b=new F,c=new F,d=new F){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=a,this.v1=b,this.v2=c,this.v3=d}getPoint(a,b=new F){let c=this.v0,d=this.v1,e=this.v2,f=this.v3;return b.set(bR(a,c.x,d.x,e.x,f.x),bR(a,c.y,d.y,e.y,f.y),bR(a,c.z,d.z,e.z,f.z)),b}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this.v3.copy(a.v3),this}toJSON(){let a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a.v3=this.v3.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this.v3.fromArray(a.v3),this}}class bU extends bG{constructor(a=new D,b=new D){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=a,this.v2=b}getPoint(a,b=new D){return 1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1)),b}getPointAt(a,b){return this.getPoint(a,b)}getTangent(a,b=new D){return b.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,b){return this.getTangent(a,b)}copy(a){return super.copy(a),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){let a=super.toJSON();return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class bV extends bG{constructor(a=new F,b=new F){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=a,this.v2=b}getPoint(a,b=new F){return 1===a?b.copy(this.v2):(b.copy(this.v2).sub(this.v1),b.multiplyScalar(a).add(this.v1)),b}getPointAt(a,b){return this.getPoint(a,b)}getTangent(a,b=new F){return b.subVectors(this.v2,this.v1).normalize()}getTangentAt(a,b){return this.getTangent(a,b)}copy(a){return super.copy(a),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){let a=super.toJSON();return a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class bW extends bG{constructor(a=new D,b=new D,c=new D){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=a,this.v1=b,this.v2=c}getPoint(a,b=new D){let c=this.v0,d=this.v1,e=this.v2;return b.set(bQ(a,c.x,d.x,e.x),bQ(a,c.y,d.y,e.y)),b}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){let a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class bX extends bG{constructor(a=new F,b=new F,c=new F){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=a,this.v1=b,this.v2=c}getPoint(a,b=new F){let c=this.v0,d=this.v1,e=this.v2;return b.set(bQ(a,c.x,d.x,e.x),bQ(a,c.y,d.y,e.y),bQ(a,c.z,d.z,e.z)),b}copy(a){return super.copy(a),this.v0.copy(a.v0),this.v1.copy(a.v1),this.v2.copy(a.v2),this}toJSON(){let a=super.toJSON();return a.v0=this.v0.toArray(),a.v1=this.v1.toArray(),a.v2=this.v2.toArray(),a}fromJSON(a){return super.fromJSON(a),this.v0.fromArray(a.v0),this.v1.fromArray(a.v1),this.v2.fromArray(a.v2),this}}class bY extends bG{constructor(a=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=a}getPoint(a,b=new D){let c=this.points,d=(c.length-1)*a,e=Math.floor(d),f=d-e,g=c[0===e?e:e-1],h=c[e],i=c[e>c.length-2?c.length-1:e+1],j=c[e>c.length-3?c.length-1:e+2];return b.set(bP(f,g.x,h.x,i.x,j.x),bP(f,g.y,h.y,i.y,j.y)),b}copy(a){super.copy(a),this.points=[];for(let b=0,c=a.points.length;b<c;b++){let c=a.points[b];this.points.push(c.clone())}return this}toJSON(){let a=super.toJSON();a.points=[];for(let b=0,c=this.points.length;b<c;b++){let c=this.points[b];a.points.push(c.toArray())}return a}fromJSON(a){super.fromJSON(a),this.points=[];for(let b=0,c=a.points.length;b<c;b++){let c=a.points[b];this.points.push(new D().fromArray(c))}return this}}function bZ(a,b){return a&&a.constructor!==b?"number"==typeof b.BYTES_PER_ELEMENT?new b(a):Array.prototype.slice.call(a):a}class b${constructor(a,b,c,d){this.parameterPositions=a,this._cachedIndex=0,this.resultBuffer=void 0!==d?d:new b.constructor(c),this.sampleValues=b,this.valueSize=c,this.settings=null,this.DefaultSettings_={}}evaluate(a){let b=this.parameterPositions,c=this._cachedIndex,d=b[c],e=b[c-1];a:{b:{let f;c:{d:if(!(a<d)){for(let f=c+2;;){if(void 0===d){if(a<e)break d;return c=b.length,this._cachedIndex=c,this.copySampleValue_(c-1)}if(c===f)break;if(e=d,a<(d=b[++c]))break b}f=b.length;break c}if(!(a>=e)){let g=b[1];a<g&&(c=2,e=g);for(let f=c-2;;){if(void 0===e)return this._cachedIndex=0,this.copySampleValue_(0);if(c===f)break;if(d=e,a>=(e=b[--c-1]))break b}f=c,c=0;break c}break a}for(;c<f;){let d=c+f>>>1;a<b[d]?f=d:c=d+1}if(d=b[c],void 0===(e=b[c-1]))return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===d)return c=b.length,this._cachedIndex=c,this.copySampleValue_(c-1)}this._cachedIndex=c,this.intervalChanged_(c,e,d)}return this.interpolate_(c,e,a,d)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(a){let b=this.resultBuffer,c=this.sampleValues,d=this.valueSize,e=a*d;for(let a=0;a!==d;++a)b[a]=c[e+a];return b}interpolate_(){throw Error("call to abstract method")}intervalChanged_(){}}class b_ extends b${constructor(a,b,c,d){super(a,b,c,d),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(a,b,c){let d=this.parameterPositions,e=a-2,f=a+1,g=d[e],h=d[f];if(void 0===g)switch(this.getSettings_().endingStart){case 2401:e=a,g=2*b-c;break;case 2402:e=d.length-2,g=b+d[e]-d[e+1];break;default:e=a,g=c}if(void 0===h)switch(this.getSettings_().endingEnd){case 2401:f=a,h=2*c-b;break;case 2402:f=1,h=c+d[1]-d[0];break;default:f=a-1,h=b}let i=(c-b)*.5,j=this.valueSize;this._weightPrev=i/(b-g),this._weightNext=i/(h-c),this._offsetPrev=e*j,this._offsetNext=f*j}interpolate_(a,b,c,d){let e=this.resultBuffer,f=this.sampleValues,g=this.valueSize,h=a*g,i=h-g,j=this._offsetPrev,k=this._offsetNext,l=this._weightPrev,m=this._weightNext,n=(c-b)/(d-b),o=n*n,p=o*n,q=-l*p+2*l*o-l*n,r=(1+l)*p+(-1.5-2*l)*o+(-.5+l)*n+1,s=(-1-m)*p+(1.5+m)*o+.5*n,t=m*p-m*o;for(let a=0;a!==g;++a)e[a]=q*f[j+a]+r*f[i+a]+s*f[h+a]+t*f[k+a];return e}}class b0 extends b${constructor(a,b,c,d){super(a,b,c,d)}interpolate_(a,b,c,d){let e=this.resultBuffer,f=this.sampleValues,g=this.valueSize,h=a*g,i=h-g,j=(c-b)/(d-b),k=1-j;for(let a=0;a!==g;++a)e[a]=f[i+a]*k+f[h+a]*j;return e}}class b1 extends b${constructor(a,b,c,d){super(a,b,c,d)}interpolate_(a){return this.copySampleValue_(a-1)}}class b2{constructor(a,b,c,d){if(void 0===a)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===b||0===b.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+a);this.name=a,this.times=bZ(b,this.TimeBufferType),this.values=bZ(c,this.ValueBufferType),this.setInterpolation(d||this.DefaultInterpolation)}static toJSON(a){let b,c=a.constructor;if(c.toJSON!==this.toJSON)b=c.toJSON(a);else{b={name:a.name,times:bZ(a.times,Array),values:bZ(a.values,Array)};let c=a.getInterpolation();c!==a.DefaultInterpolation&&(b.interpolation=c)}return b.type=a.ValueTypeName,b}InterpolantFactoryMethodDiscrete(a){return new b1(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodLinear(a){return new b0(this.times,this.values,this.getValueSize(),a)}InterpolantFactoryMethodSmooth(a){return new b_(this.times,this.values,this.getValueSize(),a)}setInterpolation(a){let b;switch(a){case 2300:b=this.InterpolantFactoryMethodDiscrete;break;case 2301:b=this.InterpolantFactoryMethodLinear;break;case 2302:b=this.InterpolantFactoryMethodSmooth}if(void 0===b){let b="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant)if(a!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(b);return console.warn("THREE.KeyframeTrack:",b),this}return this.createInterpolant=b,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(a){if(0!==a){let b=this.times;for(let c=0,d=b.length;c!==d;++c)b[c]+=a}return this}scale(a){if(1!==a){let b=this.times;for(let c=0,d=b.length;c!==d;++c)b[c]*=a}return this}trim(a,b){let c=this.times,d=c.length,e=0,f=d-1;for(;e!==d&&c[e]<a;)++e;for(;-1!==f&&c[f]>b;)--f;if(++f,0!==e||f!==d){e>=f&&(e=(f=Math.max(f,1))-1);let a=this.getValueSize();this.times=c.slice(e,f),this.values=this.values.slice(e*a,f*a)}return this}validate(){var a;let b=!0,c=this.getValueSize();c-Math.floor(c)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),b=!1);let d=this.times,e=this.values,f=d.length;0===f&&(console.error("THREE.KeyframeTrack: Track is empty.",this),b=!1);let g=null;for(let a=0;a!==f;a++){let c=d[a];if("number"==typeof c&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),b=!1;break}if(null!==g&&g>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,g),b=!1;break}g=c}if(void 0!==e&&ArrayBuffer.isView(a=e)&&!(a instanceof DataView))for(let a=0,c=e.length;a!==c;++a){let c=e[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),b=!1;break}}return b}optimize(){let a=this.times.slice(),b=this.values.slice(),c=this.getValueSize(),d=2302===this.getInterpolation(),e=a.length-1,f=1;for(let g=1;g<e;++g){let e=!1,h=a[g];if(h!==a[g+1]&&(1!==g||h!==a[0]))if(d)e=!0;else{let a=g*c,d=a-c,f=a+c;for(let g=0;g!==c;++g){let c=b[a+g];if(c!==b[d+g]||c!==b[f+g]){e=!0;break}}}if(e){if(g!==f){a[f]=a[g];let d=g*c,e=f*c;for(let a=0;a!==c;++a)b[e+a]=b[d+a]}++f}}if(e>0){a[f]=a[e];for(let a=e*c,d=f*c,g=0;g!==c;++g)b[d+g]=b[a+g];++f}return f!==a.length?(this.times=a.slice(0,f),this.values=b.slice(0,f*c)):(this.times=a,this.values=b),this}clone(){let a=this.times.slice(),b=this.values.slice(),c=new this.constructor(this.name,a,b);return c.createInterpolant=this.createInterpolant,c}}b2.prototype.ValueTypeName="",b2.prototype.TimeBufferType=Float32Array,b2.prototype.ValueBufferType=Float32Array,b2.prototype.DefaultInterpolation=2301;class b3 extends b2{constructor(a,b,c){super(a,b,c)}}b3.prototype.ValueTypeName="bool",b3.prototype.ValueBufferType=Array,b3.prototype.DefaultInterpolation=2300,b3.prototype.InterpolantFactoryMethodLinear=void 0,b3.prototype.InterpolantFactoryMethodSmooth=void 0;class b4 extends b2{constructor(a,b,c,d){super(a,b,c,d)}}b4.prototype.ValueTypeName="color";class b5 extends b2{constructor(a,b,c,d){super(a,b,c,d)}}b5.prototype.ValueTypeName="number";class b6 extends b${constructor(a,b,c,d){super(a,b,c,d)}interpolate_(a,b,c,d){let e=this.resultBuffer,f=this.sampleValues,g=this.valueSize,h=(c-b)/(d-b),i=a*g;for(let a=i+g;i!==a;i+=4)E.slerpFlat(e,0,f,i-g,f,i,h);return e}}class b7 extends b2{constructor(a,b,c,d){super(a,b,c,d)}InterpolantFactoryMethodLinear(a){return new b6(this.times,this.values,this.getValueSize(),a)}}b7.prototype.ValueTypeName="quaternion",b7.prototype.InterpolantFactoryMethodSmooth=void 0;class b8 extends b2{constructor(a,b,c){super(a,b,c)}}b8.prototype.ValueTypeName="string",b8.prototype.ValueBufferType=Array,b8.prototype.DefaultInterpolation=2300,b8.prototype.InterpolantFactoryMethodLinear=void 0,b8.prototype.InterpolantFactoryMethodSmooth=void 0;class b9 extends b2{constructor(a,b,c,d){super(a,b,c,d)}}b9.prototype.ValueTypeName="vector";class ca{constructor(a,b,c){let d,e=this,f=!1,g=0,h=0,i=[];this.onStart=void 0,this.onLoad=a,this.onProgress=b,this.onError=c,this.abortController=new AbortController,this.itemStart=function(a){h++,!1===f&&void 0!==e.onStart&&e.onStart(a,g,h),f=!0},this.itemEnd=function(a){g++,void 0!==e.onProgress&&e.onProgress(a,g,h),g===h&&(f=!1,void 0!==e.onLoad&&e.onLoad())},this.itemError=function(a){void 0!==e.onError&&e.onError(a)},this.resolveURL=function(a){return d?d(a):a},this.setURLModifier=function(a){return d=a,this},this.addHandler=function(a,b){return i.push(a,b),this},this.removeHandler=function(a){let b=i.indexOf(a);return -1!==b&&i.splice(b,2),this},this.getHandler=function(a){for(let b=0,c=i.length;b<c;b+=2){let c=i[b],d=i[b+1];if(c.global&&(c.lastIndex=0),c.test(a))return d}return null},this.abort=function(){return this.abortController.abort(),this.abortController=new AbortController,this}}}let cb=new ca;class cc{constructor(a){this.manager=void 0!==a?a:cb,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(a,b){let c=this;return new Promise(function(d,e){c.load(a,d,b,e)})}parse(){}setCrossOrigin(a){return this.crossOrigin=a,this}setWithCredentials(a){return this.withCredentials=a,this}setPath(a){return this.path=a,this}setResourcePath(a){return this.resourcePath=a,this}setRequestHeader(a){return this.requestHeader=a,this}abort(){return this}}cc.DEFAULT_MATERIAL_NAME="__DEFAULT",new WeakMap,new WeakMap;let cd="\\[\\]\\.:\\/",ce=RegExp("["+cd+"]","g"),cf="[^"+cd+"]",cg="[^"+cd.replace("\\.","")+"]",ch=/((?:WC+[\/:])*)/.source.replace("WC",cf),ci=/(WCOD+)?/.source.replace("WCOD",cg),cj=RegExp("^"+ch+ci+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",cf)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",cf)+"$"),ck=["material","materials","bones","map"];class cl{constructor(a,b,c){let d=c||cm.parseTrackName(b);this._targetGroup=a,this._bindings=a.subscribe_(b,d)}getValue(a,b){this.bind();let c=this._targetGroup.nCachedObjects_,d=this._bindings[c];void 0!==d&&d.getValue(a,b)}setValue(a,b){let c=this._bindings;for(let d=this._targetGroup.nCachedObjects_,e=c.length;d!==e;++d)c[d].setValue(a,b)}bind(){let a=this._bindings;for(let b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].bind()}unbind(){let a=this._bindings;for(let b=this._targetGroup.nCachedObjects_,c=a.length;b!==c;++b)a[b].unbind()}}class cm{constructor(a,b,c){this.path=b,this.parsedPath=c||cm.parseTrackName(b),this.node=cm.findNode(a,this.parsedPath.nodeName),this.rootNode=a,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(a,b,c){return a&&a.isAnimationObjectGroup?new cm.Composite(a,b,c):new cm(a,b,c)}static sanitizeNodeName(a){return a.replace(/\s/g,"_").replace(ce,"")}static parseTrackName(a){let b=cj.exec(a);if(null===b)throw Error("PropertyBinding: Cannot parse trackName: "+a);let c={nodeName:b[2],objectName:b[3],objectIndex:b[4],propertyName:b[5],propertyIndex:b[6]},d=c.nodeName&&c.nodeName.lastIndexOf(".");if(void 0!==d&&-1!==d){let a=c.nodeName.substring(d+1);-1!==ck.indexOf(a)&&(c.nodeName=c.nodeName.substring(0,d),c.objectName=a)}if(null===c.propertyName||0===c.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+a);return c}static findNode(a,b){if(void 0===b||""===b||"."===b||-1===b||b===a.name||b===a.uuid)return a;if(a.skeleton){let c=a.skeleton.getBoneByName(b);if(void 0!==c)return c}if(a.children){let c=function(a){for(let d=0;d<a.length;d++){let e=a[d];if(e.name===b||e.uuid===b)return e;let f=c(e.children);if(f)return f}return null},d=c(a.children);if(d)return d}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(a,b){a[b]=this.targetObject[this.propertyName]}_getValue_array(a,b){let c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)a[b++]=c[d]}_getValue_arrayElement(a,b){a[b]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(a,b){this.resolvedProperty.toArray(a,b)}_setValue_direct(a,b){this.targetObject[this.propertyName]=a[b]}_setValue_direct_setNeedsUpdate(a,b){this.targetObject[this.propertyName]=a[b],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(a,b){this.targetObject[this.propertyName]=a[b],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(a,b){let c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)c[d]=a[b++]}_setValue_array_setNeedsUpdate(a,b){let c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(a,b){let c=this.resolvedProperty;for(let d=0,e=c.length;d!==e;++d)c[d]=a[b++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(a,b){this.resolvedProperty[this.propertyIndex]=a[b]}_setValue_arrayElement_setNeedsUpdate(a,b){this.resolvedProperty[this.propertyIndex]=a[b],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(a,b){this.resolvedProperty[this.propertyIndex]=a[b],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(a,b){this.resolvedProperty.fromArray(a,b)}_setValue_fromArray_setNeedsUpdate(a,b){this.resolvedProperty.fromArray(a,b),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(a,b){this.resolvedProperty.fromArray(a,b),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(a,b){this.bind(),this.getValue(a,b)}_setValue_unbound(a,b){this.bind(),this.setValue(a,b)}bind(){let a=this.node,b=this.parsedPath,c=b.objectName,d=b.propertyName,e=b.propertyIndex;if(a||(a=cm.findNode(this.rootNode,b.nodeName),this.node=a),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!a)return void console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");if(c){let d=b.objectIndex;switch(c){case"materials":if(!a.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!a.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);a=a.material.materials;break;case"bones":if(!a.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);a=a.skeleton.bones;for(let b=0;b<a.length;b++)if(a[b].name===d){d=b;break}break;case"map":if("map"in a){a=a.map;break}if(!a.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!a.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);a=a.material.map;break;default:if(void 0===a[c])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);a=a[c]}if(void 0!==d){if(void 0===a[d])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,a);a=a[d]}}let f=a[d];if(void 0===f)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+b.nodeName+"."+d+" but it wasn't found.",a);let g=this.Versioning.None;this.targetObject=a,!0===a.isMaterial?g=this.Versioning.NeedsUpdate:!0===a.isObject3D&&(g=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(void 0!==e){if("morphTargetInfluences"===d){if(!a.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!a.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==a.morphTargetDictionary[e]&&(e=a.morphTargetDictionary[e])}h=this.BindingType.ArrayElement,this.resolvedProperty=f,this.propertyIndex=e}else void 0!==f.fromArray&&void 0!==f.toArray?(h=this.BindingType.HasFromToArray,this.resolvedProperty=f):Array.isArray(f)?(h=this.BindingType.EntireArray,this.resolvedProperty=f):this.propertyName=d;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][g]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}function cn({globe:a,airplaneState:b,isActive:c,trailColor:d="#00ff88",airplaneScale:e=.005}){(0,f.useRef)(null),(0,f.useRef)(null);let[g,h]=(0,f.useState)({points:[],opacity:1,maxLength:200});return(0,f.useCallback)(a=>{let b=new bx,c=new Float32Array(3*a.length),e=new Float32Array(3*a.length);return a.forEach((a,b)=>{c[3*b]=a.x,c[3*b+1]=a.y,c[3*b+2]=a.z;let f=new bh(d);e[3*b]=f.r,e[3*b+1]=f.g,e[3*b+2]=f.b}),b.setAttribute("position",new bm(c,3)),b.setAttribute("color",new bm(e,3)),b},[d]),null}cm.Composite=cl,cm.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},cm.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},cm.prototype.GetterByBindingType=[cm.prototype._getValue_direct,cm.prototype._getValue_array,cm.prototype._getValue_arrayElement,cm.prototype._getValue_toArray],cm.prototype.SetterByBindingTypeAndVersioning=[[cm.prototype._setValue_direct,cm.prototype._setValue_direct_setNeedsUpdate,cm.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[cm.prototype._setValue_array,cm.prototype._setValue_array_setNeedsUpdate,cm.prototype._setValue_array_setMatrixWorldNeedsUpdate],[cm.prototype._setValue_arrayElement,cm.prototype._setValue_arrayElement_setNeedsUpdate,cm.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[cm.prototype._setValue_fromArray,cm.prototype._setValue_fromArray_setNeedsUpdate,cm.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]],new Float32Array(1),"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"180"}}));var co=c(8635),cp=c(72567),cq=c(69957),cr=c(88285),cs=c(47089),ct=c(36734),cu=c(15303),cv=c(93758),cw=c(35284),cx=c(99187),cy=c(62186),cz=c(44943),cA=c(24515);function cB({data:a,onResultClick:b,onClearSearch:c,placeholder:d="Search locations, countries, or years...",maxResults:g=8,className:h}){let[i,j]=(0,f.useState)(""),[k,l]=(0,f.useState)([]),[m,n]=(0,f.useState)(!1),[o,p]=(0,f.useState)(-1),q=(0,f.useRef)(null),r=(0,f.useRef)(null);return(0,e.jsxs)("div",{className:(0,cz.cn)("relative w-full max-w-md",h),children:[(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(cr.A,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-700"}),(0,e.jsx)(cv.p,{ref:q,type:"text",value:i,onChange:a=>j(a.target.value),placeholder:d,className:"pl-10 pr-10 bg-white/95 backdrop-blur-sm border-gray-200 focus:border-blue-500"}),i&&(0,e.jsx)(cw.$,{variant:"ghost",size:"sm",onClick:()=>{j(""),l([]),n(!1),p(-1),c(),q.current?.focus()},className:"absolute right-2 top-1/2 -translate-y-1/2 h-6 w-6 p-0 hover:bg-gray-100",children:(0,e.jsx)(cs.A,{className:"h-3 w-3"})})]}),m&&k.length>0&&(0,e.jsx)(cy.Zp,{className:"absolute top-full mt-2 w-full z-50 shadow-lg border-gray-200 bg-white/98 backdrop-blur-sm",children:(0,e.jsxs)(cy.Wu,{className:"p-0",children:[(0,e.jsx)("div",{ref:r,className:"max-h-80 overflow-y-auto",role:"listbox",children:k.map((a,c)=>(0,e.jsx)("button",{onClick:()=>{j(""),n(!1),p(-1),b(a),q.current?.blur()},className:(0,cz.cn)("w-full p-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0 transition-colors",o===c&&"bg-blue-50"),role:"option","aria-selected":o===c,children:(0,e.jsxs)("div",{className:"flex items-start gap-3",children:[a.coverPhotoUrl&&(0,e.jsx)("div",{className:"flex-shrink-0",children:(0,e.jsx)(cA.default,{src:a.coverPhotoUrl,alt:a.name,width:48,height:48,className:"rounded-lg object-cover"})}),(0,e.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(a=>{switch(a.type){case"country":return(0,e.jsx)(co.A,{className:"h-4 w-4 text-blue-600"});case"year":return(0,e.jsx)(cp.A,{className:"h-4 w-4 text-purple-600"});default:return(0,e.jsx)(cq.A,{className:"h-4 w-4 text-green-600"})}})(a),(0,e.jsx)("span",{className:"font-medium text-gray-900 truncate",children:a.name})]}),(0,e.jsxs)("div",{className:"text-sm text-gray-800 mb-2",children:[a.country,"  ",new Date(a.visitDate).toLocaleDateString("en-US",{year:"numeric",month:"short"})]}),(0,e.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,e.jsxs)(cx.E,{variant:"secondary",className:"text-sm",children:[(0,e.jsx)(ct.A,{className:"h-3 w-3 mr-1"}),a.photoCount]}),(0,e.jsxs)(cx.E,{variant:"outline",className:"text-sm",children:[(0,e.jsx)(cu.A,{className:"h-3 w-3 mr-1"}),a.albumCount," album",1!==a.albumCount?"s":""]}),a.tags.slice(0,2).map(a=>(0,e.jsx)(cx.E,{variant:"secondary",className:"text-sm",children:a},a))]})]})]})},a.id))}),k.length===g&&(0,e.jsxs)("div",{className:"p-3 text-center text-sm text-gray-800 border-t",children:["Showing first ",g," results. Try a more specific search."]})]})}),m&&i.length>=2&&0===k.length&&(0,e.jsx)(cy.Zp,{className:"absolute top-full mt-2 w-full z-50 shadow-lg border-gray-200 bg-white/98 backdrop-blur-sm",children:(0,e.jsxs)(cy.Wu,{className:"p-4 text-center text-gray-800",children:[(0,e.jsx)(cr.A,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),(0,e.jsx)("p",{className:"font-medium",children:"No locations found"}),(0,e.jsx)("p",{className:"text-sm mt-1",children:"Try searching for a city, country, or year"})]})}),!i&&q.current===document.activeElement&&(0,e.jsx)(cy.Zp,{className:"absolute top-full mt-2 w-full z-50 shadow-lg border-gray-200 bg-white/98 backdrop-blur-sm",children:(0,e.jsxs)(cy.Wu,{className:"p-4",children:[(0,e.jsx)("div",{className:"text-sm text-gray-800 mb-3",children:"Quick search suggestions:"}),(0,e.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,e.jsx)(cx.E,{variant:"secondary",className:"cursor-pointer hover:bg-gray-200",onClick:()=>j("2024"),children:"2024"}),(0,e.jsx)(cx.E,{variant:"secondary",className:"cursor-pointer hover:bg-gray-200",onClick:()=>j("Japan"),children:"Japan"}),(0,e.jsx)(cx.E,{variant:"secondary",className:"cursor-pointer hover:bg-gray-200",onClick:()=>j("beach"),children:"beach"}),(0,e.jsx)(cx.E,{variant:"secondary",className:"cursor-pointer hover:bg-gray-200",onClick:()=>j("mountains"),children:"mountains"})]})]})})]})}var cC=c(55169),cD=c(5227),cE=c(23673),cF=c(8294),cG=c(59405),cH=c(85265),cI=c(30733),cJ=c(23339);let cK=(0,cJ.A)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var cL=c(3991),cM=c.n(cL);function cN({location:a,position:b,onClose:c,onNavigate:d,onFavorite:g,className:h}){var i,j;let[k,l]=(0,f.useState)(0),[m,n]=(0,f.useState)(!1),o=a.favoritePhotoUrls[k]||a.coverPhotoUrl;return(0,e.jsx)(cC.P.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{duration:.2},className:(0,cz.cn)("fixed z-50 bg-white rounded-xl shadow-2xl border border-gray-200","max-w-sm w-full",h),style:{left:Math.min(b.x,window.innerWidth-400),top:Math.min(b.y,window.innerHeight-(m?600:400))},children:(0,e.jsxs)(cy.Zp,{className:"border-0 shadow-none",children:[(0,e.jsxs)(cy.aR,{className:"pb-3",children:[(0,e.jsxs)("div",{className:"flex items-start justify-between",children:[(0,e.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,e.jsxs)(cy.ZB,{className:"text-lg font-bold text-gray-900 truncate flex items-center gap-2",children:[(0,e.jsx)(cq.A,{className:"h-5 w-5 text-blue-600 flex-shrink-0"}),a.name]}),(0,e.jsx)("p",{className:"text-sm text-gray-800 mt-1",children:a.country})]}),(0,e.jsxs)("div",{className:"flex items-center gap-1 ml-2",children:[(0,e.jsx)(cw.$,{variant:"ghost",size:"sm",onClick:()=>g(a.id),className:(0,cz.cn)("h-8 w-8 p-0",a.isFavorite?"text-red-600":"text-gray-700"),children:(0,e.jsx)(cE.A,{className:(0,cz.cn)("h-4 w-4",a.isFavorite&&"fill-current")})}),(0,e.jsx)(cw.$,{variant:"ghost",size:"sm",onClick:c,className:"h-8 w-8 p-0 text-gray-700 hover:text-gray-800",children:"\xd7"})]})]}),(0,e.jsxs)("div",{className:"flex items-center gap-4 mt-3 text-sm text-gray-800",children:[(0,e.jsxs)("div",{className:"flex items-center gap-1",children:[(0,e.jsx)(cp.A,{className:"h-4 w-4"}),new Date(a.visitDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})]}),(0,e.jsxs)("div",{className:"flex items-center gap-1",children:[(0,e.jsx)(ct.A,{className:"h-4 w-4"}),a.photoCount]})]})]}),(0,e.jsxs)(cy.Wu,{className:"pt-0",children:[o&&(0,e.jsx)("div",{className:"relative mb-4 rounded-lg overflow-hidden bg-gray-100",children:(0,e.jsx)("div",{className:"aspect-video bg-cover bg-center bg-gray-200",style:{backgroundImage:`url(${o})`},children:a.favoritePhotoUrls.length>1&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(cw.$,{variant:"ghost",size:"sm",onClick:()=>{l(b=>0===b?a.favoritePhotoUrls.length-1:b-1)},className:"absolute left-2 top-1/2 -translate-y-1/2 bg-black/20 text-white hover:bg-black/40 h-8 w-8 p-0 rounded-full",children:(0,e.jsx)(cF.A,{className:"h-4 w-4"})}),(0,e.jsx)(cw.$,{variant:"ghost",size:"sm",onClick:()=>{l(b=>b===a.favoritePhotoUrls.length-1?0:b+1)},className:"absolute right-2 top-1/2 -translate-y-1/2 bg-black/20 text-white hover:bg-black/40 h-8 w-8 p-0 rounded-full",children:(0,e.jsx)(cG.A,{className:"h-4 w-4"})}),(0,e.jsx)("div",{className:"absolute bottom-2 left-1/2 -translate-x-1/2 flex gap-1",children:a.favoritePhotoUrls.map((a,b)=>(0,e.jsx)("button",{onClick:()=>l(b),className:(0,cz.cn)("w-2 h-2 rounded-full transition-all",b===k?"bg-white":"bg-white/50 hover:bg-white/75")},b))})]})})}),(0,e.jsxs)("div",{className:"space-y-3",children:[a.weather&&(0,e.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-blue-50 rounded-lg",children:[(0,e.jsx)(cH.A,{className:"h-4 w-4 text-blue-600"}),(0,e.jsxs)("span",{className:"text-sm",children:[a.weather.temperature,"\xb0C, ",a.weather.condition]})]}),a.tags.length>0&&(0,e.jsxs)("div",{className:"flex flex-wrap gap-1",children:[a.tags.slice(0,m?void 0:3).map(a=>(0,e.jsx)(cx.E,{variant:"secondary",className:"text-sm",children:a},a)),!m&&a.tags.length>3&&(0,e.jsxs)(cx.E,{variant:"outline",className:"text-sm",children:["+",a.tags.length-3]})]}),m&&a.description&&(0,e.jsx)(cC.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"text-sm text-gray-800 leading-relaxed",children:a.description}),a.stats&&(0,e.jsxs)("div",{className:(0,cz.cn)("grid grid-cols-3 gap-3 p-3 bg-gray-50 rounded-lg text-center",!m&&"hidden"),children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"text-lg font-bold text-red-600",children:a.stats.likes}),(0,e.jsx)("div",{className:"text-sm text-gray-800",children:"Likes"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"text-lg font-bold text-blue-600",children:a.stats.views}),(0,e.jsx)("div",{className:"text-sm text-gray-800",children:"Views"})]}),(0,e.jsxs)("div",{children:[(0,e.jsxs)("div",{className:"text-lg font-bold text-yellow-600 flex items-center justify-center gap-1",children:[a.stats.rating,(0,e.jsx)(cI.A,{className:"h-3 w-3 fill-current"})]}),(0,e.jsx)("div",{className:"text-sm text-gray-800",children:"Rating"})]})]}),m&&(0,e.jsxs)(cC.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"flex items-center gap-2 text-sm text-gray-800",children:[(0,e.jsx)(co.A,{className:"h-4 w-4"}),(i=a.latitude,j=a.longitude,`${Math.abs(i).toFixed(2)}\xb0${i>=0?"N":"S"}, ${Math.abs(j).toFixed(2)}\xb0${j>=0?"E":"W"}`)]})]}),(0,e.jsxs)("div",{className:"flex items-center gap-2 mt-4 pt-3 border-t",children:[(0,e.jsxs)(cw.$,{size:"sm",onClick:()=>d(a.latitude,a.longitude),className:"flex-1",children:[(0,e.jsx)(co.A,{className:"h-4 w-4 mr-2"}),"Focus"]}),(0,e.jsx)(cM(),{href:`/albums/${a.id}`,children:(0,e.jsxs)(cw.$,{variant:"outline",size:"sm",children:[(0,e.jsx)(cK,{className:"h-4 w-4 mr-2"}),"View"]})}),(0,e.jsx)(cw.$,{variant:"ghost",size:"sm",onClick:()=>n(!m),className:"px-2",children:m?"Less":"More"})]})]})]})})}function cO({previews:a,onClose:b,onNavigate:c,onFavorite:d}){return(0,e.jsx)(cD.N,{children:a.map(({location:a,position:f})=>(0,e.jsx)(cN,{location:a,position:f,onClose:()=>b(a.id),onNavigate:c,onFavorite:d},a.id))})}var cP=c(14263),cQ=c(80196);let cR=(0,cJ.A)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),cS=(0,cJ.A)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]),cT=(0,cJ.A)("play",[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]]);var cU=c(8849),cV=c(33872),cW=c(31851),cX=c(52647);let cY=h()(async()=>{},{loadableGenerated:{modules:["components\\globe\\EnhancedGlobe.tsx -> react-globe.gl"]},ssr:!1});function cZ({className:a}){let b=(0,f.useRef)(void 0),[c,d]=(0,f.useState)(!1),[g,h]=(0,f.useState)(null),[m,n]=(0,f.useState)(null),[o,p]=(0,f.useState)(!0),[q,t]=(0,f.useState)(!1),[u,v]=(0,f.useState)(!1),[w,x]=(0,f.useState)([]),[y,z]=(0,f.useState)({width:800,height:500});(0,f.useRef)(null);let A=(0,f.useRef)(null),{availableYears:B,loading:C,error:D,selectedYear:E,setSelectedYear:F,refreshData:G,getYearData:H}=function(){let{user:a}=(0,j.A)(),[b,c]=(0,f.useState)([]),[d,e]=(0,f.useState)({}),[g,h]=(0,f.useState)(!0),[m,n]=(0,f.useState)(null),[o,p]=(0,f.useState)(null),q=(0,i.UU)(),r=(0,f.useCallback)(async()=>{if(a?.id)try{let{data:b,error:d}=await q.rpc("get_user_travel_years",{user_id_param:a.id});if(d)throw d;let e=b?.map(a=>a.year)||[];c(e.sort((a,b)=>b-a)),e.length>0&&!o&&p(e[0])}catch(a){l.Rm.error("Error fetching available years",{},a),n(a instanceof Error?a.message:"Failed to fetch available years")}},[a?.id,o,q]);(0,f.useCallback)(async b=>{if(!a?.id)return null;try{let{data:c,error:d}=await q.rpc("get_user_travel_by_year",{user_id_param:a.id,year_param:b});if(d)throw d;if(!c||0===c.length)return{year:b,locations:[],totalLocations:0,totalPhotos:0,countries:[],totalDistance:0,startDate:null,endDate:null};let e=[],f=new Set,g=0,h=null,i=null;for(let b of c){let c=new Date(b.visit_date);(!h||c<h)&&(h=c),(!i||c>i)&&(i=c),b.country_code&&f.add(b.country_code),g+=b.photo_count||0;let{data:d}=await q.from("albums").select(`
            id,
            title,
            cover_photo_url,
            favorite_photo_urls,
            user_id,
            visibility,
            profiles:user_id (
              privacy_level
            ),
            photos(id, url, caption)
          `).eq("id",b.album_id),j=d?.filter(b=>{if(b.user_id===a?.id)return!0;let c=k(b.profiles);return"public"!==c||"public"===b.visibility||"followers"===b.visibility}).map(a=>({id:a.id,title:a.title,photoCount:a.photos?.length||0,coverPhotoUrl:a.cover_photo_url,favoritePhotoUrls:a.favorite_photo_urls,userId:a.user_id,visibility:a.visibility,profilePrivacyLevel:k(a.profiles)}))||[],l=d?.flatMap(a=>a.photos?.map(a=>({id:a.id,url:a.url,caption:a.caption}))||[])||[],m={id:b.album_id,name:b.location_name||`Location ${b.sequence_order}`,latitude:parseFloat(b.latitude),longitude:parseFloat(b.longitude),type:b.location_type,visitDate:c,duration:b.duration_days,albums:j,photos:l,airportCode:b.airport_code,timezone:b.timezone,islandGroup:b.island_group};e.push(m)}let j=0;for(let a=0;a<e.length-1;a++){let b=e[a],c=e[a+1],d=s(b,c);j+=d}return{year:b,locations:e,totalLocations:e.length,totalPhotos:g,countries:Array.from(f),totalDistance:j,startDate:h,endDate:i}}catch(a){throw l.Rm.error(`Error fetching year data for ${b}`,{error:a}),a}},[a?.id,q]);let s=(a,b)=>{let c=(b.latitude-a.latitude)*Math.PI/180,d=(b.longitude-a.longitude)*Math.PI/180,e=Math.sin(c/2)*Math.sin(c/2)+Math.cos(a.latitude*Math.PI/180)*Math.cos(b.latitude*Math.PI/180)*Math.sin(d/2)*Math.sin(d/2);return 2*Math.atan2(Math.sqrt(e),Math.sqrt(1-e))*6371},t=(0,f.useCallback)(async()=>{if(a?.id){h(!0),n(null);try{await r(),e({})}catch(a){n(a instanceof Error?a.message:"Failed to refresh data")}finally{h(!1)}}},[r,a?.id]),u=(0,f.useCallback)(a=>d[a]||null,[d]);return{availableYears:b,yearData:d,loading:g,error:m,selectedYear:o,setSelectedYear:p,refreshData:t,getYearData:u}}(),{isPlaying:I,currentFlightState:J,progress:K,cameraPosition:L,play:M,pause:N,reset:O,setLocations:P}=function(a={}){let{autoPlay:b=!1,defaultSpeed:c=1,cameraFollowsPlane:d=!0,onSegmentComplete:e,onAnimationComplete:g,onError:h}=a,[i,j]=(0,f.useState)(!1),[k,l]=(0,f.useState)(!1),[m,n]=(0,f.useState)(!1),[o,p]=(0,f.useState)(null),[q,t]=(0,f.useState)(c),[u,v]=(0,f.useState)([]),[w,x]=(0,f.useState)([]),[y,z]=(0,f.useState)(null),[A,B]=(0,f.useState)(null),[C,D]=(0,f.useState)(d),[E,F]=(0,f.useState)(b),[G,H]=(0,f.useState)({currentSegment:0,totalSegments:0,segmentProgress:0,overallProgress:0,currentLocation:null,nextLocation:null,estimatedTimeRemaining:0}),I=(0,f.useRef)(null);(0,f.useRef)(void 0);let J=(0,f.useCallback)(()=>{I.current||(I.current=new r(a=>{z({position:{lat:a.position.lat,lng:a.position.lng,altitude:a.position.altitude||0},rotation:a.rotation,speed:a.speed,progress:I.current?.getProgress().percentage||0})},a=>{C&&B(a)},a=>{let b=u.find(b=>b.id===a.id);b&&e?.(b)}))},[C,u,e]),K=(0,f.useCallback)(async a=>{if(a.length<2)return void x([]);n(!0),p(null);try{let b=[];for(let c=0;c<a.length-1;c++){let d=a[c],e=a[c+1],f=s.generateFlightPath({lat:d.latitude,lng:d.longitude,name:d.name},{lat:e.latitude,lng:e.longitude,name:e.name});b.push(f)}x(b),H(c=>({...c,totalSegments:b.length,currentLocation:a[0]||null,nextLocation:a[1]||null}))}catch(b){let a=b instanceof Error?b.message:"Failed to generate flight paths";p(a),h?.(a)}finally{n(!1)}},[h]),L=(0,f.useCallback)(()=>{I.current&&0!==w.length&&(j(!0),l(!1),p(null),I.current.play())},[w.length]),M=(0,f.useCallback)(async a=>{if(v(a),await K(a),J(),I.current&&a.length>0){let b=a.map((a,b)=>({id:a.id,year:a.visitDate.getFullYear(),sequenceOrder:b+1,cityId:void 0,countryId:void 0,visitDate:a.visitDate.toISOString().split("T")[0],latitude:a.latitude,longitude:a.longitude,albumCount:a.albums.length,photoCount:a.photos.length,locationName:a.name}));I.current.setTimeline(b,b[0]?.year||new Date().getFullYear())}E&&a.length>1&&L()},[K,J,E,L]),N=(0,f.useCallback)(()=>{I.current&&(j(!1),l(!0),I.current.pause())},[]),O=(0,f.useCallback)(()=>{I.current&&(j(!1),l(!1),I.current.pause(),I.current.reset(),z(null),B(null),H(a=>({...a,currentSegment:0,segmentProgress:0,overallProgress:0,estimatedTimeRemaining:0})))},[]),P=(0,f.useCallback)(()=>{O(),u.length>0&&H(a=>({...a,currentLocation:u[0]||null,nextLocation:u[1]||null}))},[O,u]),Q=(0,f.useCallback)(a=>{let b=Math.max(.1,Math.min(5,a));t(b),I.current&&I.current.setSpeed(b)},[]),R=(0,f.useCallback)(a=>{!I.current||a<0||a>=w.length||(I.current.seekToSegment(a),H(b=>({...b,currentSegment:a,currentLocation:u[a]||null,nextLocation:u[a+1]||null})))},[w.length,u]),S=(0,f.useCallback)(a=>{R(Math.floor(Math.max(0,Math.min(100,a))/100*Math.max(0,w.length-1)))},[w.length,R]),T=(0,f.useCallback)(a=>{F(a)},[]),U=(0,f.useCallback)(a=>{D(a),a||B(null)},[]),V=w.reduce((a,b)=>a+b.duration,0);return{isPlaying:i,isPaused:k,isLoading:m,error:o,flightPaths:w,currentFlightState:y,progress:G,cameraPosition:A,play:L,pause:N,stop:O,reset:P,setSpeed:Q,setLocations:M,seekToSegment:R,seekToProgress:S,speed:q,totalDuration:V,setAutoPlay:T,setCameraFollow:U}}({autoPlay:!1,defaultSpeed:1,cameraFollowsPlane:!0,onSegmentComplete:a=>{n(a.id),l.Rm.debug("Flight animation segment completed",{component:"EnhancedGlobe",action:"segment-complete",locationId:a.id,locationName:a.name})},onAnimationComplete:()=>{l.Rm.info("Flight animation completed successfully",{component:"EnhancedGlobe",action:"animation-complete"})},onError:a=>{l.Rm.error("Flight animation failed",{component:"EnhancedGlobe",action:"animation-error"},a)}}),Q=E?H(E):null,R=(0,f.useMemo)(()=>Q?.locations||[],[Q]),S=(0,f.useMemo)(()=>R.map(a=>({id:a.id,name:a.name,latitude:a.latitude,longitude:a.longitude,country:"Unknown Location",visitDate:a.visitDate.toISOString(),albumCount:a.albums.length,photoCount:a.photos.length,coverPhotoUrl:a.albums[0]?.coverPhotoUrl,tags:[],type:"location"})),[R]),T=function({cities:a,onCityClick:b,onClusterClick:c,clusterDistance:d=200,activeCity:e}){let g=(0,f.useMemo)(()=>(function(a,b){if(0===a.length)return[];let c=[],d=new Set;return a.forEach(e=>{if(d.has(e.id))return;let f={id:`cluster-${e.id}`,latitude:e.latitude,longitude:e.longitude,cities:[e],totalAlbums:e.albumCount,totalPhotos:e.photoCount,radius:Math.max(.8,Math.min(3,.3*Math.sqrt(e.albumCount+e.photoCount)))};d.add(e.id),a.forEach(a=>{if(!d.has(a.id)&&a.id!==e.id&&function(a,b,c,d){let e=a=>a*Math.PI/180,f=e(c-a),g=e(d-b),h=Math.sin(f/2)**2+Math.cos(e(a))*Math.cos(e(c))*Math.sin(g/2)**2;return 2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))*6371}(e.latitude,e.longitude,a.latitude,a.longitude)<=b){f.cities.push(a),f.totalAlbums+=a.albumCount,f.totalPhotos+=a.photoCount,d.add(a.id);let b=f.cities.reduce((a,b)=>{let c=b.albumCount+b.photoCount+1;return a+b.latitude*c},0)/f.cities.reduce((a,b)=>a+b.albumCount+b.photoCount+1,0),c=f.cities.reduce((a,b)=>{let c=b.albumCount+b.photoCount+1;return a+b.longitude*c},0)/f.cities.reduce((a,b)=>a+b.albumCount+b.photoCount+1,0);f.latitude=b,f.longitude=c,f.radius=Math.max(.8,Math.min(3,.2*Math.sqrt(f.totalAlbums+f.totalPhotos)))}}),c.push(f)}),c})(a,d),[a,d]),h=(0,f.useMemo)(()=>g.map(a=>{let b=a.cities.length>1,c=a.cities.some(a=>a.id===e);return{id:a.id,lat:a.latitude,lng:a.longitude,size:a.radius,color:c?"#ff6b35":b?"#4f46e5":"#06b6d4",cluster:a,isMultiCity:b,isActive:c,label:b?`${a.cities.length} cities`:a.cities[0].name,albumCount:a.totalAlbums,photoCount:a.totalPhotos,opacity:c?1:.8}}),[g,e]),i=(0,f.useMemo)(()=>g.filter(a=>a.totalAlbums>0||a.totalPhotos>0).map(a=>{let b=a.cities.some(a=>a.id===e),c=a.cities.length>1;return{lat:a.latitude,lng:a.longitude+2,text:c?`${a.cities.length} Cities`:a.cities[0].name,size:b?1.2:.8,color:b?"#ff6b35":"#ffffff",backgroundColor:"rgba(0, 0, 0, 0.7)",borderRadius:3,padding:2}}),[g,e]);return{pinData:h,labelData:i,ringData:(0,f.useMemo)(()=>g.filter(a=>a.cities.some(a=>a.id===e)).map(a=>({lat:a.latitude,lng:a.longitude,maxR:2*a.radius,propagationSpeed:4,repeatPeriod:2e3,color:"#ff6b35"})),[g,e]),handlePinClick:a=>{let d=a.cluster;1===d.cities.length?b?.(d.cities[0]):c?.(d)},clusters:g}}({cities:R.map(a=>{let b=a.albums[0],c=b?.favoritePhotoUrls||[],d=b?.coverPhotoUrl,e=c.length>0?c:d?[d]:a.photos.length>0?[a.photos[0].url]:[];return{id:a.id,name:a.name,latitude:a.latitude,longitude:a.longitude,albumCount:a.albums.length,photoCount:a.photos.length,visitDate:a.visitDate.toISOString(),isVisited:!0,isActive:m===a.id,favoritePhotoUrls:e,coverPhotoUrl:d}}),onCityClick:function(a){n(a.id),p(!1);let c=R.find(b=>b.id===a.id);c&&Y(c,{x:window.innerWidth/2,y:window.innerHeight/2}),b.current&&U({lat:a.latitude,lng:a.longitude,altitude:1.5},1200,"easeInOutCubic"),setTimeout(()=>p(!0),5e3)},onClusterClick:function(a){h(a),p(!1),b.current&&U({lat:a.latitude,lng:a.longitude,altitude:1.2},1200,"easeInOutCubic"),setTimeout(()=>p(!0),5e3)},activeCity:m}),U=(0,f.useCallback)((a,c=1e3,d="easeInOutQuad")=>{if(!b.current)return;A.current&&cancelAnimationFrame(A.current);let e=b.current.pointOfView(),f=Date.now(),g={linear:a=>a,easeInOutQuad:a=>a<.5?2*a*a:-1+(4-2*a)*a,easeInOutCubic:a=>a<.5?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1,easeInOutExpo:a=>0===a?0:1===a?1:a<.5?Math.pow(2,20*a-10)/2:(2-Math.pow(2,-20*a+10))/2},h=g[d]||g.easeInOutQuad,i=()=>{let d=Math.min((Date.now()-f)/c,1),g=h(d),j={lat:e.lat+(a.lat-e.lat)*g,lng:V(e.lng,a.lng,g),altitude:e.altitude+(a.altitude-e.altitude)*g};b.current&&b.current.pointOfView(j,0),d<1&&(A.current=requestAnimationFrame(i))};i()},[]),V=(0,f.useCallback)((a,b,c)=>{let d=b-a;return a+(d>180?d-360:d<-180?d+360:d)*c},[]),W=(0,f.useCallback)(a=>{if(0===a.length)return{lat:0,lng:0,altitude:2.5};if(1===a.length)return{lat:a[0].latitude,lng:a[0].longitude,altitude:1.8};let b=a.map(a=>a.latitude),c=a.map(a=>a.longitude),d=Math.min(...b),e=Math.max(...b),f=Math.min(...c),g=Math.max(...c),h=Math.max(1.5,Math.min(4,.02*Math.max(e-d,g-f)+1.2));return{lat:(d+e)/2,lng:(f+g)/2,altitude:h}},[]),X=(0,f.useCallback)(a=>{let b=R.find(b=>b.id===a.id);b&&(n(a.id),p(!1),U({lat:a.latitude,lng:a.longitude,altitude:1.5},1500,"easeInOutCubic"),setTimeout(()=>{Y(b,{x:window.innerWidth/2,y:window.innerHeight/2})},800))},[R,U]),Y=(0,f.useCallback)((a,b)=>{let c={id:a.id,name:a.name,country:"Unknown Location",latitude:a.latitude,longitude:a.longitude,visitDate:a.visitDate.toISOString(),albumCount:a.albums.length,photoCount:a.photos.length,favoritePhotoUrls:a.albums[0]?.favoritePhotoUrls||[],coverPhotoUrl:a.albums[0]?.coverPhotoUrl,description:`Travel memories from ${a.name}`,tags:[],isPublic:!0,isFavorite:!1,stats:{likes:0,views:0,shares:0,rating:0}};x(d=>d.find(b=>b.location.id===a.id)?d:[...d,{location:c,position:b}])},[]),Z=(0,f.useCallback)(a=>{x(b=>b.filter(b=>b.location.id!==a))},[]),$=(0,f.useCallback)(a=>{x(b=>b.map(b=>b.location.id===a?{...b,location:{...b.location,isFavorite:!b.location.isFavorite}}:b)),l.Rm.info("Toggled favorite for location",{component:"EnhancedGlobe",action:"toggle-favorite",locationId:a})},[]),_=R[K.currentSegment]?{id:R[K.currentSegment].id,year:R[K.currentSegment].visitDate.getFullYear(),sequenceOrder:K.currentSegment+1,cityId:void 0,countryId:void 0,visitDate:R[K.currentSegment].visitDate.toISOString().split("T")[0],latitude:R[K.currentSegment].latitude,longitude:R[K.currentSegment].longitude,albumCount:R[K.currentSegment].albums.length,photoCount:R[K.currentSegment].photos.length,locationName:R[K.currentSegment].name}:null;return C?(0,e.jsx)("div",{className:"space-y-8",children:(0,e.jsxs)("div",{className:"text-center py-12",children:[(0,e.jsx)(cP.A,{className:"h-12 w-12 animate-spin mx-auto text-blue-600"}),(0,e.jsx)("h2",{className:"text-xl font-semibold mt-4",children:"Loading your travel timeline..."}),(0,e.jsx)("p",{className:"text-gray-800 mt-2",children:"Preparing flight animation data"})]})}):(0,e.jsxs)("div",{className:`space-y-6 ${a}`,children:[(0,e.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,e.jsx)("div",{children:(0,e.jsxs)("h1",{className:"text-xl font-semibold text-gray-900 flex items-center gap-2",children:[(0,e.jsx)(cQ.A,{className:"h-6 w-6 text-blue-600"}),"Globe"]})}),(0,e.jsxs)("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[(0,e.jsxs)(cw.$,{variant:"outline",size:"sm",onClick:()=>v(!u),className:(0,cz.cn)("text-sm",u?"bg-blue-50 border-blue-300":""),children:[(0,e.jsx)(cr.A,{className:"h-4 w-4 sm:mr-2"}),(0,e.jsx)("span",{className:"hidden sm:inline",children:"Search"})]}),(0,e.jsxs)(cw.$,{variant:"outline",size:"sm",onClick:function(){O(),n(null),h(null),p(!0),b.current&&U({lat:0,lng:0,altitude:2.5},1500,"easeInOutExpo")},children:[(0,e.jsx)(cR,{className:"h-4 w-4 sm:mr-2"}),(0,e.jsx)("span",{className:"hidden sm:inline",children:"Reset"})]}),(0,e.jsxs)(cw.$,{variant:"outline",size:"sm",onClick:function(){I?N():M()},disabled:R.length<2,className:"text-sm",children:[I?(0,e.jsx)(cS,{className:"h-4 w-4 sm:mr-2"}):(0,e.jsx)(cT,{className:"h-4 w-4 sm:mr-2"}),(0,e.jsxs)("span",{className:"hidden sm:inline",children:[I?"Pause":"Play"," Flight"]})]}),(0,e.jsx)(cM(),{href:"/albums/new",children:(0,e.jsxs)(cw.$,{size:"sm",className:"text-sm",children:[(0,e.jsx)(cU.A,{className:"h-4 w-4 sm:mr-2"}),(0,e.jsx)("span",{className:"hidden sm:inline",children:"Add Adventure"})]})})]})]}),D&&(0,e.jsx)(cy.Zp,{className:"border-red-200 bg-red-50",children:(0,e.jsx)(cy.Wu,{className:"pt-6",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("p",{className:"text-red-600 font-medium",children:"Unable to load travel timeline"}),(0,e.jsx)("p",{className:"text-red-500 text-sm mt-1",children:D}),(0,e.jsx)(cw.$,{variant:"outline",onClick:G,className:"mt-4",children:"Try Again"})]})})}),u&&(0,e.jsx)("div",{className:"flex justify-center",children:(0,e.jsx)(cB,{data:S,onResultClick:X,onClearSearch:()=>v(!1),className:"w-full max-w-md"})}),B.length>0&&(0,e.jsx)("div",{className:"flex items-center justify-center",children:(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)("span",{className:"text-sm font-medium text-gray-800",children:"Travel Year:"}),(0,e.jsx)("div",{className:"flex gap-2",children:B.map(a=>(0,e.jsx)(cw.$,{variant:E===a?"default":"outline",size:"sm",onClick:()=>{F(a),n(null),h(null),O(),setTimeout(()=>{let b=H(a);b&&b.locations.length>0&&U(W(b.locations),2e3,"easeInOutExpo")},500)},className:E===a?"bg-blue-600 hover:bg-blue-700 text-white":"hover:bg-blue-50 hover:border-blue-300",children:a},a))})]})}),(0,e.jsxs)("div",{className:"flex flex-col xl:flex-row gap-6",children:[(0,e.jsx)("div",{className:"flex-1 xl:flex-[2]",children:(0,e.jsxs)("div",{className:"globe-container bg-gradient-to-br from-blue-900 to-purple-900 h-[400px] sm:h-[500px] lg:h-[600px] rounded-lg overflow-hidden relative flex items-center justify-center",children:[(0,e.jsxs)("div",{className:"absolute top-4 right-4 z-10 flex flex-col gap-2",children:[(0,e.jsx)(cw.$,{variant:"outline",size:"sm",onClick:function(){if(b.current){let a=b.current.pointOfView(),c=Math.max(.5,.8*a.altitude);U({...a,altitude:c},400,"easeInOutQuad"),p(!1),setTimeout(()=>p(!0),3e3)}},className:"bg-white/90 hover:bg-white",children:(0,e.jsx)(cV.A,{className:"h-4 w-4"})}),(0,e.jsx)(cw.$,{variant:"outline",size:"sm",onClick:function(){if(b.current){let a=b.current.pointOfView(),c=Math.min(5,1.2*a.altitude);U({...a,altitude:c},400,"easeInOutQuad"),p(!1),setTimeout(()=>p(!0),3e3)}},className:"bg-white/90 hover:bg-white",children:(0,e.jsx)(cW.A,{className:"h-4 w-4"})})]}),(0,e.jsx)(cY,{ref:b,globeImageUrl:"//unpkg.com/three-globe/example/img/earth-blue-marble.jpg",backgroundColor:"#0f1729",width:y.width,height:y.height,showAtmosphere:!0,atmosphereColor:"rgba(135, 206, 250, 0.8)",atmosphereAltitude:.25,onGlobeClick:()=>{t(!0),p(!1),setTimeout(()=>{t(!1),p(!0)},3e3)},enablePointerInteraction:!0,htmlElementsData:T.pinData,htmlLat:a=>a.lat,htmlLng:a=>a.lng,htmlAltitude:a=>.01*a.size,htmlElement:a=>{let b=document.createElement("div");return b.innerHTML=`
                      <div style="
                        width: ${8*a.size}px;
                        height: ${8*a.size}px;
                        background: ${a.color};
                        border: 2px solid white;
                        border-radius: 50%;
                        opacity: ${a.opacity};
                        box-shadow: 0 2px 8px rgba(0,0,0,0.3);
                        cursor: pointer;
                        transition: all 0.3s ease;
                        position: relative;
                      "></div>
                    `,b.style.pointerEvents="auto",b.addEventListener("click",()=>T.handlePinClick(a)),b.addEventListener("mouseenter",()=>{b.style.transform="scale(1.2)"}),b.addEventListener("mouseleave",()=>{b.style.transform="scale(1)"}),b.title=function(a,b=!1){if(1===a.cities.length){let c=a.cities[0];if(b)return`
        <div style="
          background: rgba(0, 0, 0, 0.95);
          color: white;
          padding: 12px;
          border-radius: 8px;
          font-family: system-ui;
          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
          max-width: 220px;
          border: 1px solid rgba(255, 255, 255, 0.1);
          text-align: center;
        ">
          <div style="margin-bottom: 8px;">
            <div style="
              width: 40px;
              height: 40px;
              background: rgba(255, 255, 255, 0.1);
              border-radius: 20px;
              margin: 0 auto 8px;
              display: flex;
              align-items: center;
              justify-content: center;
            "></div>
          </div>
          <h3 style="margin: 0 0 6px 0; font-size: 16px; font-weight: 600; color: #ffffff;">${c.name}</h3>
          <p style="font-size: 12px; opacity: 0.8; color: #e5e5e5; margin: 0;">
            Private content
          </p>
          <p style="font-size: 11px; opacity: 0.7; color: #c5c5c5; margin: 4px 0 0 0;">
            Follow to see adventures
          </p>
        </div>
      `;let d=c.favoritePhotoUrls||[],e=d.length>0?`
      <div style="
        display: grid;
        grid-template-columns: repeat(${Math.min(d.length,3)}, 1fr);
        gap: 4px;
        margin: 8px 0;
      ">
        ${d.slice(0,3).map(a=>`
          <img src="${a}" style="
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 4px;
            border: 1px solid rgba(255, 255, 255, 0.2);
          " />
        `).join("")}
      </div>
    `:"";return`
      <div style="
        background: rgba(0, 0, 0, 0.95);
        color: white;
        padding: 12px;
        border-radius: 8px;
        font-family: system-ui;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
        max-width: 220px;
        border: 1px solid rgba(255, 255, 255, 0.1);
      ">
        <h3 style="margin: 0 0 8px 0; font-size: 16px; font-weight: 600; color: #ffffff;">${c.name}</h3>
        ${e}
        <div style="font-size: 13px; opacity: 0.9; color: #e5e5e5;">
          <div style="margin-bottom: 3px;"> ${new Date(c.visitDate).toLocaleDateString()}</div>
          <div style="margin-bottom: 3px;"> ${c.albumCount} album${1===c.albumCount?"":"s"}</div>
          <div style="margin-bottom: 0;"> ${c.photoCount} photo${1===c.photoCount?"":"s"}</div>
        </div>
      </div>
    `}{let b=[];a.cities.forEach(a=>{a.favoritePhotoUrls&&a.favoritePhotoUrls.length>0&&b.push(...a.favoritePhotoUrls.slice(0,1))});let c=b.length>0?`
      <div style="
        display: grid;
        grid-template-columns: repeat(${Math.min(b.length,3)}, 1fr);
        gap: 4px;
        margin: 8px 0;
      ">
        ${b.slice(0,3).map(a=>`
          <img src="${a}" style="
            width: 50px;
            height: 50px;
            object-fit: cover;
            border-radius: 4px;
            border: 1px solid rgba(255, 255, 255, 0.2);
          " />
        `).join("")}
      </div>
    `:"";return`
      <div style="
        background: rgba(0, 0, 0, 0.95);
        color: white;
        padding: 12px;
        border-radius: 8px;
        font-family: system-ui;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
        max-width: 260px;
        border: 1px solid rgba(255, 255, 255, 0.1);
      ">
        <h3 style="margin: 0 0 8px 0; font-size: 16px; font-weight: 600; color: #ffffff;">
          ${a.cities.length} Cities Cluster
        </h3>
        ${c}
        <div style="font-size: 13px; opacity: 0.9; color: #e5e5e5;">
          <div style="margin-bottom: 3px;"> ${a.totalAlbums} total albums</div>
          <div style="margin-bottom: 6px;"> ${a.totalPhotos} total photos</div>
          <div style="font-size: 12px; opacity: 0.7; color: #c5c5c5;">
            Cities: ${a.cities.map(a=>a.name).slice(0,3).join(", ")}
            ${a.cities.length>3?` +${a.cities.length-3} more`:""}
          </div>
        </div>
      </div>
    `}}(a.cluster),b},labelsData:T.labelData,labelLat:a=>a.lat,labelLng:a=>a.lng,labelText:a=>a.text,labelSize:a=>a.size,labelColor:a=>a.color,labelDotRadius:.5,labelIncludeDot:!0,ringsData:T.ringData,ringLat:a=>a.lat,ringLng:a=>a.lng,ringMaxRadius:a=>a.maxR,ringPropagationSpeed:a=>a.propagationSpeed,ringRepeatPeriod:a=>a.repeatPeriod,ringColor:a=>a.color,onGlobeReady:()=>{if(d(!0),R.length>0){let a=W(R);setTimeout(()=>{U(a,2e3,"easeInOutExpo")},1e3)}}}),(0,e.jsx)(cn,{globe:b.current,airplaneState:J,isActive:I,trailColor:"#00ff88",airplaneScale:.005}),!c&&(0,e.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,e.jsx)(cP.A,{className:"h-8 w-8 animate-spin text-blue-600"})})]})}),(0,e.jsx)("div",{className:"w-full xl:w-80",children:(0,e.jsx)(cy.Zp,{children:(0,e.jsxs)(cy.Wu,{className:"p-6",children:[I&&_&&(0,e.jsxs)("div",{className:"space-y-4 pb-6 border-b",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)(cX.A,{className:"h-4 w-4 text-blue-600"}),(0,e.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"Current Flight"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"font-medium text-gray-900",children:_.locationName}),(0,e.jsxs)("p",{className:"text-sm text-gray-800",children:["Segment ",K.currentSegment+1," of ",K.totalSegments]})]}),(0,e.jsx)("div",{className:"flex items-center gap-2",children:(0,e.jsxs)(cx.E,{variant:"outline",className:"text-sm",children:[Math.round(K.overallProgress),"% Complete"]})})]}),g&&(0,e.jsxs)("div",{className:"space-y-4 pb-6 border-b",children:[(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)(cq.A,{className:"h-4 w-4 text-blue-600"}),(0,e.jsx)("span",{className:"text-sm font-medium text-gray-900",children:g.cities.length>1?`${g.cities.length} Cities`:g.cities[0]?.name})]}),(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-center",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"text-xl font-bold text-blue-600",children:g.totalAlbums}),(0,e.jsx)("div",{className:"text-xs text-gray-800",children:"Albums"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"text-xl font-bold text-blue-600",children:g.totalPhotos}),(0,e.jsx)("div",{className:"text-xs text-gray-800",children:"Photos"})]})]})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)("div",{className:"text-sm font-medium text-gray-900 mb-3",children:"Quick Actions"}),(0,e.jsx)(cM(),{href:"/albums/new",children:(0,e.jsxs)(cw.$,{className:"w-full justify-start text-sm",children:[(0,e.jsx)(cU.A,{className:"mr-2 h-4 w-4"}),"Add New Adventure"]})}),(0,e.jsxs)(cw.$,{variant:"outline",size:"sm",className:"w-full justify-start text-sm",onClick:()=>n(null),children:[(0,e.jsx)(cq.A,{className:"mr-2 h-4 w-4"}),"Clear Selection"]}),(0,e.jsxs)(cw.$,{variant:"outline",size:"sm",className:"w-full justify-start text-sm",onClick:G,children:[(0,e.jsx)(cR,{className:"mr-2 h-4 w-4"}),"Refresh Data"]})]})]})})})]}),(0,e.jsx)(cO,{previews:w,onClose:Z,onNavigate:(a,b)=>{U({lat:a,lng:b,altitude:1.5},1e3,"easeInOutCubic")},onFavorite:$}),u&&(0,e.jsx)("div",{className:"fixed bottom-4 right-4 z-40",children:(0,e.jsx)(cy.Zp,{className:"bg-black/80 text-white text-sm p-2",children:(0,e.jsxs)("div",{className:"space-y-1",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("kbd",{className:"bg-white/20 px-1 rounded",children:"K"})," Search"]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("kbd",{className:"bg-white/20 px-1 rounded",children:""})," Navigate"]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("kbd",{className:"bg-white/20 px-1 rounded",children:""})," Select"]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("kbd",{className:"bg-white/20 px-1 rounded",children:"Esc"})," Close"]})]})})})]})}function c$(){return(0,e.jsx)("div",{className:"space-y-8",children:(0,e.jsx)(cZ,{})})}},99187:(a,b,c)=>{"use strict";c.d(b,{E:()=>h});var d=c(21124);c(38301);var e=c(26691),f=c(44943);let g=(0,e.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-sm font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function h({className:a,variant:b,...c}){return(0,d.jsx)("div",{className:(0,f.cn)(g({variant:b}),a),...c})}}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[4586,1121,517,3991,1223,959,5309,6426],()=>b(b.s=1623));module.exports=c})();