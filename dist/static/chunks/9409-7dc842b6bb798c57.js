"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9409],{11647:(e,o,t)=>{t.d(o,{E:()=>s});var l=t(95155);t(12115);var r=t(83101),n=t(64269);let a=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-sm font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function s(e){let{className:o,variant:t,...r}=e;return(0,l.jsx)("div",{className:(0,n.cn)(a({variant:t}),o),...r})}},16522:(e,o,t)=>{t.d(o,{k:()=>s});var l=t(12115),r=t(62890),n=t(43691),a=t(82466);function s(e){let{user:o}=(0,n.A)(),[t,s]=(0,l.useState)(!1),[i,d]=(0,l.useState)(null),[c,u]=(0,l.useState)({followersCount:0,followingCount:0,pendingRequestsCount:0}),[f,w]=(0,l.useState)("not_following"),[g,m]=(0,l.useState)([]),[p,v]=(0,l.useState)([]),[x,_]=(0,l.useState)([]),h=(0,r.UU)(),b=(0,l.useCallback)(async()=>{if(null==o?void 0:o.id)try{let[e,t,l]=await Promise.all([h.from("followers").select("id",{count:"exact"}).eq("following_id",o.id).eq("status","accepted"),h.from("followers").select("id",{count:"exact"}).eq("follower_id",o.id).eq("status","accepted"),h.from("followers").select("id",{count:"exact"}).eq("following_id",o.id).eq("status","pending")]);u({followersCount:e.count||0,followingCount:t.count||0,pendingRequestsCount:l.count||0})}catch(e){a.Rm.error("Error fetching follow stats",{component:"useFollows",action:"refreshStats",userId:o.id},e instanceof Error?e:Error(String(e))),d(e instanceof Error?e.message:"Failed to fetch follow stats")}},[null==o?void 0:o.id,h]),y=(0,l.useCallback)(async e=>{if(!(null==o?void 0:o.id)||e===o.id)return"not_following";try{let{data:t,error:l}=await h.from("followers").select("status").eq("follower_id",o.id).eq("following_id",e).single();if(l&&"PGRST116"!==l.code)throw l;if(!t)return"not_following";switch(t.status){case"accepted":return"following";case"pending":return"pending";case"rejected":return"blocked";default:return"not_following"}}catch(t){return a.Rm.error("Error getting follow status",{component:"useFollows",action:"getFollowStatus",userId:e,currentUser:o.id},t instanceof Error?t:Error(String(t))),"not_following"}},[null==o?void 0:o.id,h]),q=(0,l.useCallback)(async e=>{if((null==o?void 0:o.id)&&e!==o.id)try{s(!0),d(null);let{data:t,error:l}=await h.rpc("handle_follow_request",{follower_id_param:o.id,following_id_param:e});if(l)throw l;"accepted"===t?w("following"):"pending"===t&&w("pending"),await b(),a.Rm.info("Follow request processed",{component:"useFollows",action:"follow",targetUserId:e,result:t})}catch(o){a.Rm.error("Error following user",{component:"useFollows",action:"follow",targetUserId:e},o instanceof Error?o:Error(String(o))),d(o instanceof Error?o.message:"Failed to follow user")}finally{s(!1)}},[null==o?void 0:o.id,h,b]),E=(0,l.useCallback)(async e=>{if(null==o?void 0:o.id)try{s(!0),d(null);let{error:t}=await h.from("followers").delete().eq("follower_id",o.id).eq("following_id",e);if(t)throw t;w("not_following"),await b(),a.Rm.info("User unfollowed",{component:"useFollows",action:"unfollow",targetUserId:e})}catch(o){a.Rm.error("Error unfollowing user",{component:"useFollows",action:"unfollow",targetUserId:e},o instanceof Error?o:Error(String(o))),d(o instanceof Error?o.message:"Failed to unfollow user")}finally{s(!1)}},[null==o?void 0:o.id,h,b]),F=(0,l.useCallback)(async e=>{if(null==o?void 0:o.id)try{s(!0),d(null);let{error:t}=await h.rpc("accept_follow_request",{follower_id_param:e,following_id_param:o.id});if(t)throw t;await Promise.all([b(),k()]),a.Rm.info("Follow request accepted",{component:"useFollows",action:"acceptFollowRequest",followerUserId:e})}catch(o){a.Rm.error("Error accepting follow request",{component:"useFollows",action:"acceptFollowRequest",followerUserId:e},o instanceof Error?o:Error(String(o))),d(o instanceof Error?o.message:"Failed to accept follow request")}finally{s(!1)}},[null==o?void 0:o.id,h,b]),j=(0,l.useCallback)(async e=>{if(null==o?void 0:o.id)try{s(!0),d(null);let{error:t}=await h.rpc("reject_follow_request",{follower_id_param:e,following_id_param:o.id});if(t)throw t;await Promise.all([b(),k()]),a.Rm.info("Follow request rejected",{component:"useFollows",action:"rejectFollowRequest",followerUserId:e})}catch(o){a.Rm.error("Error rejecting follow request",{component:"useFollows",action:"rejectFollowRequest",followerUserId:e},o instanceof Error?o:Error(String(o))),d(o instanceof Error?o.message:"Failed to reject follow request")}finally{s(!1)}},[null==o?void 0:o.id,h,b]),k=(0,l.useCallback)(async()=>{if(null==o?void 0:o.id)try{let[e,t,l]=await Promise.all([h.from("followers").select("\n            *,\n            follower:profiles!followers_follower_id_fkey(*)\n          ").eq("following_id",o.id).eq("status","accepted"),h.from("followers").select("\n            *,\n            following:profiles!followers_following_id_fkey(*)\n          ").eq("follower_id",o.id).eq("status","accepted"),h.from("followers").select("\n            *,\n            follower:profiles!followers_follower_id_fkey(*)\n          ").eq("following_id",o.id).eq("status","pending")]);m(e.data||[]),v(t.data||[]),_(l.data||[])}catch(e){a.Rm.error("Error fetching follow lists",{component:"useFollows",action:"refreshFollowLists",userId:o.id},e instanceof Error?e:Error(String(e))),d(e instanceof Error?e.message:"Failed to fetch follow lists")}},[null==o?void 0:o.id,h]);return(0,l.useEffect)(()=>{e&&(null==o?void 0:o.id)&&y(e).then(w)},[e,null==o?void 0:o.id,y]),(0,l.useEffect)(()=>{(null==o?void 0:o.id)&&(b(),k())},[null==o?void 0:o.id,b,k]),{stats:c,loading:t,error:i,followStatus:f,follow:q,unfollow:E,acceptFollowRequest:F,rejectFollowRequest:j,followers:g,following:p,pendingRequests:x,getFollowStatus:y,refreshStats:b,refreshFollowLists:k}}},51834:(e,o,t)=>{t.d(o,{Cf:()=>u,Es:()=>w,L3:()=>g,c7:()=>f,lG:()=>s,rr:()=>m,zM:()=>i});var l=t(95155);t(12115);var r=t(89511),n=t(65229),a=t(64269);function s(e){let{...o}=e;return(0,l.jsx)(r.bL,{"data-slot":"dialog",...o})}function i(e){let{...o}=e;return(0,l.jsx)(r.l9,{"data-slot":"dialog-trigger",...o})}function d(e){let{...o}=e;return(0,l.jsx)(r.ZL,{"data-slot":"dialog-portal",...o})}function c(e){let{className:o,...t}=e;return(0,l.jsx)(r.hJ,{"data-slot":"dialog-overlay",className:(0,a.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",o),...t})}function u(e){let{className:o,children:t,showCloseButton:s=!0,...i}=e;return(0,l.jsxs)(d,{"data-slot":"dialog-portal",children:[(0,l.jsx)(c,{}),(0,l.jsxs)(r.UC,{"data-slot":"dialog-content",className:(0,a.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",o),...i,children:[t,s&&(0,l.jsxs)(r.bm,{"data-slot":"dialog-close",className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[(0,l.jsx)(n.A,{}),(0,l.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function f(e){let{className:o,...t}=e;return(0,l.jsx)("div",{"data-slot":"dialog-header",className:(0,a.cn)("flex flex-col gap-2 text-center sm:text-left",o),...t})}function w(e){let{className:o,...t}=e;return(0,l.jsx)("div",{"data-slot":"dialog-footer",className:(0,a.cn)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",o),...t})}function g(e){let{className:o,...t}=e;return(0,l.jsx)(r.hE,{"data-slot":"dialog-title",className:(0,a.cn)("text-lg leading-none font-semibold",o),...t})}function m(e){let{className:o,...t}=e;return(0,l.jsx)(r.VY,{"data-slot":"dialog-description",className:(0,a.cn)("text-muted-foreground text-sm",o),...t})}},62890:(e,o,t)=>{t.d(o,{UU:()=>a});var l=t(87559);t(95704);let r="https://jjrqstbzzvqrgaqwdvxw.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpqcnFzdGJ6enZxcmdhcXdkdnh3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg0ODc4MDcsImV4cCI6MjA3NDA2MzgwN30.aSHFHAA5Tv2EUDu7nxwOWXSFFUxbOUCR65Vi52QkjX4";if(!r||!n)throw Error("Missing Supabase environment variables");function a(){return(0,l.createBrowserClient)(r,n)}},85897:(e,o,t)=>{t.d(o,{BK:()=>s,eu:()=>a,q5:()=>i});var l=t(95155);t(12115);var r=t(46591),n=t(64269);function a(e){let{className:o,...t}=e;return(0,l.jsx)(r.bL,{"data-slot":"avatar",className:(0,n.cn)("relative flex size-8 shrink-0 overflow-hidden rounded-full",o),...t})}function s(e){let{className:o,...t}=e;return(0,l.jsx)(r._V,{"data-slot":"avatar-image",className:(0,n.cn)("aspect-square size-full",o),...t})}function i(e){let{className:o,...t}=e;return(0,l.jsx)(r.H4,{"data-slot":"avatar-fallback",className:(0,n.cn)("bg-muted flex size-full items-center justify-center rounded-full",o),...t})}}}]);