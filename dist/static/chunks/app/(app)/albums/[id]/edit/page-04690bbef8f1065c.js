(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5815],{6191:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(71847).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},11186:(e,s,a)=>{"use strict";a.d(s,{bq:()=>u,eb:()=>b,gC:()=>p,l6:()=>o,yv:()=>m});var t=a(95155),i=a(12115),r=a(94304),l=a(24033),d=a(12108),n=a(5917),c=a(64269);let o=r.bL;r.YJ;let m=r.WT,u=i.forwardRef((e,s)=>{let{className:a,children:i,...d}=e;return(0,t.jsxs)(r.l9,{ref:s,className:(0,c.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...d,children:[i,(0,t.jsx)(r.In,{asChild:!0,children:(0,t.jsx)(l.A,{className:"h-4 w-4 opacity-50"})})]})});u.displayName=r.l9.displayName;let x=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.PP,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...i,children:(0,t.jsx)(d.A,{className:"h-4 w-4"})})});x.displayName=r.PP.displayName;let h=i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.wn,{ref:s,className:(0,c.cn)("flex cursor-default items-center justify-center py-1",a),...i,children:(0,t.jsx)(l.A,{className:"h-4 w-4"})})});h.displayName=r.wn.displayName;let p=i.forwardRef((e,s)=>{let{className:a,children:i,position:l="popper",...d}=e;return(0,t.jsx)(r.ZL,{children:(0,t.jsxs)(r.UC,{ref:s,className:(0,c.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...d,children:[(0,t.jsx)(x,{}),(0,t.jsx)(r.LM,{className:(0,c.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:i}),(0,t.jsx)(h,{})]})})});p.displayName=r.UC.displayName,i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.JU,{ref:s,className:(0,c.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...i})}).displayName=r.JU.displayName;let b=i.forwardRef((e,s)=>{let{className:a,children:i,...l}=e;return(0,t.jsxs)(r.q7,{ref:s,className:(0,c.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(r.VF,{children:(0,t.jsx)(n.A,{className:"h-4 w-4"})})}),(0,t.jsx)(r.p4,{children:i})]})});b.displayName=r.q7.displayName,i.forwardRef((e,s)=>{let{className:a,...i}=e;return(0,t.jsx)(r.wv,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",a),...i})}).displayName=r.wv.displayName},14631:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>F});var t=a(95155),i=a(12115),r=a(20063),l=a(22544),d=a(66942),n=a(43691),c=a(62890),o=a(3998),m=a(65142),u=a(76444),x=a(31120),h=a(86948),p=a(11647),b=a(11186),j=a(39068),f=a(91169),y=a(99708),v=a(35626),g=a(21873),N=a(6191),w=a(65229),A=a(46046),_=a(52619),k=a.n(_),C=a(41508);let S=C.Ikc({title:C.YjP().min(1,"Title is required").max(200,"Title must be less than 200 characters"),description:C.YjP().max(1e3,"Description must be less than 1000 characters").optional(),visibility:C.k5n(["private","friends","public"],{message:"Visibility is required"}),location_name:C.YjP().max(200,"Location name must be less than 200 characters").optional(),start_date:C.YjP().optional(),end_date:C.YjP().optional()}).refine(e=>!e.start_date||!e.end_date||new Date(e.start_date)<=new Date(e.end_date),{message:"End date must be after start date",path:["end_date"]});var I=a(99029),E=a(82466);function F(){let e=(0,r.useParams)(),s=(0,r.useRouter)(),{user:a}=(0,n.A)(),[_,C]=(0,i.useState)(null),[F,J]=(0,i.useState)(!0),[P,q]=(0,i.useState)(!1),[B,R]=(0,i.useState)(null),[Z,z]=(0,i.useState)(""),[D,M]=(0,i.useState)([]),[T,U]=(0,i.useState)(null),O=(0,c.UU)(),{register:V,handleSubmit:W,formState:{errors:L},setValue:Y,watch:X}=(0,l.mN)({resolver:(0,d.u)(S)}),$=X("visibility"),H=(0,i.useCallback)(async()=>{try{J(!0),R(null);let{data:s,error:t}=await O.from("albums").select("*").eq("id",e.id).eq("user_id",null==a?void 0:a.id).single();if(t)throw t;if(!s)throw Error("Album not found or you do not have permission to edit it");C(s),M(s.tags||[]),Y("title",s.title),Y("description",s.description||""),Y("visibility",s.visibility),Y("start_date",s.start_date||""),Y("end_date",s.end_date||""),s.location_name&&s.latitude&&s.longitude&&U({display_name:s.location_name,latitude:s.latitude,longitude:s.longitude,city_id:s.city_id,country_id:s.country_id})}catch(s){E.Rm.error("Failed to fetch album for editing",{component:"AlbumEditPage",action:"fetchAlbum",albumId:Array.isArray(e.id)?e.id[0]:e.id,userId:null==a?void 0:a.id},s instanceof Error?s:Error(String(s))),R(s instanceof Error?s.message:"Failed to fetch album")}finally{J(!1)}},[e.id,null==a?void 0:a.id,Y,O]);(0,i.useEffect)(()=>{e.id&&a&&H()},[e.id,a,H]);let G=()=>{Z.trim()&&!D.includes(Z.trim())&&(M([...D,Z.trim()]),z(""))},Q=async t=>{try{q(!0),R(null);let{error:i}=await O.from("albums").update({title:t.title,description:t.description||null,visibility:t.visibility,location_name:(null==T?void 0:T.display_name)||null,latitude:(null==T?void 0:T.latitude)||null,longitude:(null==T?void 0:T.longitude)||null,city_id:(null==T?void 0:T.city_id)||null,country_id:(null==T?void 0:T.country_id)||null,start_date:t.start_date||null,end_date:t.end_date||null,tags:D.length>0?D:null,updated_at:new Date().toISOString()}).eq("id",e.id).eq("user_id",null==a?void 0:a.id);if(i)throw i;s.push("/albums/".concat(e.id))}catch(s){E.Rm.error("Failed to update album",{component:"AlbumEditPage",action:"updateAlbum",albumId:Array.isArray(e.id)?e.id[0]:e.id,userId:null==a?void 0:a.id},s instanceof Error?s:Error(String(s))),R(s instanceof Error?s.message:"Failed to update album")}finally{q(!1)}};return F?(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-32 mb-4"}),(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-64 mb-2"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-48"})]}),(0,t.jsx)(h.Zp,{children:(0,t.jsx)(h.Wu,{className:"pt-6",children:(0,t.jsx)("div",{className:"space-y-4",children:[...Array(6)].map((e,s)=>(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-24"}),(0,t.jsx)("div",{className:"h-10 bg-gray-200 rounded"})]},s))})})})]}):B?(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)(k(),{href:"/albums",className:"inline-flex items-center text-sm text-gray-800 hover:text-gray-900",children:[(0,t.jsx)(v.A,{className:"h-4 w-4 mr-1"}),"Back to Albums"]}),(0,t.jsx)(h.Zp,{className:"border-red-200 bg-red-50",children:(0,t.jsx)(h.Wu,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-red-600 font-medium",children:"Failed to load album"}),(0,t.jsx)("p",{className:"text-red-500 text-sm mt-1",children:B}),(0,t.jsxs)("div",{className:"mt-4 space-x-2",children:[(0,t.jsx)(o.$,{variant:"outline",onClick:H,children:"Try Again"}),(0,t.jsx)(k(),{href:"/albums",children:(0,t.jsx)(o.$,{variant:"outline",children:"Back to Albums"})})]})]})})})]}):_?(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(k(),{href:"/albums/".concat(e.id),className:"inline-flex items-center text-sm text-gray-800 hover:text-gray-900",children:[(0,t.jsx)(v.A,{className:"h-4 w-4 mr-1"}),"Back to Album"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Album"}),(0,t.jsx)("p",{className:"text-gray-800",children:"Update your album details and settings"})]})]}),(0,t.jsxs)("form",{onSubmit:W(Q),className:"space-y-8",children:[(0,t.jsxs)(h.Zp,{children:[(0,t.jsxs)(h.aR,{children:[(0,t.jsx)(h.ZB,{children:"Basic Information"}),(0,t.jsx)(h.BT,{children:"Update your album's basic details"})]}),(0,t.jsxs)(h.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"title",children:"Album Title *"}),(0,t.jsx)(m.p,{id:"title",...V("title"),className:L.title?"border-red-500":"",placeholder:"Enter album title"}),L.title&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:L.title.message})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"description",children:"Description"}),(0,t.jsx)(x.T,{id:"description",...V("description"),className:L.description?"border-red-500":"",placeholder:"Describe your adventure...",rows:4}),L.description&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:L.description.message})]})]})]}),(0,t.jsxs)(h.Zp,{children:[(0,t.jsxs)(h.aR,{children:[(0,t.jsxs)(h.ZB,{className:"flex items-center gap-2",children:[(0,t.jsx)(g.A,{className:"h-5 w-5"}),"Location & Dates"]}),(0,t.jsx)(h.BT,{children:"Add location and date information for your adventure"})]}),(0,t.jsxs)(h.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"location_name",children:"Location"}),(0,t.jsx)(I.f,{value:T,onChange:U,placeholder:"Search destinations or pick a popular one...",allowCurrentLocation:!0,showPopularDestinations:!0,className:L.location_name?"border-red-500":""}),L.location_name&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:L.location_name.message}),T&&(0,t.jsxs)("div",{className:"p-2 bg-blue-50 border border-blue-200 rounded text-sm",children:[(0,t.jsxs)("p",{className:"text-blue-800 font-medium",children:["Selected: ",T.display_name]}),(0,t.jsxs)("p",{className:"text-blue-600 text-sm",children:["Coordinates: ",T.latitude.toFixed(6),", ",T.longitude.toFixed(6)]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"start_date",children:"Start Date"}),(0,t.jsx)(m.p,{id:"start_date",type:"date",...V("start_date"),className:L.start_date?"border-red-500":""}),L.start_date&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:L.start_date.message})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{htmlFor:"end_date",children:"End Date"}),(0,t.jsx)(m.p,{id:"end_date",type:"date",...V("end_date"),className:L.end_date?"border-red-500":""}),L.end_date&&(0,t.jsx)("p",{className:"text-sm text-red-600",children:L.end_date.message})]})]})]})]}),(0,t.jsxs)(h.Zp,{children:[(0,t.jsxs)(h.aR,{children:[(0,t.jsx)(h.ZB,{children:"Privacy & Visibility"}),(0,t.jsx)(h.BT,{children:"Control who can see this album"})]}),(0,t.jsx)(h.Wu,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(u.J,{children:"Visibility"}),(0,t.jsxs)(b.l6,{value:$,onValueChange:e=>Y("visibility",e),children:[(0,t.jsx)(b.bq,{children:(0,t.jsx)(b.yv,{placeholder:"Select visibility"})}),(0,t.jsxs)(b.gC,{children:[(0,t.jsx)(b.eb,{value:"private",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(y.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Private"})]})}),(0,t.jsx)(b.eb,{value:"friends",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(f.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Friends Only"})]})}),(0,t.jsx)(b.eb,{value:"public",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(j.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Public"})]})})]})]}),$&&(0,t.jsxs)("p",{className:"text-sm text-gray-800 flex items-center gap-2",children:[(e=>{switch(e){case"public":return(0,t.jsx)(j.A,{className:"h-4 w-4 text-green-600"});case"friends":return(0,t.jsx)(f.A,{className:"h-4 w-4 text-blue-600"});case"private":return(0,t.jsx)(y.A,{className:"h-4 w-4 text-gray-800"});default:return(0,t.jsx)(j.A,{className:"h-4 w-4 text-gray-800"})}})($),(e=>{switch(e){case"public":return"Anyone can view this album";case"friends":return"Only your friends can view this album";case"private":return"Only you can view this album";default:return""}})($)]})]})})]}),(0,t.jsxs)(h.Zp,{children:[(0,t.jsxs)(h.aR,{children:[(0,t.jsx)(h.ZB,{children:"Tags"}),(0,t.jsx)(h.BT,{children:"Add tags to help organize and find your albums"})]}),(0,t.jsxs)(h.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(m.p,{value:Z,onChange:e=>z(e.target.value),placeholder:"Add a tag",onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),G())}}),(0,t.jsx)(o.$,{type:"button",onClick:G,variant:"outline",children:(0,t.jsx)(N.A,{className:"h-4 w-4"})})]}),D.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:D.map((e,s)=>(0,t.jsxs)(p.E,{variant:"secondary",className:"flex items-center gap-1",children:[e,(0,t.jsx)("button",{type:"button",onClick:()=>{M(D.filter(s=>s!==e))},className:"ml-1 hover:text-red-600",children:(0,t.jsx)(w.A,{className:"h-3 w-3"})})]},s))})]})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsx)(k(),{href:"/albums/".concat(e.id),children:(0,t.jsx)(o.$,{type:"button",variant:"outline",children:"Cancel"})}),(0,t.jsx)(o.$,{type:"submit",disabled:P,children:P?"Saving...":(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(A.A,{className:"h-4 w-4 mr-2"}),"Save Changes"]})})]})]})]}):(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)(k(),{href:"/albums",className:"inline-flex items-center text-sm text-gray-800 hover:text-gray-900",children:[(0,t.jsx)(v.A,{className:"h-4 w-4 mr-1"}),"Back to Albums"]}),(0,t.jsx)(h.Zp,{children:(0,t.jsx)(h.Wu,{className:"pt-6",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-gray-800",children:"Album not found"}),(0,t.jsx)(k(),{href:"/albums",className:"mt-4 inline-block",children:(0,t.jsx)(o.$,{variant:"outline",children:"Back to Albums"})})]})})})]})}},21873:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(71847).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},31120:(e,s,a)=>{"use strict";a.d(s,{T:()=>r});var t=a(95155);a(12115);var i=a(64269);function r(e){let{className:s,...a}=e;return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,i.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),...a})}},35299:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(71847).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},36627:(e,s,a)=>{Promise.resolve().then(a.bind(a,14631))},62890:(e,s,a)=>{"use strict";a.d(s,{UU:()=>l});var t=a(87559);a(95704);let i="https://jjrqstbzzvqrgaqwdvxw.supabase.co",r="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpqcnFzdGJ6enZxcmdhcXdkdnh3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg0ODc4MDcsImV4cCI6MjA3NDA2MzgwN30.aSHFHAA5Tv2EUDu7nxwOWXSFFUxbOUCR65Vi52QkjX4";if(!i||!r)throw Error("Missing Supabase environment variables");function l(){return(0,t.createBrowserClient)(i,r)}},65142:(e,s,a)=>{"use strict";a.d(s,{p:()=>r});var t=a(95155);a(12115);var i=a(64269);function r(e){let{className:s,type:a,...r}=e;return(0,t.jsx)("input",{type:a,"data-slot":"input",className:(0,i.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",s),...r})}},76444:(e,s,a)=>{"use strict";a.d(s,{J:()=>l});var t=a(95155);a(12115);var i=a(10489),r=a(64269);function l(e){let{className:s,...a}=e;return(0,t.jsx)(i.b,{"data-slot":"label",className:(0,r.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...a})}},76561:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(71847).A)("navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]])},86651:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(71847).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},91169:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(71847).A)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]])},99708:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(71847).A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])}},e=>{e.O(0,[4545,7559,2619,306,2784,264,8868,9197,9029,6677,8441,1255,7358],()=>e(e.s=36627)),_N_E=e.O()}]);